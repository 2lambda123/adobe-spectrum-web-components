{"version":3,"file":"464e15ff.js","sources":["../../../tools/reactive-controllers/src/FocusGroup.js","../../../tools/reactive-controllers/src/RovingTabindex.js"],"sourcesContent":["\"use strict\";function r(i,e,t){return typeof i===e?()=>i:typeof i==\"function\"?i:t}export class FocusGroupController{constructor(e,{direction:t,elementEnterAction:n,elements:s,focusInIndex:o,isFocusableElement:h,listenerScope:c}={elements:()=>[]}){this._currentIndex=-1;this._direction=()=>\"both\";this.directionLength=5;this.elementEnterAction=e=>{};this._focused=!1;this._focusInIndex=e=>0;this.isFocusableElement=e=>!0;this._listenerScope=()=>this.host;this.offset=0;this.handleFocusin=e=>{if(!this.isEventWithinListenerScope(e))return;this.isRelatedTargetAnElement(e)&&this.hostContainsFocus();const t=e.composedPath();let n=-1;t.find(s=>(n=this.elements.indexOf(s),n!==-1)),this.currentIndex=n>-1?n:this.currentIndex};this.handleFocusout=e=>{this.isRelatedTargetAnElement(e)&&this.hostNoLongerContainsFocus()};this.handleKeydown=e=>{if(!this.acceptsEventCode(e.code)||e.defaultPrevented)return;let t=0;switch(e.code){case\"ArrowRight\":t+=1;break;case\"ArrowDown\":t+=this.direction===\"grid\"?this.directionLength:1;break;case\"ArrowLeft\":t-=1;break;case\"ArrowUp\":t-=this.direction===\"grid\"?this.directionLength:1;break;case\"End\":this.currentIndex=0,t-=1;break;case\"Home\":this.currentIndex=this.elements.length-1,t+=1;break}e.preventDefault(),this.direction===\"grid\"&&this.currentIndex+t<0?this.currentIndex=0:this.direction===\"grid\"&&this.currentIndex+t>this.elements.length-1?this.currentIndex=this.elements.length-1:this.setCurrentIndexCircularly(t),this.elementEnterAction(this.elements[this.currentIndex]),this.focus()};this.host=e,this.host.addController(this),this._elements=s,this.isFocusableElement=h||this.isFocusableElement,this._direction=r(t,\"string\",this._direction),this.elementEnterAction=n||this.elementEnterAction,this._focusInIndex=r(o,\"number\",this._focusInIndex),this._listenerScope=r(c,\"object\",this._listenerScope)}get currentIndex(){return this._currentIndex===-1&&(this._currentIndex=this.focusInIndex),this._currentIndex-this.offset}set currentIndex(e){this._currentIndex=e+this.offset}get direction(){return this._direction()}get elements(){return this.cachedElements||(this.cachedElements=this._elements()),this.cachedElements}set focused(e){e!==this.focused&&(this._focused=e)}get focused(){return this._focused}get focusInElement(){return this.elements[this.focusInIndex]}get focusInIndex(){return this._focusInIndex(this.elements)}isEventWithinListenerScope(e){return this._listenerScope()===this.host?!0:e.composedPath().includes(this._listenerScope())}update({elements:e}={elements:()=>[]}){this.unmanage(),this._elements=e,this.clearElementCache(),this.manage()}focus(e){let t=this.elements[this.currentIndex];(!t||!this.isFocusableElement(t))&&(this.setCurrentIndexCircularly(1),t=this.elements[this.currentIndex]),t&&this.isFocusableElement(t)&&t.focus(e)}clearElementCache(e=0){delete this.cachedElements,this.offset=e}setCurrentIndexCircularly(e){const{length:t}=this.elements;let n=t,s=(t+this.currentIndex+e)%t;for(;n&&this.elements[s]&&!this.isFocusableElement(this.elements[s]);)s=(t+s+e)%t,n-=1;this.currentIndex=s}hostContainsFocus(){this.host.addEventListener(\"focusout\",this.handleFocusout),this.host.addEventListener(\"keydown\",this.handleKeydown),this.focused=!0}hostNoLongerContainsFocus(){this.host.addEventListener(\"focusin\",this.handleFocusin),this.host.removeEventListener(\"focusout\",this.handleFocusout),this.host.removeEventListener(\"keydown\",this.handleKeydown),this.currentIndex=this.focusInIndex,this.focused=!1}isRelatedTargetAnElement(e){const t=e.relatedTarget;return!this.elements.includes(t)}acceptsEventCode(e){if(e===\"End\"||e===\"Home\")return!0;switch(this.direction){case\"horizontal\":return e===\"ArrowLeft\"||e===\"ArrowRight\";case\"vertical\":return e===\"ArrowUp\"||e===\"ArrowDown\";case\"both\":case\"grid\":return e.startsWith(\"Arrow\")}}manage(){this.addEventListeners()}unmanage(){this.removeEventListeners()}addEventListeners(){this.host.addEventListener(\"focusin\",this.handleFocusin)}removeEventListeners(){this.host.removeEventListener(\"focusin\",this.handleFocusin),this.host.removeEventListener(\"focusout\",this.handleFocusout),this.host.removeEventListener(\"keydown\",this.handleKeydown)}hostConnected(){this.addEventListeners()}hostDisconnected(){this.removeEventListeners()}}\n//# sourceMappingURL=FocusGroup.js.map\n","\"use strict\";import{FocusGroupController as s}from\"./FocusGroup.js\";export class RovingTabindexController extends s{constructor(){super(...arguments);this.managed=!0;this.manageIndexesAnimationFrame=0}set focused(e){e!==this.focused&&(super.focused=e,this.manageTabindexes())}get focused(){return super.focused}clearElementCache(e=0){cancelAnimationFrame(this.manageIndexesAnimationFrame),super.clearElementCache(e),this.managed&&(this.manageIndexesAnimationFrame=requestAnimationFrame(()=>this.manageTabindexes()))}manageTabindexes(){this.focused?this.updateTabindexes(()=>({tabIndex:-1})):this.updateTabindexes(e=>({removeTabIndex:e.contains(this.focusInElement)&&e!==this.focusInElement,tabIndex:e===this.focusInElement?0:-1}))}updateTabindexes(e){this.elements.forEach(a=>{const{tabIndex:t,removeTabIndex:i}=e(a);if(!i){a.tabIndex=t;return}a.removeAttribute(\"tabindex\");const n=a;n.requestUpdate&&n.requestUpdate()})}manage(){this.managed=!0,this.manageTabindexes(),super.manage()}unmanage(){this.managed=!1,this.updateTabindexes(()=>({tabIndex:0})),super.unmanage()}hostUpdated(){this.host.hasUpdated||this.manageTabindexes()}}\n//# sourceMappingURL=RovingTabindex.js.map\n"],"names":["value","type","fallback","constructor","host","direction","elementEnterAction","elements","focusInIndex","isFocusableElement","listenerScope","this","_currentIndex","directionLength","_el","_focused","_elements","event","isEventWithinListenerScope","isRelatedTargetAnElement","hostContainsFocus","composedPath","path","find","el","targetIndex","indexOf","currentIndex","hostNoLongerContainsFocus","acceptsEventCode","code","defaultPrevented","diff","length","preventDefault","setCurrentIndexCircularly","focus","addController","_direction","ensureMethod","_focusInIndex","_listenerScope","offset","cachedElements","focused","includes","unmanage","clearElementCache","manage","options","focusElement","nextIndex","steps","addEventListener","handleFocusout","handleKeydown","handleFocusin","removeEventListener","relatedTarget","startsWith","addEventListeners","removeEventListeners","managed","manageIndexesAnimationFrame","super","manageTabindexes","cancelAnimationFrame","requestAnimationFrame","updateTabindexes","tabIndex","removeTabIndex","contains","focusInElement","getTabIndex","forEach","removeAttribute","updatable","requestUpdate","hasUpdated"],"mappings":"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"}
{"version":3,"file":"464e15ff.js","sources":["../../../tools/reactive-controllers/src/FocusGroup.js","../../../tools/reactive-controllers/src/RovingTabindex.js"],"sourcesContent":["\"use strict\";function r(i,e,t){return typeof i===e?()=>i:typeof i==\"function\"?i:t}export class FocusGroupController{constructor(e,{direction:t,elementEnterAction:n,elements:s,focusInIndex:o,isFocusableElement:h,listenerScope:c}={elements:()=>[]}){this._currentIndex=-1;this._direction=()=>\"both\";this.directionLength=5;this.elementEnterAction=e=>{};this._focused=!1;this._focusInIndex=e=>0;this.isFocusableElement=e=>!0;this._listenerScope=()=>this.host;this.offset=0;this.handleFocusin=e=>{if(!this.isEventWithinListenerScope(e))return;this.isRelatedTargetAnElement(e)&&this.hostContainsFocus();const t=e.composedPath();let n=-1;t.find(s=>(n=this.elements.indexOf(s),n!==-1)),this.currentIndex=n>-1?n:this.currentIndex};this.handleFocusout=e=>{this.isRelatedTargetAnElement(e)&&this.hostNoLongerContainsFocus()};this.handleKeydown=e=>{if(!this.acceptsEventCode(e.code)||e.defaultPrevented)return;let t=0;switch(e.code){case\"ArrowRight\":t+=1;break;case\"ArrowDown\":t+=this.direction===\"grid\"?this.directionLength:1;break;case\"ArrowLeft\":t-=1;break;case\"ArrowUp\":t-=this.direction===\"grid\"?this.directionLength:1;break;case\"End\":this.currentIndex=0,t-=1;break;case\"Home\":this.currentIndex=this.elements.length-1,t+=1;break}e.preventDefault(),this.direction===\"grid\"&&this.currentIndex+t<0?this.currentIndex=0:this.direction===\"grid\"&&this.currentIndex+t>this.elements.length-1?this.currentIndex=this.elements.length-1:this.setCurrentIndexCircularly(t),this.elementEnterAction(this.elements[this.currentIndex]),this.focus()};this.host=e,this.host.addController(this),this._elements=s,this.isFocusableElement=h||this.isFocusableElement,this._direction=r(t,\"string\",this._direction),this.elementEnterAction=n||this.elementEnterAction,this._focusInIndex=r(o,\"number\",this._focusInIndex),this._listenerScope=r(c,\"object\",this._listenerScope)}get currentIndex(){return this._currentIndex===-1&&(this._currentIndex=this.focusInIndex),this._currentIndex-this.offset}set currentIndex(e){this._currentIndex=e+this.offset}get direction(){return this._direction()}get elements(){return this.cachedElements||(this.cachedElements=this._elements()),this.cachedElements}set focused(e){e!==this.focused&&(this._focused=e)}get focused(){return this._focused}get focusInElement(){return this.elements[this.focusInIndex]}get focusInIndex(){return this._focusInIndex(this.elements)}isEventWithinListenerScope(e){return this._listenerScope()===this.host?!0:e.composedPath().includes(this._listenerScope())}update({elements:e}={elements:()=>[]}){this.unmanage(),this._elements=e,this.clearElementCache(),this.manage()}focus(e){let t=this.elements[this.currentIndex];(!t||!this.isFocusableElement(t))&&(this.setCurrentIndexCircularly(1),t=this.elements[this.currentIndex]),t&&this.isFocusableElement(t)&&t.focus(e)}clearElementCache(e=0){delete this.cachedElements,this.offset=e}setCurrentIndexCircularly(e){const{length:t}=this.elements;let n=t,s=(t+this.currentIndex+e)%t;for(;n&&this.elements[s]&&!this.isFocusableElement(this.elements[s]);)s=(t+s+e)%t,n-=1;this.currentIndex=s}hostContainsFocus(){this.host.addEventListener(\"focusout\",this.handleFocusout),this.host.addEventListener(\"keydown\",this.handleKeydown),this.focused=!0}hostNoLongerContainsFocus(){this.host.addEventListener(\"focusin\",this.handleFocusin),this.host.removeEventListener(\"focusout\",this.handleFocusout),this.host.removeEventListener(\"keydown\",this.handleKeydown),this.currentIndex=this.focusInIndex,this.focused=!1}isRelatedTargetAnElement(e){const t=e.relatedTarget;return!this.elements.includes(t)}acceptsEventCode(e){if(e===\"End\"||e===\"Home\")return!0;switch(this.direction){case\"horizontal\":return e===\"ArrowLeft\"||e===\"ArrowRight\";case\"vertical\":return e===\"ArrowUp\"||e===\"ArrowDown\";case\"both\":case\"grid\":return e.startsWith(\"Arrow\")}}manage(){this.addEventListeners()}unmanage(){this.removeEventListeners()}addEventListeners(){this.host.addEventListener(\"focusin\",this.handleFocusin)}removeEventListeners(){this.host.removeEventListener(\"focusin\",this.handleFocusin),this.host.removeEventListener(\"focusout\",this.handleFocusout),this.host.removeEventListener(\"keydown\",this.handleKeydown)}hostConnected(){this.addEventListeners()}hostDisconnected(){this.removeEventListeners()}}\n//# sourceMappingURL=FocusGroup.js.map\n","\"use strict\";import{FocusGroupController as s}from\"./FocusGroup.js\";export class RovingTabindexController extends s{constructor(){super(...arguments);this.managed=!0;this.manageIndexesAnimationFrame=0}set focused(e){e!==this.focused&&(super.focused=e,this.manageTabindexes())}get focused(){return super.focused}clearElementCache(e=0){cancelAnimationFrame(this.manageIndexesAnimationFrame),super.clearElementCache(e),this.managed&&(this.manageIndexesAnimationFrame=requestAnimationFrame(()=>this.manageTabindexes()))}manageTabindexes(){this.focused?this.updateTabindexes(()=>({tabIndex:-1})):this.updateTabindexes(e=>({removeTabIndex:e.contains(this.focusInElement)&&e!==this.focusInElement,tabIndex:e===this.focusInElement?0:-1}))}updateTabindexes(e){this.elements.forEach(a=>{const{tabIndex:t,removeTabIndex:i}=e(a);if(!i){a.tabIndex=t;return}a.removeAttribute(\"tabindex\");const n=a;n.requestUpdate&&n.requestUpdate()})}manage(){this.managed=!0,this.manageTabindexes(),super.manage()}unmanage(){this.managed=!1,this.updateTabindexes(()=>({tabIndex:0})),super.unmanage()}hostUpdated(){this.host.hasUpdated||this.manageTabindexes()}}\n//# sourceMappingURL=RovingTabindex.js.map\n"],"names":["ensureMethod","value","type","fallback","i","FocusGroupController","constructor","host","direction","elementEnterAction","elements","focusInIndex","o","isFocusableElement","h","listenerScope","c","this","_currentIndex","_direction","directionLength","_el","_focused","_elements","_listenerScope","offset","event","isEventWithinListenerScope","isRelatedTargetAnElement","hostContainsFocus","path","composedPath","n","find","el","targetIndex","indexOf","currentIndex","hostNoLongerContainsFocus","acceptsEventCode","code","defaultPrevented","diff","length","preventDefault","setCurrentIndexCircularly","focus","addController","_focusInIndex","cachedElements","focused","focusInElement","includes","update","e","unmanage","clearElementCache","manage","options","t","focusElement","steps","nextIndex","addEventListener","handleFocusout","handleKeydown","handleFocusin","removeEventListener","relatedTarget","startsWith","addEventListeners","removeEventListeners","hostConnected","RovingTabindexController","s","super","arguments","managed","manageIndexesAnimationFrame","manageTabindexes","cancelAnimationFrame","requestAnimationFrame","updateTabindexes","tabIndex","removeTabIndex","contains","getTabIndex","forEach","removeAttribute","updatable","requestUpdate","hostUpdated","hasUpdated"],"mappings":"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"}
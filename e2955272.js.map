{"version":3,"file":"e2955272.js","sources":["../../../tools/reactive-controllers/src/FocusGroup.js","../../../tools/reactive-controllers/src/RovingTabindex.js"],"sourcesContent":["\"use strict\";export class FocusGroupController{constructor(e,{direction:t,elementEnterAction:s,elements:n,focusInIndex:i,isFocusableElement:r,listenerScope:o}={elements:()=>[]}){this._currentIndex=-1;this._direction=()=>\"both\";this.directionLength=5;this.elementEnterAction=e=>{};this._focused=!1;this._focusInIndex=e=>0;this.isFocusableElement=e=>!0;this._listenerScope=()=>this.host;this.offset=0;this.handleFocusin=e=>{if(!this.isEventWithinListenerScope(e))return;this.isRelatedTargetAnElement(e)&&this.hostContainsFocus();const t=e.composedPath();let s=-1;t.find(n=>(s=this.elements.indexOf(n),s!==-1)),this.currentIndex=s>-1?s:this.currentIndex};this.handleFocusout=e=>{this.isRelatedTargetAnElement(e)&&this.hostNoLongerContainsFocus()};this.handleKeydown=e=>{if(!this.acceptsEventCode(e.code)||e.defaultPrevented)return;let t=0;switch(e.code){case\"ArrowRight\":t+=1;break;case\"ArrowDown\":t+=this.direction===\"grid\"?this.directionLength:1;break;case\"ArrowLeft\":t-=1;break;case\"ArrowUp\":t-=this.direction===\"grid\"?this.directionLength:1;break;case\"End\":this.currentIndex=0,t-=1;break;case\"Home\":this.currentIndex=this.elements.length-1,t+=1;break}e.preventDefault(),this.direction===\"grid\"&&this.currentIndex+t<0?this.currentIndex=0:this.direction===\"grid\"&&this.currentIndex+t>this.elements.length-1?this.currentIndex=this.elements.length-1:this.setCurrentIndexCircularly(t),this.elementEnterAction(this.elements[this.currentIndex]),this.focus()};this.host=e,this.host.addController(this),this._elements=n,this.isFocusableElement=r||this.isFocusableElement,typeof t==\"string\"?this._direction=()=>t:typeof t==\"function\"&&(this._direction=t),this.elementEnterAction=s||this.elementEnterAction,typeof i==\"number\"?this._focusInIndex=()=>i:typeof i==\"function\"&&(this._focusInIndex=i),typeof o==\"object\"?this._listenerScope=()=>o:typeof o==\"function\"&&(this._listenerScope=o)}get currentIndex(){return this._currentIndex===-1&&(this._currentIndex=this.focusInIndex),this._currentIndex-this.offset}set currentIndex(e){this._currentIndex=e+this.offset}get direction(){return this._direction()}get elements(){return this.cachedElements||(this.cachedElements=this._elements()),this.cachedElements}set focused(e){e!==this.focused&&(this._focused=e)}get focused(){return this._focused}get focusInElement(){return this.elements[this.focusInIndex]}get focusInIndex(){return this._focusInIndex(this.elements)}isEventWithinListenerScope(e){return this._listenerScope()===this.host?!0:e.composedPath().includes(this._listenerScope())}update({elements:e}={elements:()=>[]}){this.unmanage(),this._elements=e,this.clearElementCache(),this.manage()}focus(e){let t=this.elements[this.currentIndex];(!t||!this.isFocusableElement(t))&&(this.setCurrentIndexCircularly(1),t=this.elements[this.currentIndex]),t&&this.isFocusableElement(t)&&t.focus(e)}clearElementCache(e=0){delete this.cachedElements,this.offset=e}setCurrentIndexCircularly(e){const{length:t}=this.elements;let s=t,n=(t+this.currentIndex+e)%t;for(;s&&this.elements[n]&&!this.isFocusableElement(this.elements[n]);)n=(t+n+e)%t,s-=1;this.currentIndex=n}hostContainsFocus(){this.host.addEventListener(\"focusout\",this.handleFocusout),this.host.addEventListener(\"keydown\",this.handleKeydown),this.focused=!0}hostNoLongerContainsFocus(){this.host.addEventListener(\"focusin\",this.handleFocusin),this.host.removeEventListener(\"focusout\",this.handleFocusout),this.host.removeEventListener(\"keydown\",this.handleKeydown),this.currentIndex=this.focusInIndex,this.focused=!1}isRelatedTargetAnElement(e){const t=e.relatedTarget;return!this.elements.includes(t)}acceptsEventCode(e){if(e===\"End\"||e===\"Home\")return!0;switch(this.direction){case\"horizontal\":return e===\"ArrowLeft\"||e===\"ArrowRight\";case\"vertical\":return e===\"ArrowUp\"||e===\"ArrowDown\";case\"both\":case\"grid\":return e.startsWith(\"Arrow\")}}manage(){this.addEventListeners()}unmanage(){this.removeEventListeners()}addEventListeners(){this.host.addEventListener(\"focusin\",this.handleFocusin)}removeEventListeners(){this.host.removeEventListener(\"focusin\",this.handleFocusin),this.host.removeEventListener(\"focusout\",this.handleFocusout),this.host.removeEventListener(\"keydown\",this.handleKeydown)}hostConnected(){this.addEventListeners()}hostDisconnected(){this.removeEventListeners()}}\n//# sourceMappingURL=FocusGroup.js.map\n","\"use strict\";import{FocusGroupController as s}from\"./FocusGroup.js\";export class RovingTabindexController extends s{constructor(){super(...arguments);this.managed=!0;this.manageIndexesAnimationFrame=0}set focused(e){e!==this.focused&&(super.focused=e,this.manageTabindexes())}get focused(){return super.focused}clearElementCache(e=0){cancelAnimationFrame(this.manageIndexesAnimationFrame),super.clearElementCache(e),this.managed&&(this.manageIndexesAnimationFrame=requestAnimationFrame(()=>this.manageTabindexes()))}manageTabindexes(){this.focused?this.updateTabindexes(()=>({tabIndex:-1})):this.updateTabindexes(e=>({removeTabIndex:e.contains(this.focusInElement)&&e!==this.focusInElement,tabIndex:e===this.focusInElement?0:-1}))}updateTabindexes(e){this.elements.forEach(a=>{const{tabIndex:t,removeTabIndex:i}=e(a);if(!i){a.tabIndex=t;return}a.removeAttribute(\"tabindex\");const n=a;n.requestUpdate&&n.requestUpdate()})}manage(){this.managed=!0,this.manageTabindexes(),super.manage()}unmanage(){this.managed=!1,this.updateTabindexes(()=>({tabIndex:0})),super.unmanage()}hostUpdated(){this.host.hasUpdated||this.manageTabindexes()}}\n//# sourceMappingURL=RovingTabindex.js.map\n"],"names":["FocusGroupController","constructor","host","direction","elementEnterAction","elements","focusInIndex","i","isFocusableElement","r","listenerScope","o","this","_currentIndex","_direction","directionLength","_el","_focused","_elements","_listenerScope","offset","event","isEventWithinListenerScope","isRelatedTargetAnElement","hostContainsFocus","path","composedPath","s","find","el","targetIndex","indexOf","currentIndex","handleFocusout","hostNoLongerContainsFocus","handleKeydown","acceptsEventCode","code","defaultPrevented","diff","length","preventDefault","setCurrentIndexCircularly","focus","addController","t","_focusInIndex","cachedElements","focused","focusInElement","includes","unmanage","clearElementCache","manage","[object Object]","options","focusElement","steps","nextIndex","addEventListener","handleFocusin","removeEventListener","relatedTarget","e","startsWith","addEventListeners","removeEventListeners","RovingTabindexController","super","arguments","managed","manageIndexesAnimationFrame","manageTabindexes","cancelAnimationFrame","requestAnimationFrame","updateTabindexes","tabIndex","removeTabIndex","contains","getTabIndex","forEach","removeAttribute","updatable","requestUpdate","hasUpdated"],"mappings":"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"}
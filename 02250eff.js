const e=(e,t,{position:n,prepareCallback:s}={position:"beforeend"})=>{let{length:i}=e;if(0===i)return()=>e;let r=1,o=0;("afterbegin"===n||"afterend"===n)&&(r=-1,o=i-1);const h=new Array(i),a=new Array(i),c=document.createComment("placeholder for reparented element");do{const i=e[o];s&&(a[o]=s(i)),h[o]=c.cloneNode();const d=i.parentElement||i.getRootNode();d&&d!==i&&d.replaceChild(h[o],i),t.insertAdjacentElement(n,i),o+=r}while(--i>0);return function(){return function(e,t,n=[]){for(let s=0;s<t.length;++s){const i=t[s],r=e[s],o=r.parentElement||r.getRootNode();n[s]&&n[s](i),o&&o!==r&&o.replaceChild(i,r),delete e[s]}return t}(h,e,a)}},t=e=>e.querySelector('button:not([tabindex="-1"]), [href]:not([tabindex="-1"]), input:not([tabindex="-1"]), select:not([tabindex="-1"]), textarea:not([tabindex="-1"]), [tabindex]:not([tabindex="-1"]), [focusable]:not([tabindex="-1"])');function n(e,t,n){return typeof e===t?()=>e:"function"==typeof e?e:n}class s{constructor(e,{direction:t,elementEnterAction:s,elements:i,focusInIndex:r,isFocusableElement:o,listenerScope:h}={elements:()=>[]}){this._currentIndex=-1,this._direction=()=>"both",this.directionLength=5,this.elementEnterAction=e=>{},this._focused=!1,this._focusInIndex=e=>0,this.isFocusableElement=e=>!0,this._listenerScope=()=>this.host,this.offset=0,this.handleFocusin=e=>{if(!this.isEventWithinListenerScope(e))return;this.isRelatedTargetAnElement(e)&&this.hostContainsFocus();const t=e.composedPath();let n=-1;t.find((e=>(n=this.elements.indexOf(e),-1!==n))),this.currentIndex=n>-1?n:this.currentIndex},this.handleFocusout=e=>{this.isRelatedTargetAnElement(e)&&this.hostNoLongerContainsFocus()},this.handleKeydown=e=>{if(!this.acceptsEventCode(e.code)||e.defaultPrevented)return;let t=0;switch(e.code){case"ArrowRight":t+=1;break;case"ArrowDown":t+="grid"===this.direction?this.directionLength:1;break;case"ArrowLeft":t-=1;break;case"ArrowUp":t-="grid"===this.direction?this.directionLength:1;break;case"End":this.currentIndex=0,t-=1;break;case"Home":this.currentIndex=this.elements.length-1,t+=1}e.preventDefault(),"grid"===this.direction&&this.currentIndex+t<0?this.currentIndex=0:"grid"===this.direction&&this.currentIndex+t>this.elements.length-1?this.currentIndex=this.elements.length-1:this.setCurrentIndexCircularly(t),this.elementEnterAction(this.elements[this.currentIndex]),this.focus()},this.host=e,this.host.addController(this),this._elements=i,this.isFocusableElement=o||this.isFocusableElement,this._direction=n(t,"string",this._direction),this.elementEnterAction=s||this.elementEnterAction,this._focusInIndex=n(r,"number",this._focusInIndex),this._listenerScope=n(h,"object",this._listenerScope)}get currentIndex(){return-1===this._currentIndex&&(this._currentIndex=this.focusInIndex),this._currentIndex-this.offset}set currentIndex(e){this._currentIndex=e+this.offset}get direction(){return this._direction()}get elements(){return this.cachedElements||(this.cachedElements=this._elements()),this.cachedElements}set focused(e){e!==this.focused&&(this._focused=e)}get focused(){return this._focused}get focusInElement(){return this.elements[this.focusInIndex]}get focusInIndex(){return this._focusInIndex(this.elements)}isEventWithinListenerScope(e){return this._listenerScope()===this.host||e.composedPath().includes(this._listenerScope())}update({elements:e}={elements:()=>[]}){this.unmanage(),this._elements=e,this.clearElementCache(),this.manage()}focus(e){let t=this.elements[this.currentIndex];(!t||!this.isFocusableElement(t))&&(this.setCurrentIndexCircularly(1),t=this.elements[this.currentIndex]),t&&this.isFocusableElement(t)&&t.focus(e)}clearElementCache(e=0){delete this.cachedElements,this.offset=e}setCurrentIndexCircularly(e){const{length:t}=this.elements;let n=t,s=(t+this.currentIndex+e)%t;for(;n&&this.elements[s]&&!this.isFocusableElement(this.elements[s]);)s=(t+s+e)%t,n-=1;this.currentIndex=s}hostContainsFocus(){this.host.addEventListener("focusout",this.handleFocusout),this.host.addEventListener("keydown",this.handleKeydown),this.focused=!0}hostNoLongerContainsFocus(){this.host.addEventListener("focusin",this.handleFocusin),this.host.removeEventListener("focusout",this.handleFocusout),this.host.removeEventListener("keydown",this.handleKeydown),this.currentIndex=this.focusInIndex,this.focused=!1}isRelatedTargetAnElement(e){const t=e.relatedTarget;return!this.elements.includes(t)}acceptsEventCode(e){if("End"===e||"Home"===e)return!0;switch(this.direction){case"horizontal":return"ArrowLeft"===e||"ArrowRight"===e;case"vertical":return"ArrowUp"===e||"ArrowDown"===e;case"both":case"grid":return e.startsWith("Arrow")}}manage(){this.addEventListeners()}unmanage(){this.removeEventListeners()}addEventListeners(){this.host.addEventListener("focusin",this.handleFocusin)}removeEventListeners(){this.host.removeEventListener("focusin",this.handleFocusin),this.host.removeEventListener("focusout",this.handleFocusout),this.host.removeEventListener("keydown",this.handleKeydown)}hostConnected(){this.addEventListeners()}hostDisconnected(){this.removeEventListeners()}}class i extends s{constructor(){super(...arguments),this.managed=!0,this.manageIndexesAnimationFrame=0}set focused(e){e!==this.focused&&(super.focused=e,this.manageTabindexes())}get focused(){return super.focused}clearElementCache(e=0){cancelAnimationFrame(this.manageIndexesAnimationFrame),super.clearElementCache(e),this.managed&&(this.manageIndexesAnimationFrame=requestAnimationFrame((()=>this.manageTabindexes())))}manageTabindexes(){this.focused?this.updateTabindexes((()=>({tabIndex:-1}))):this.updateTabindexes((e=>({removeTabIndex:e.contains(this.focusInElement)&&e!==this.focusInElement,tabIndex:e===this.focusInElement?0:-1})))}updateTabindexes(e){this.elements.forEach((t=>{const{tabIndex:n,removeTabIndex:s}=e(t);if(!s)return void(t.tabIndex=n);t.removeAttribute("tabindex");const i=t;i.requestUpdate&&i.requestUpdate()}))}manage(){this.managed=!0,this.manageTabindexes(),super.manage()}unmanage(){this.managed=!1,this.updateTabindexes((()=>({tabIndex:0}))),super.unmanage()}hostUpdated(){this.host.hasUpdated||this.manageTabindexes()}}export{s as F,i as R,t as f,e as r};
//# sourceMappingURL=02250eff.js.map

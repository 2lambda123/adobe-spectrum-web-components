{"version":3,"file":"6c3263f9.js","sources":["../../../node_modules/lit-html/directives/repeat.js","../../../node_modules/lit-html/async-directive.js","../../../node_modules/@lit-labs/virtualizer/polyfillLoaders/ResizeObserver.js","../../../node_modules/@lit-labs/virtualizer/events.js","../../../node_modules/@lit-labs/virtualizer/ScrollerController.js","../../../node_modules/@lit-labs/virtualizer/Virtualizer.js","../../../node_modules/@lit-labs/virtualizer/virtualize.js"],"sourcesContent":["import{noChange as e}from\"../lit-html.js\";import{directive as s,Directive as t,PartType as r}from\"../directive.js\";import{getCommittedValue as l,setChildPartValue as o,insertPart as i,removePart as n,setCommittedValue as f}from\"../directive-helpers.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst u=(e,s,t)=>{const r=new Map;for(let l=s;l<=t;l++)r.set(e[l],l);return r},c=s(class extends t{constructor(e){if(super(e),e.type!==r.CHILD)throw Error(\"repeat() can only be used in text expressions\")}ht(e,s,t){let r;void 0===t?t=s:void 0!==s&&(r=s);const l=[],o=[];let i=0;for(const s of e)l[i]=r?r(s,i):i,o[i]=t(s,i),i++;return{values:o,keys:l}}render(e,s,t){return this.ht(e,s,t).values}update(s,[t,r,c]){var d;const a=l(s),{values:p,keys:v}=this.ht(t,r,c);if(!Array.isArray(a))return this.ut=v,p;const h=null!==(d=this.ut)&&void 0!==d?d:this.ut=[],m=[];let y,x,j=0,k=a.length-1,w=0,A=p.length-1;for(;j<=k&&w<=A;)if(null===a[j])j++;else if(null===a[k])k--;else if(h[j]===v[w])m[w]=o(a[j],p[w]),j++,w++;else if(h[k]===v[A])m[A]=o(a[k],p[A]),k--,A--;else if(h[j]===v[A])m[A]=o(a[j],p[A]),i(s,m[A+1],a[j]),j++,A--;else if(h[k]===v[w])m[w]=o(a[k],p[w]),i(s,a[j],a[k]),k--,w++;else if(void 0===y&&(y=u(v,w,A),x=u(h,j,k)),y.has(h[j]))if(y.has(h[k])){const e=x.get(v[w]),t=void 0!==e?a[e]:null;if(null===t){const e=i(s,a[j]);o(e,p[w]),m[w]=e}else m[w]=o(t,p[w]),i(s,a[j],t),a[e]=null;w++}else n(a[k]),k--;else n(a[j]),j++;for(;w<=A;){const e=i(s,m[A+1]);o(e,p[w]),m[w++]=e}for(;j<=k;){const e=a[j++];null!==e&&n(e)}return this.ut=v,f(s,m),e}});export{c as repeat};\n//# sourceMappingURL=repeat.js.map\n","import{isSingleExpression as i}from\"./directive-helpers.js\";import{Directive as t,PartType as e}from\"./directive.js\";export{Directive,PartType,directive}from\"./directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=(i,t)=>{var e,o;const r=i._$AN;if(void 0===r)return!1;for(const i of r)null===(o=(e=i)._$AO)||void 0===o||o.call(e,t,!1),s(i,t);return!0},o=i=>{let t,e;do{if(void 0===(t=i._$AM))break;e=t._$AN,e.delete(i),i=t}while(0===(null==e?void 0:e.size))},r=i=>{for(let t;t=i._$AM;i=t){let e=t._$AN;if(void 0===e)t._$AN=e=new Set;else if(e.has(i))break;e.add(i),l(t)}};function n(i){void 0!==this._$AN?(o(this),this._$AM=i,r(this)):this._$AM=i}function h(i,t=!1,e=0){const r=this._$AH,n=this._$AN;if(void 0!==n&&0!==n.size)if(t)if(Array.isArray(r))for(let i=e;i<r.length;i++)s(r[i],!1),o(r[i]);else null!=r&&(s(r,!1),o(r));else s(this,i)}const l=i=>{var t,s,o,r;i.type==e.CHILD&&(null!==(t=(o=i)._$AP)&&void 0!==t||(o._$AP=h),null!==(s=(r=i)._$AQ)&&void 0!==s||(r._$AQ=n))};class c extends t{constructor(){super(...arguments),this._$AN=void 0}_$AT(i,t,e){super._$AT(i,t,e),r(this),this.isConnected=i._$AU}_$AO(i,t=!0){var e,r;i!==this.isConnected&&(this.isConnected=i,i?null===(e=this.reconnected)||void 0===e||e.call(this):null===(r=this.disconnected)||void 0===r||r.call(this)),t&&(s(this,i),o(this))}setValue(t){if(i(this._$Ct))this._$Ct._$AI(t,this);else{const i=[...this._$Ct._$AH];i[this._$Ci]=t,this._$Ct._$AI(i,this,0)}}disconnected(){}reconnected(){}}export{c as AsyncDirective};\n//# sourceMappingURL=async-directive.js.map\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nlet _RO;\nlet RO;\nexport default async function ResizeObserver() {\n    return RO || init();\n}\nasync function init() {\n    if (_RO) {\n        return (await _RO).default;\n    }\n    else {\n        _RO = window.ResizeObserver;\n        try {\n            new _RO(function () { });\n        }\n        catch (e) {\n            _RO = import('../polyfills/resize-observer-polyfill/ResizeObserver.js');\n            _RO = (await _RO).default;\n        }\n        return (RO = _RO);\n    }\n}\n//# sourceMappingURL=ResizeObserver.js.map","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nexport class RangeChangedEvent extends Event {\n    constructor(range) {\n        super(RangeChangedEvent.eventName, { bubbles: true });\n        this.first = range.first;\n        this.last = range.last;\n    }\n}\nRangeChangedEvent.eventName = 'rangeChanged';\nexport class VisibilityChangedEvent extends Event {\n    constructor(range) {\n        super(VisibilityChangedEvent.eventName, { bubbles: true });\n        this.first = range.first;\n        this.last = range.last;\n    }\n}\nVisibilityChangedEvent.eventName = 'visibilityChanged';\nexport class UnpinnedEvent extends Event {\n    constructor() {\n        super(UnpinnedEvent.eventName, { bubbles: false });\n    }\n}\nUnpinnedEvent.eventName = 'unpinned';\n//# sourceMappingURL=events.js.map","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nexport class ScrollerShim {\n    constructor(element) {\n        this._node = null;\n        this._element = null;\n        const node = element !== null && element !== void 0 ? element : window;\n        this._node = node;\n        if (element) {\n            this._element = element;\n        }\n    }\n    get element() {\n        return (this._element || document.scrollingElement || document.documentElement);\n    }\n    get scrollTop() {\n        return this.element.scrollTop || window.scrollY;\n    }\n    get scrollLeft() {\n        return this.element.scrollLeft || window.scrollX;\n    }\n    get scrollHeight() {\n        return this.element.scrollHeight;\n    }\n    get scrollWidth() {\n        return this.element.scrollWidth;\n    }\n    get viewportHeight() {\n        return this._element\n            ? this._element.getBoundingClientRect().height\n            : window.innerHeight;\n    }\n    get viewportWidth() {\n        return this._element\n            ? this._element.getBoundingClientRect().width\n            : window.innerWidth;\n    }\n    get maxScrollTop() {\n        return this.scrollHeight - this.viewportHeight;\n    }\n    get maxScrollLeft() {\n        return this.scrollWidth - this.viewportWidth;\n    }\n}\nexport class ScrollerController extends ScrollerShim {\n    constructor(client, element) {\n        super(element);\n        this._originalScrollTo = null;\n        this._originalScrollBy = null;\n        this._originalScroll = null;\n        this._clients = [];\n        this._retarget = null;\n        this._end = null;\n        this.__destination = null;\n        this.correctingScrollError = false;\n        const node = this._node;\n        const instance = ScrollerController._instanceMap.get(node);\n        if (instance) {\n            instance._attach(client);\n            return instance;\n        }\n        else {\n            this._checkForArrival = this._checkForArrival.bind(this);\n            this._updateManagedScrollTo = this._updateManagedScrollTo.bind(this);\n            this.scrollTo = this.scrollTo.bind(this);\n            this.scrollBy = this.scrollBy.bind(this);\n            this._originalScrollTo = node.scrollTo;\n            this._originalScrollBy = node.scrollBy;\n            this._originalScroll = node.scroll;\n            this._attach(client);\n        }\n    }\n    get _destination() {\n        return this.__destination;\n    }\n    get scrolling() {\n        return this._destination !== null;\n    }\n    scrollTo(p1, p2) {\n        const options = typeof p1 === 'number' && typeof p2 === 'number'\n            ? { left: p1, top: p2 }\n            : p1;\n        this._scrollTo(options);\n    }\n    scrollBy(p1, p2) {\n        const options = typeof p1 === 'number' && typeof p2 === 'number'\n            ? { left: p1, top: p2 }\n            : p1;\n        if (options.top !== undefined) {\n            options.top += this.scrollTop;\n        }\n        if (options.left !== undefined) {\n            options.left += this.scrollLeft;\n        }\n        this._scrollTo(options);\n    }\n    _nativeScrollTo(options) {\n        this._originalScrollTo.bind(this._element || window)(options);\n    }\n    _scrollTo(options, retarget = null, end = null) {\n        if (this._end !== null) {\n            this._end();\n        }\n        if (options.behavior === 'smooth') {\n            this._setDestination(options);\n            this._retarget = retarget;\n            this._end = end;\n        }\n        else {\n            this._resetScrollState();\n        }\n        this._nativeScrollTo(options);\n    }\n    _setDestination(options) {\n        let { top, left } = options;\n        top =\n            top === undefined\n                ? undefined\n                : Math.max(0, Math.min(top, this.maxScrollTop));\n        left =\n            left === undefined\n                ? undefined\n                : Math.max(0, Math.min(left, this.maxScrollLeft));\n        if (this._destination !== null &&\n            left === this._destination.left &&\n            top === this._destination.top) {\n            return false;\n        }\n        this.__destination = { top, left, behavior: 'smooth' };\n        return true;\n    }\n    _resetScrollState() {\n        this.__destination = null;\n        this._retarget = null;\n        this._end = null;\n    }\n    _updateManagedScrollTo(coordinates) {\n        if (this._destination) {\n            if (this._setDestination(coordinates)) {\n                this._nativeScrollTo(this._destination);\n            }\n        }\n    }\n    managedScrollTo(options, retarget, end) {\n        this._scrollTo(options, retarget, end);\n        return this._updateManagedScrollTo;\n    }\n    correctScrollError(coordinates) {\n        this.correctingScrollError = true;\n        requestAnimationFrame(() => requestAnimationFrame(() => (this.correctingScrollError = false)));\n        // Correct the error\n        this._nativeScrollTo(coordinates);\n        // Then, if we were headed for a specific destination, we continue scrolling:\n        // First, we update our target destination, if applicable...\n        if (this._retarget) {\n            this._setDestination(this._retarget());\n        }\n        // Then we go ahead and resume scrolling\n        if (this._destination) {\n            this._nativeScrollTo(this._destination);\n        }\n    }\n    _checkForArrival() {\n        if (this._destination !== null) {\n            const { scrollTop, scrollLeft } = this;\n            let { top, left } = this._destination;\n            top = Math.min(top || 0, this.maxScrollTop);\n            left = Math.min(left || 0, this.maxScrollLeft);\n            const topDiff = Math.abs(top - scrollTop);\n            const leftDiff = Math.abs(left - scrollLeft);\n            // We check to see if we've arrived at our destination.\n            if (topDiff < 1 && leftDiff < 1) {\n                if (this._end) {\n                    this._end();\n                }\n                this._resetScrollState();\n            }\n        }\n    }\n    detach(client) {\n        this._clients = this._clients.splice(this._clients.indexOf(client), 1);\n        if (this._clients.length === 0) {\n            this._node.scrollTo = this._originalScrollTo;\n            this._node.scrollBy = this._originalScrollBy;\n            this._node.scroll = this._originalScroll;\n            this._node.removeEventListener('scroll', this._checkForArrival);\n        }\n        return null;\n    }\n    _attach(client) {\n        this._clients.push(client);\n        if (this._clients.length === 1) {\n            this._node.scrollTo = this.scrollTo;\n            this._node.scrollBy = this.scrollBy;\n            this._node.scroll = this.scrollTo;\n            this._node.addEventListener('scroll', this._checkForArrival);\n        }\n    }\n}\nScrollerController._instanceMap = new WeakMap();\n//# sourceMappingURL=ScrollerController.js.map","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nimport getResizeObserver from './polyfillLoaders/ResizeObserver.js';\nimport { RangeChangedEvent, VisibilityChangedEvent, UnpinnedEvent, } from './events.js';\nimport { ScrollerController } from './ScrollerController.js';\nexport const virtualizerRef = Symbol('virtualizerRef');\nconst SIZER_ATTRIBUTE = 'virtualizer-sizer';\nlet DefaultLayoutConstructor;\n/**\n * Provides virtual scrolling boilerplate.\n *\n * Extensions of this class must set hostElement and layout.\n *\n * Extensions of this class must also override VirtualRepeater's DOM\n * manipulation methods.\n */\nexport class Virtualizer {\n    constructor(config) {\n        this._benchmarkStart = null;\n        this._layout = null;\n        this._clippingAncestors = [];\n        /**\n         * Layout provides these values, we set them on _render().\n         * TODO @straversi: Can we find an XOR type, usable for the key here?\n         */\n        this._scrollSize = null;\n        /**\n         * Difference between scroll target's current and required scroll offsets.\n         * Provided by layout.\n         */\n        this._scrollError = null;\n        /**\n         * A list of the positions (top, left) of the children in the current range.\n         */\n        this._childrenPos = null;\n        // TODO: (graynorton): type\n        this._childMeasurements = null;\n        this._toBeMeasured = new Map();\n        this._rangeChanged = true;\n        this._itemsChanged = true;\n        this._visibilityChanged = true;\n        this._scrollerController = null;\n        this._isScroller = false;\n        this._sizer = null;\n        /**\n         * Resize observer attached to hostElement.\n         */\n        this._hostElementRO = null;\n        /**\n         * Resize observer attached to children.\n         */\n        this._childrenRO = null;\n        this._mutationObserver = null;\n        this._scrollEventListeners = [];\n        this._scrollEventListenerOptions = {\n            passive: true,\n        };\n        // TODO (graynorton): Rethink, per longer comment below\n        this._loadListener = this._childLoaded.bind(this);\n        /**\n         * Index of element to scroll into view, plus scroll\n         * behavior options, as imperatively specified via\n         * `element(index).scrollIntoView()`\n         */\n        this._scrollIntoViewTarget = null;\n        this._updateScrollIntoViewCoordinates = null;\n        /**\n         * Items to render. Set by items.\n         */\n        this._items = [];\n        /**\n         * Index of the first child in the range, not necessarily the first visible child.\n         * TODO @straversi: Consider renaming these.\n         */\n        this._first = -1;\n        /**\n         * Index of the last child in the range.\n         */\n        this._last = -1;\n        /**\n         * Index of the first item intersecting the viewport.\n         */\n        this._firstVisible = -1;\n        /**\n         * Index of the last item intersecting the viewport.\n         */\n        this._lastVisible = -1;\n        this._scheduled = new WeakSet();\n        /**\n         * Invoked at the end of each render cycle: children in the range are\n         * measured, and their dimensions passed to this callback. Use it to layout\n         * children as needed.\n         */\n        this._measureCallback = null;\n        this._measureChildOverride = null;\n        /**\n         * State for `layoutComplete` promise\n         */\n        this._layoutCompletePromise = null;\n        this._layoutCompleteResolver = null;\n        this._layoutCompleteRejecter = null;\n        this._pendingLayoutComplete = null;\n        if (!config) {\n            throw new Error('Virtualizer constructor requires a configuration object');\n        }\n        if (config.hostElement) {\n            this._init(config);\n        }\n        else {\n            throw new Error('Virtualizer configuration requires the \"hostElement\" property');\n        }\n    }\n    set items(items) {\n        if (Array.isArray(items) && items !== this._items) {\n            this._itemsChanged = true;\n            this._items = items;\n            this._schedule(this._updateLayout);\n        }\n    }\n    _init(config) {\n        this._isScroller = !!config.scroller;\n        this._initHostElement(config);\n        // If no layout is specified, we make an empty\n        // layout config, which will result in the default\n        // layout with default parameters\n        this._initLayout(config.layout || {});\n    }\n    async _initObservers() {\n        this._mutationObserver = new MutationObserver(this._finishDOMUpdate.bind(this));\n        const ResizeObserver = await getResizeObserver();\n        this._hostElementRO = new ResizeObserver(() => this._hostElementSizeChanged());\n        this._childrenRO = new ResizeObserver(this._childrenSizeChanged.bind(this));\n    }\n    _initHostElement(config) {\n        const hostElement = (this._hostElement = config.hostElement);\n        this._applyVirtualizerStyles();\n        hostElement[virtualizerRef] = this;\n    }\n    async connected() {\n        await this._initObservers();\n        const includeSelf = this._isScroller;\n        this._clippingAncestors = getClippingAncestors(this._hostElement, includeSelf);\n        this._scrollerController = new ScrollerController(this, this._clippingAncestors[0]);\n        this._schedule(this._updateLayout);\n        this._observeAndListen();\n    }\n    _observeAndListen() {\n        this._mutationObserver.observe(this._hostElement, { childList: true });\n        this._hostElementRO.observe(this._hostElement);\n        this._scrollEventListeners.push(window);\n        window.addEventListener('scroll', this, this._scrollEventListenerOptions);\n        this._clippingAncestors.forEach((ancestor) => {\n            ancestor.addEventListener('scroll', this, this._scrollEventListenerOptions);\n            this._scrollEventListeners.push(ancestor);\n            this._hostElementRO.observe(ancestor);\n        });\n        this._hostElementRO.observe(this._scrollerController.element);\n        this._children.forEach((child) => this._childrenRO.observe(child));\n        this._scrollEventListeners.forEach((target) => target.addEventListener('scroll', this, this._scrollEventListenerOptions));\n    }\n    disconnected() {\n        var _a, _b, _c, _d;\n        this._scrollEventListeners.forEach((target) => target.removeEventListener('scroll', this, this._scrollEventListenerOptions));\n        this._scrollEventListeners = [];\n        this._clippingAncestors = [];\n        this._scrollerController = ((_a = this._scrollerController) === null || _a === void 0 ? void 0 : _a.detach(this)) || null;\n        (_b = this._mutationObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n        (_c = this._hostElementRO) === null || _c === void 0 ? void 0 : _c.disconnect();\n        (_d = this._childrenRO) === null || _d === void 0 ? void 0 : _d.disconnect();\n        this._rejectLayoutCompletePromise('disconnected');\n    }\n    _applyVirtualizerStyles() {\n        const hostElement = this._hostElement;\n        // Would rather set these CSS properties on the host using Shadow Root\n        // style scoping (and falling back to a global stylesheet where native\n        // Shadow DOM is not available), but this Mobile Safari bug is preventing\n        // that from working: https://bugs.webkit.org/show_bug.cgi?id=226195\n        const style = hostElement.style;\n        style.display = style.display || 'block';\n        style.position = style.position || 'relative';\n        style.contain = style.contain || 'size layout';\n        if (this._isScroller) {\n            style.overflow = style.overflow || 'auto';\n            style.minHeight = style.minHeight || '150px';\n        }\n    }\n    _getSizer() {\n        const hostElement = this._hostElement;\n        if (!this._sizer) {\n            // Use a pre-existing sizer element if provided (for better integration\n            // with vDOM renderers)\n            let sizer = hostElement.querySelector(`[${SIZER_ATTRIBUTE}]`);\n            if (!sizer) {\n                sizer = document.createElement('div');\n                sizer.setAttribute(SIZER_ATTRIBUTE, '');\n                hostElement.appendChild(sizer);\n            }\n            // When the scrollHeight is large, the height of this element might be\n            // ignored. Setting content and font-size ensures the element has a size.\n            Object.assign(sizer.style, {\n                position: 'absolute',\n                margin: '-2px 0 0 0',\n                padding: 0,\n                visibility: 'hidden',\n                fontSize: '2px',\n            });\n            sizer.innerHTML = '&nbsp;';\n            sizer.setAttribute(SIZER_ATTRIBUTE, '');\n            this._sizer = sizer;\n        }\n        return this._sizer;\n    }\n    updateLayoutConfig(layoutConfig) {\n        const Ctor = layoutConfig.type ||\n            DefaultLayoutConstructor;\n        if (typeof Ctor === 'function' && this._layout instanceof Ctor) {\n            const config = { ...layoutConfig };\n            delete config.type;\n            this._layout.config = config;\n            return true;\n        }\n        return false;\n    }\n    async _initLayout(layoutConfig) {\n        let config;\n        let Ctor;\n        if (typeof layoutConfig.type === 'function') {\n            // If we have a full LayoutSpecifier, the `type` property\n            // gives us our constructor...\n            Ctor = layoutConfig.type;\n            // ...while the rest of the specifier is our layout config\n            const copy = { ...layoutConfig };\n            delete copy.type;\n            config = copy;\n        }\n        else {\n            // If we don't have a full LayoutSpecifier, we just\n            // have a config for the default layout\n            config = layoutConfig;\n        }\n        if (Ctor === undefined) {\n            // If we don't have a constructor yet, load the default\n            DefaultLayoutConstructor = Ctor = (await import('./layouts/flow.js'))\n                .FlowLayout;\n        }\n        this._layout = new Ctor(config);\n        if (this._layout.measureChildren &&\n            typeof this._layout.updateItemSizes === 'function') {\n            if (typeof this._layout.measureChildren === 'function') {\n                this._measureChildOverride = this._layout.measureChildren;\n            }\n            this._measureCallback = this._layout.updateItemSizes.bind(this._layout);\n        }\n        this._layout.addEventListener('scrollsizechange', this);\n        this._layout.addEventListener('scrollerrorchange', this);\n        this._layout.addEventListener('itempositionchange', this);\n        this._layout.addEventListener('rangechange', this);\n        this._layout.addEventListener('unpinned', this);\n        if (this._layout.listenForChildLoadEvents) {\n            this._hostElement.addEventListener('load', this._loadListener, true);\n        }\n        this._schedule(this._updateLayout);\n    }\n    // TODO (graynorton): Rework benchmarking so that it has no API and\n    // instead is always on except in production builds\n    startBenchmarking() {\n        if (this._benchmarkStart === null) {\n            this._benchmarkStart = window.performance.now();\n        }\n    }\n    stopBenchmarking() {\n        if (this._benchmarkStart !== null) {\n            const now = window.performance.now();\n            const timeElapsed = now - this._benchmarkStart;\n            const entries = performance.getEntriesByName('uv-virtualizing', 'measure');\n            const virtualizationTime = entries\n                .filter((e) => e.startTime >= this._benchmarkStart && e.startTime < now)\n                .reduce((t, m) => t + m.duration, 0);\n            this._benchmarkStart = null;\n            return { timeElapsed, virtualizationTime };\n        }\n        return null;\n    }\n    _measureChildren() {\n        const mm = {};\n        const children = this._children;\n        const fn = this._measureChildOverride || this._measureChild;\n        for (let i = 0; i < children.length; i++) {\n            const child = children[i];\n            const idx = this._first + i;\n            if (this._itemsChanged || this._toBeMeasured.has(child)) {\n                mm[idx] = fn.call(this, child, this._items[idx]);\n            }\n        }\n        this._childMeasurements = mm;\n        this._schedule(this._updateLayout);\n        this._toBeMeasured.clear();\n    }\n    /**\n     * Returns the width, height, and margins of the given child.\n     */\n    _measureChild(element) {\n        // offsetWidth doesn't take transforms in consideration, so we use\n        // getBoundingClientRect which does.\n        const { width, height } = element.getBoundingClientRect();\n        return Object.assign({ width, height }, getMargins(element));\n    }\n    async _schedule(method) {\n        if (!this._scheduled.has(method)) {\n            this._scheduled.add(method);\n            await Promise.resolve();\n            this._scheduled.delete(method);\n            method.call(this);\n        }\n    }\n    async _updateDOM() {\n        const { _rangeChanged, _itemsChanged } = this;\n        if (this._visibilityChanged) {\n            this._notifyVisibility();\n            this._visibilityChanged = false;\n        }\n        if (_rangeChanged || _itemsChanged) {\n            this._notifyRange();\n            this._rangeChanged = false;\n        }\n        else {\n            this._finishDOMUpdate();\n        }\n    }\n    _finishDOMUpdate() {\n        this._children.forEach((child) => this._childrenRO.observe(child));\n        this._checkScrollIntoViewTarget(this._childrenPos);\n        this._positionChildren(this._childrenPos);\n        this._sizeHostElement(this._scrollSize);\n        this._correctScrollError();\n        if (this._benchmarkStart && 'mark' in window.performance) {\n            window.performance.mark('uv-end');\n        }\n    }\n    _updateLayout() {\n        if (this._layout) {\n            this._layout.items = this._items;\n            this._updateView();\n            if (this._childMeasurements !== null) {\n                // If the layout has been changed, we may have measurements but no callback\n                if (this._measureCallback) {\n                    this._measureCallback(this._childMeasurements);\n                }\n                this._childMeasurements = null;\n            }\n            this._layout.reflowIfNeeded();\n            if (this._benchmarkStart && 'mark' in window.performance) {\n                window.performance.mark('uv-end');\n            }\n        }\n    }\n    _handleScrollEvent() {\n        var _a;\n        if (this._benchmarkStart && 'mark' in window.performance) {\n            try {\n                window.performance.measure('uv-virtualizing', 'uv-start', 'uv-end');\n            }\n            catch (e) {\n                console.warn('Error measuring performance data: ', e);\n            }\n            window.performance.mark('uv-start');\n        }\n        if (this._scrollerController.correctingScrollError === false) {\n            // This is a user-initiated scroll, so we unpin the layout\n            (_a = this._layout) === null || _a === void 0 ? void 0 : _a.unpin();\n        }\n        this._schedule(this._updateLayout);\n    }\n    handleEvent(event) {\n        switch (event.type) {\n            case 'scroll':\n                if (event.currentTarget === window ||\n                    this._clippingAncestors.includes(event.currentTarget)) {\n                    this._handleScrollEvent();\n                }\n                break;\n            case 'scrollsizechange':\n                this._scrollSize = event.detail;\n                this._schedule(this._updateDOM);\n                break;\n            case 'scrollerrorchange':\n                this._scrollError = event.detail;\n                this._schedule(this._updateDOM);\n                break;\n            case 'itempositionchange':\n                this._childrenPos = event.detail;\n                this._schedule(this._updateDOM);\n                break;\n            case 'rangechange':\n                this._adjustRange(event.detail);\n                this._schedule(this._updateDOM);\n                break;\n            case 'unpinned':\n                this._hostElement.dispatchEvent(new UnpinnedEvent());\n                break;\n            default:\n                console.warn('event not handled', event);\n        }\n    }\n    get _children() {\n        const arr = [];\n        let next = this._hostElement.firstElementChild;\n        while (next) {\n            if (!next.hasAttribute(SIZER_ATTRIBUTE)) {\n                arr.push(next);\n            }\n            next = next.nextElementSibling;\n        }\n        return arr;\n    }\n    _updateView() {\n        var _a;\n        const hostElement = this._hostElement;\n        const scrollingElement = (_a = this._scrollerController) === null || _a === void 0 ? void 0 : _a.element;\n        const layout = this._layout;\n        if (hostElement && scrollingElement && layout) {\n            let top, left, bottom, right;\n            const hostElementBounds = hostElement.getBoundingClientRect();\n            top = 0;\n            left = 0;\n            bottom = window.innerHeight;\n            right = window.innerWidth;\n            const ancestorBounds = this._clippingAncestors.map((ancestor) => ancestor.getBoundingClientRect());\n            ancestorBounds.unshift(hostElementBounds);\n            for (const bounds of ancestorBounds) {\n                top = Math.max(top, bounds.top);\n                left = Math.max(left, bounds.left);\n                bottom = Math.min(bottom, bounds.bottom);\n                right = Math.min(right, bounds.right);\n            }\n            const scrollingElementBounds = scrollingElement.getBoundingClientRect();\n            const offsetWithinScroller = {\n                left: hostElementBounds.left - scrollingElementBounds.left,\n                top: hostElementBounds.top - scrollingElementBounds.top,\n            };\n            const totalScrollSize = {\n                width: scrollingElement.scrollWidth,\n                height: scrollingElement.scrollHeight,\n            };\n            const scrollTop = top - hostElementBounds.top + hostElement.scrollTop;\n            const scrollLeft = left - hostElementBounds.left + hostElement.scrollLeft;\n            const height = Math.max(1, bottom - top);\n            const width = Math.max(1, right - left);\n            layout.viewportSize = { width, height };\n            layout.viewportScroll = { top: scrollTop, left: scrollLeft };\n            layout.totalScrollSize = totalScrollSize;\n            layout.offsetWithinScroller = offsetWithinScroller;\n        }\n    }\n    /**\n     * Styles the host element so that its size reflects the\n     * total size of all items.\n     */\n    _sizeHostElement(size) {\n        // Some browsers seem to crap out if the host element gets larger than\n        // a certain size, so we clamp it here (this value based on ad hoc\n        // testing in Chrome / Safari / Firefox Mac)\n        const max = 8200000;\n        const h = size && size.width !== null ? Math.min(max, size.width) : 0;\n        const v = size && size.height !== null ? Math.min(max, size.height) : 0;\n        if (this._isScroller) {\n            this._getSizer().style.transform = `translate(${h}px, ${v}px)`;\n        }\n        else {\n            const style = this._hostElement.style;\n            style.minWidth = h ? `${h}px` : '100%';\n            style.minHeight = v ? `${v}px` : '100%';\n        }\n    }\n    /**\n     * Sets the top and left transform style of the children from the values in\n     * pos.\n     */\n    _positionChildren(pos) {\n        if (pos) {\n            pos.forEach(({ top, left, width, height, xOffset, yOffset }, index) => {\n                const child = this._children[index - this._first];\n                if (child) {\n                    child.style.position = 'absolute';\n                    child.style.boxSizing = 'border-box';\n                    child.style.transform = `translate(${left}px, ${top}px)`;\n                    if (width !== undefined) {\n                        child.style.width = width + 'px';\n                    }\n                    if (height !== undefined) {\n                        child.style.height = height + 'px';\n                    }\n                    child.style.left =\n                        xOffset === undefined ? null : xOffset + 'px';\n                    child.style.top =\n                        yOffset === undefined ? null : yOffset + 'px';\n                }\n            });\n        }\n    }\n    async _adjustRange(range) {\n        const { _first, _last, _firstVisible, _lastVisible } = this;\n        this._first = range.first;\n        this._last = range.last;\n        this._firstVisible = range.firstVisible;\n        this._lastVisible = range.lastVisible;\n        this._rangeChanged =\n            this._rangeChanged || this._first !== _first || this._last !== _last;\n        this._visibilityChanged =\n            this._visibilityChanged ||\n                this._firstVisible !== _firstVisible ||\n                this._lastVisible !== _lastVisible;\n    }\n    _correctScrollError() {\n        if (this._scrollError) {\n            const { scrollTop, scrollLeft } = this._scrollerController;\n            const { top, left } = this._scrollError;\n            this._scrollError = null;\n            this._scrollerController.correctScrollError({\n                top: scrollTop - top,\n                left: scrollLeft - left,\n            });\n        }\n    }\n    element(index) {\n        var _a;\n        if (index === Infinity) {\n            index = this._items.length - 1;\n        }\n        return ((_a = this._items) === null || _a === void 0 ? void 0 : _a[index]) === undefined\n            ? undefined\n            : {\n                scrollIntoView: (options = {}) => this._scrollElementIntoView({ ...options, index }),\n            };\n    }\n    _scrollElementIntoView(options) {\n        if (options.index >= this._first && options.index <= this._last) {\n            this._children[options.index - this._first].scrollIntoView(options);\n        }\n        else {\n            options.index = Math.min(options.index, this._items.length - 1);\n            if (options.behavior === 'smooth') {\n                const coordinates = this._layout.getScrollIntoViewCoordinates(options);\n                const { behavior } = options;\n                this._updateScrollIntoViewCoordinates =\n                    this._scrollerController.managedScrollTo(Object.assign(coordinates, { behavior }), () => this._layout.getScrollIntoViewCoordinates(options), () => (this._scrollIntoViewTarget = null));\n                this._scrollIntoViewTarget = options;\n            }\n            else {\n                this._layout.pin = options;\n            }\n        }\n    }\n    /**\n     * If we are smoothly scrolling to an element and the target element\n     * is in the DOM, we update our target coordinates as needed\n     */\n    _checkScrollIntoViewTarget(pos) {\n        const { index } = this._scrollIntoViewTarget || {};\n        if (index && (pos === null || pos === void 0 ? void 0 : pos.has(index))) {\n            this._updateScrollIntoViewCoordinates(this._layout.getScrollIntoViewCoordinates(this._scrollIntoViewTarget));\n        }\n    }\n    /**\n     * Emits a rangechange event with the current first, last, firstVisible, and\n     * lastVisible.\n     */\n    _notifyRange() {\n        this._hostElement.dispatchEvent(new RangeChangedEvent({ first: this._first, last: this._last }));\n    }\n    _notifyVisibility() {\n        this._hostElement.dispatchEvent(new VisibilityChangedEvent({\n            first: this._firstVisible,\n            last: this._lastVisible,\n        }));\n    }\n    get layoutComplete() {\n        // Lazily create promise\n        if (!this._layoutCompletePromise) {\n            this._layoutCompletePromise = new Promise((resolve, reject) => {\n                this._layoutCompleteResolver = resolve;\n                this._layoutCompleteRejecter = reject;\n            });\n        }\n        return this._layoutCompletePromise;\n    }\n    _rejectLayoutCompletePromise(reason) {\n        if (this._layoutCompleteRejecter !== null) {\n            this._layoutCompleteRejecter(reason);\n        }\n        this._resetLayoutCompleteState();\n    }\n    _scheduleLayoutComplete() {\n        // Don't do anything unless we have a pending promise\n        // And only request a frame if we haven't already done so\n        if (this._layoutCompletePromise && this._pendingLayoutComplete === null) {\n            // Wait one additional frame to be sure the layout is stable\n            this._pendingLayoutComplete = requestAnimationFrame(() => requestAnimationFrame(() => this._resolveLayoutCompletePromise()));\n        }\n    }\n    _resolveLayoutCompletePromise() {\n        if (this._layoutCompleteResolver !== null) {\n            this._layoutCompleteResolver();\n        }\n        this._resetLayoutCompleteState();\n    }\n    _resetLayoutCompleteState() {\n        this._layoutCompletePromise = null;\n        this._layoutCompleteResolver = null;\n        this._layoutCompleteRejecter = null;\n        this._pendingLayoutComplete = null;\n    }\n    /**\n     * Render and update the view at the next opportunity with the given\n     * hostElement size.\n     */\n    _hostElementSizeChanged() {\n        this._schedule(this._updateLayout);\n    }\n    // TODO (graynorton): Rethink how this works. Probably child loading is too specific\n    // to have dedicated support for; might want some more generic lifecycle hooks for\n    // layouts to use. Possibly handle measurement this way, too, or maybe that remains\n    // a first-class feature?\n    _childLoaded() { }\n    // This is the callback for the ResizeObserver that watches the\n    // virtualizer's children. We land here at the end of every virtualizer\n    // update cycle that results in changes to physical items, and we also\n    // end up here if one or more children change size independently of\n    // the virtualizer update cycle.\n    _childrenSizeChanged(changes) {\n        // Only measure if the layout requires it\n        if (this._layout.measureChildren) {\n            for (const change of changes) {\n                this._toBeMeasured.set(change.target, change.contentRect);\n            }\n            this._measureChildren();\n        }\n        // If this is the end of an update cycle, we need to reset some\n        // internal state. This should be a harmless no-op if we're handling\n        // an out-of-cycle ResizeObserver callback, so we don't need to\n        // distinguish between the two cases.\n        this._scheduleLayoutComplete();\n        this._itemsChanged = false;\n        this._rangeChanged = false;\n    }\n}\nfunction getMargins(el) {\n    const style = window.getComputedStyle(el);\n    return {\n        marginTop: getMarginValue(style.marginTop),\n        marginRight: getMarginValue(style.marginRight),\n        marginBottom: getMarginValue(style.marginBottom),\n        marginLeft: getMarginValue(style.marginLeft),\n    };\n}\nfunction getMarginValue(value) {\n    const float = value ? parseFloat(value) : NaN;\n    return Number.isNaN(float) ? 0 : float;\n}\n// TODO (graynorton): Deal with iframes?\nfunction getParentElement(el) {\n    if (el.assignedSlot !== null) {\n        return el.assignedSlot;\n    }\n    if (el.parentElement !== null) {\n        return el.parentElement;\n    }\n    const parentNode = el.parentNode;\n    if (parentNode && parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        return parentNode.host || null;\n    }\n    return null;\n}\n///\nfunction getElementAncestors(el, includeSelf = false) {\n    const ancestors = [];\n    let parent = includeSelf ? el : getParentElement(el);\n    while (parent !== null) {\n        ancestors.push(parent);\n        parent = getParentElement(parent);\n    }\n    return ancestors;\n}\nfunction getClippingAncestors(el, includeSelf = false) {\n    return getElementAncestors(el, includeSelf).filter((a) => getComputedStyle(a).overflow !== 'visible');\n}\n//# sourceMappingURL=Virtualizer.js.map","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nimport { html } from 'lit';\nimport { directive, PartType } from 'lit/directive.js';\nimport { AsyncDirective } from 'lit/async-directive.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { Virtualizer } from './Virtualizer.js';\nexport { virtualizerRef } from './Virtualizer.js';\nexport const defaultKeyFunction = (item) => item;\nexport const defaultRenderItem = (item, idx) => html `${idx}: ${JSON.stringify(item, null, 2)}`;\nclass VirtualizeDirective extends AsyncDirective {\n    constructor(part) {\n        super(part);\n        this._virtualizer = null;\n        this._first = 0;\n        this._last = -1;\n        this._renderItem = (item, idx) => defaultRenderItem(item, idx + this._first);\n        this._keyFunction = (item, idx) => defaultKeyFunction(item, idx + this._first);\n        this._items = [];\n        if (part.type !== PartType.CHILD) {\n            throw new Error('The virtualize directive can only be used in child expressions');\n        }\n    }\n    render(config) {\n        if (config) {\n            this._setFunctions(config);\n        }\n        const itemsToRender = [];\n        // TODO (graynorton): Is this the best / only place to ensure\n        // that _last isn't outside the current bounds of the items array?\n        // Not sure we should ever arrive here with it out of bounds.\n        // Repro case for original issue: https://tinyurl.com/yes8b2e6\n        const lastItem = Math.min(this._items.length, this._last + 1);\n        if (this._first >= 0 && this._last >= this._first) {\n            for (let i = this._first; i < lastItem; i++) {\n                itemsToRender.push(this._items[i]);\n            }\n        }\n        return repeat(itemsToRender, this._keyFunction, this._renderItem);\n    }\n    update(part, [config]) {\n        this._setFunctions(config);\n        this._items = config.items || [];\n        if (this._virtualizer) {\n            this._updateVirtualizerConfig(part, config);\n        }\n        else {\n            this._initialize(part, config);\n        }\n        return this.render();\n    }\n    _updateVirtualizerConfig(part, config) {\n        const compatible = this._virtualizer.updateLayoutConfig(config.layout || {});\n        if (!compatible) {\n            const hostElement = part.parentNode;\n            this._makeVirtualizer(hostElement, config);\n        }\n        this._virtualizer.items = this._items;\n    }\n    _setFunctions(config) {\n        const { renderItem, keyFunction } = config;\n        if (renderItem) {\n            this._renderItem = (item, idx) => renderItem(item, idx + this._first);\n        }\n        if (keyFunction) {\n            this._keyFunction = (item, idx) => keyFunction(item, idx + this._first);\n        }\n    }\n    _makeVirtualizer(hostElement, config) {\n        if (this._virtualizer) {\n            this._virtualizer.disconnected();\n        }\n        const { layout, scroller, items } = config;\n        this._virtualizer = new Virtualizer({ hostElement, layout, scroller });\n        this._virtualizer.items = items;\n        this._virtualizer.connected();\n    }\n    _initialize(part, config) {\n        const hostElement = part.parentNode;\n        if (hostElement && hostElement.nodeType === 1) {\n            hostElement.addEventListener('rangeChanged', (e) => {\n                e.stopPropagation();\n                this._first = e.first;\n                this._last = e.last;\n                this.setValue(this.render());\n            });\n            this._makeVirtualizer(hostElement, config);\n        }\n    }\n    disconnected() {\n        var _a;\n        (_a = this._virtualizer) === null || _a === void 0 ? void 0 : _a.disconnected();\n    }\n    reconnected() {\n        var _a;\n        (_a = this._virtualizer) === null || _a === void 0 ? void 0 : _a.connected();\n    }\n}\nexport const virtualize = directive(VirtualizeDirective);\n//# sourceMappingURL=virtualize.js.map"],"names":["generateMap","u","list","start","end","map","Map","i","set","r","repeat","directive","constructor","partInfo","super","type","PartType","CHILD","Error","_getValuesAndKeys","items","keyFnOrTemplate","template","keyFn","l","values","s","e","keys","index","item","render","update","containerPart","d","getCommittedValue","newValues","newKeys","this","Array","isArray","oldParts","_itemKeys","h","_a","newParts","newKeyToIndexMap","oldKeyToIndexMap","oldHead","oldTail","length","newHead","newTail","oldKeys","setChildPartValue","insertPart","undefined","has","get","oldPart","oldIndex","newPart","removePart","setCommittedValue","noChange","notifyChildrenConnectedChanged","parent","isConnected","children","_$disconnectableChildren","obj","_b","_$AO","o","removeDisconnectableFromParent","_$parent","delete","size","addDisconnectableToParent","t","Set","add","installDisconnectAPI","newParent","isClearingValue","fromPartIndex","value","_$committedValue","_$notifyConnectionChanged","notifyChildPartConnectedChanged","_$reparentDisconnectables","reparentDisconnectables","c","_$initialize","part","attributeIndex","_$isConnected","isClearingDirective","reconnected","disconnected","setValue","isSingleExpression","__part","_$setValue","__attributeIndex","Directive","_RO","RO","async","ResizeObserver","default","window","import","init","Event","range","RangeChangedEvent","eventName","bubbles","first","last","VisibilityChangedEvent","UnpinnedEvent","ScrollerShim","element","_node","_element","node","document","scrollingElement","documentElement","scrollTop","scrollY","scrollLeft","scrollX","scrollHeight","scrollWidth","viewportHeight","getBoundingClientRect","height","innerHeight","viewportWidth","width","innerWidth","maxScrollTop","maxScrollLeft","client","_originalScrollTo","_originalScrollBy","_originalScroll","__destination","correctingScrollError","ScrollerController","_instanceMap","instance","_attach","_checkForArrival","bind","_updateManagedScrollTo","scrollTo","scrollBy","scroll","scrolling","_destination","p1","p2","left","top","_scrollTo","options","_nativeScrollTo","retarget","_end","behavior","_setDestination","_retarget","_resetScrollState","Math","max","min","coordinates","managedScrollTo","correctScrollError","requestAnimationFrame","abs","topDiff","leftDiff","detach","_clients","splice","indexOf","removeEventListener","push","addEventListener","virtualizerRef","Symbol","Virtualizer","config","_benchmarkStart","_layout","_clippingAncestors","_scrollSize","_scrollError","_childrenPos","_childMeasurements","_toBeMeasured","_rangeChanged","_itemsChanged","_visibilityChanged","_scrollerController","_sizer","_hostElementRO","_childrenRO","_mutationObserver","_scrollEventListeners","_scrollEventListenerOptions","passive","_loadListener","_childLoaded","_scrollIntoViewTarget","_updateScrollIntoViewCoordinates","_items","_first","_last","_firstVisible","_lastVisible","WeakSet","_measureCallback","_measureChildOverride","_layoutCompletePromise","_layoutCompleteResolver","_layoutCompleteRejecter","_pendingLayoutComplete","hostElement","_init","_schedule","_updateLayout","_isScroller","scroller","_initHostElement","_initLayout","layout","MutationObserver","_finishDOMUpdate","_hostElementSizeChanged","_childrenSizeChanged","_hostElement","_applyVirtualizerStyles","_initObservers","el","includeSelf","getParentElement","ancestors","getElementAncestors","filter","a","getComputedStyle","overflow","getClippingAncestors","_observeAndListen","observe","childList","forEach","ancestor","_children","child","target","disconnect","_c","_d","_rejectLayoutCompletePromise","style","display","position","contain","minHeight","_getSizer","querySelector","sizer","createElement","setAttribute","appendChild","Object","assign","margin","padding","visibility","fontSize","innerHTML","updateLayoutConfig","layoutConfig","Ctor","DefaultLayoutConstructor","copy","FlowLayout","measureChildren","updateItemSizes","listenForChildLoadEvents","startBenchmarking","performance","now","stopBenchmarking","timeElapsed","getEntriesByName","startTime","reduce","m","duration","virtualizationTime","_measureChildren","mm","fn","_measureChild","idx","call","clear","marginTop","getMarginValue","marginRight","marginBottom","marginLeft","getMargins","method","_scheduled","Promise","resolve","_notifyVisibility","_notifyRange","_checkScrollIntoViewTarget","_positionChildren","_sizeHostElement","_correctScrollError","mark","_updateView","reflowIfNeeded","_handleScrollEvent","measure","console","warn","unpin","handleEvent","event","currentTarget","includes","detail","_updateDOM","_adjustRange","dispatchEvent","arr","next","firstElementChild","hasAttribute","nextElementSibling","bottom","right","hostElementBounds","ancestorBounds","unshift","bounds","scrollingElementBounds","offsetWithinScroller","totalScrollSize","viewportSize","viewportScroll","v","transform","minWidth","pos","xOffset","yOffset","boxSizing","firstVisible","lastVisible","Infinity","scrollIntoView","_scrollElementIntoView","getScrollIntoViewCoordinates","pin","layoutComplete","reject","reason","_resetLayoutCompleteState","_scheduleLayoutComplete","_resolveLayoutCompletePromise","changes","change","contentRect","float","parseFloat","NaN","Number","isNaN","assignedSlot","parentElement","parentNode","nodeType","Node","DOCUMENT_FRAGMENT_NODE","host","defaultKeyFunction","defaultRenderItem","html","JSON","stringify","virtualize","AsyncDirective","_keyFunction","_setFunctions","itemsToRender","lastItem","_renderItem","_virtualizer","_updateVirtualizerConfig","_initialize","_makeVirtualizer","renderItem","keyFunction","connected","stopPropagation"],"mappings":"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"}
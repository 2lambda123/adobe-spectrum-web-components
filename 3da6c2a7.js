import{S as t,$ as e,_ as n,e as i}from"./a9613eee.js";import{f as o,r as s}from"./a3547505.js";import{r}from"./e50c5e8d.js";import{l as a}from"./e037b441.js";import"./bb8092e8.js";import"./a677b711.js";import"./705fa87a.js";import"./e0f88c43.js";import"./db7e5735.js";var l=r`@keyframes sp-overlay-fade-in{0%{opacity:0;transform:var(--sp-overlay-from)}to{opacity:1;transform:translate(0)}}@keyframes sp-overlay-fade-out{0%{opacity:1;transform:translate(0)}to{opacity:0;transform:var(--sp-overlay-from)}}:host{display:inline-block;left:-9999em;pointer-events:none;position:absolute;top:-9999em;z-index:1000}:host(:focus){outline:0}:host([placement=none]){height:100vh;height:-webkit-fill-available;height:fill-available;left:0;max-height:var(--swc-visual-viewport-height);position:fixed;top:0}#contents,sp-theme{height:100%}#contents{animation-duration:var(
--swc-test-duration,var(--spectrum-global-animation-duration-200,.16s)
);animation-timing-function:var(
--spectrum-global-animation-ease-out,ease-out
);display:inline-block;opacity:1;pointer-events:none;visibility:visible}:host([actual-placement*=top]) #contents{--sp-overlay-from:translateY(var(--spectrum-global-dimension-size-75));align-items:flex-end;display:inline-flex}:host([actual-placement*=right]) #contents{--sp-overlay-from:translateX(calc(var(--spectrum-global-dimension-size-75)*-1))}:host([actual-placement*=bottom]) #contents{--sp-overlay-from:translateY(calc(var(--spectrum-global-dimension-size-75)*-1))}:host([actual-placement*=left]) #contents{--sp-overlay-from:translateX(var(--spectrum-global-dimension-size-75))}:host([animating]) ::slotted(*){pointer-events:none}:host(:not([animating])) ::slotted(*){pointer-events:auto}#contents ::slotted(*){position:relative}`;function c(t){return t.split("-")[0]}function h(t){return t.split("-")[1]}function d(t){return["top","bottom"].includes(c(t))?"x":"y"}function p(t){return"y"===t?"height":"width"}function u(t){let{reference:e,floating:n,placement:i}=t;const o=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2;let r;switch(c(i)){case"top":r={x:o,y:e.y-n.height};break;case"bottom":r={x:o,y:e.y+e.height};break;case"right":r={x:e.x+e.width,y:s};break;case"left":r={x:e.x-n.width,y:s};break;default:r={x:e.x,y:e.y}}const a=d(i),l=p(a);switch(h(i)){case"start":r[a]=r[a]-(e[l]/2-n[l]/2);break;case"end":r[a]=r[a]+(e[l]/2-n[l]/2)}return r}function m(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function f(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function y(t,e){void 0===e&&(e={});const{x:n,y:i,platform:o,rects:s,elements:r,strategy:a}=t,{boundary:l="clippingParents",rootBoundary:c="viewport",elementContext:h="floating",altBoundary:d=!1,padding:p=0}=e,u=m(p),y=r[d?"floating"===h?"reference":"floating":h],v=await o.getClippingClientRect({element:await o.isElement(y)?y:y.contextElement||await o.getDocumentElement({element:r.floating}),boundary:l,rootBoundary:c}),g=f(await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===h?{...s.floating,x:n,y:i}:s.reference,offsetParent:await o.getOffsetParent({element:r.floating}),strategy:a}));return{top:v.top-g.top+u.top,bottom:g.bottom-v.bottom+u.bottom,left:v.left-g.left+u.left,right:g.right-v.right+u.right}}const v=Math.min,g=Math.max;function b(t,e,n){return g(t,v(e,n))}const w={left:"right",right:"left",bottom:"top",top:"bottom"};function C(t){return t.replace(/left|right|bottom|top/g,(t=>w[t]))}function x(t,e){const n="start"===h(t),i=d(t),o=p(i);let s="x"===i?n?"right":"left":n?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=C(s)),{main:s,cross:C(s)}}const T={start:"end",end:"start"};function O(t){return t.replace(/start|end/g,(t=>T[t]))}["top","right","bottom","left"].reduce(((t,e)=>t.concat(e,e+"-start",e+"-end")),[]);const E=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:o,middlewareData:s,rects:r,initialPlacement:a}=e;if(null!=(n=s.flip)&&n.skip)return{};const{mainAxis:l=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",flipAlignment:u=!0,...m}=t,f=c(o),v=[a,...d||(f!==a&&u?function(t){const e=C(t);return[O(t),e,O(e)]}(a):[C(a)])],g=await y(e,m),b=[];let w=(null==(i=s.flip)?void 0:i.overflows)||[];if(l&&b.push(g[f]),h){const{main:t,cross:e}=x(o,r);b.push(g[t],g[e])}if(w=[...w,{placement:o,overflows:b}],!b.every((t=>t<=0))){var T,E;const t=(null!=(T=null==(E=s.flip)?void 0:E.index)?T:0)+1,e=v[t];if(e)return{data:{index:t,overflows:w},reset:{placement:e}};let n="bottom";switch(p){case"bestFit":{var A;const t=null==(A=w.slice().sort(((t,e)=>t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)-e.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)))[0])?void 0:A.placement;t&&(n=t);break}case"initialPlacement":n=a}return{data:{skip:!0},reset:{placement:n}}}return{}}}},A=function(t){return void 0===t&&(t=0),{name:"offset",options:t,fn(e){const{x:n,y:i,placement:o,rects:s}=e,r=function(t){let{placement:e,rects:n,value:i}=t;const o=c(e),s=["left","top"].includes(o)?-1:1,r="function"==typeof i?i({...n,placement:e}):i,{mainAxis:a,crossAxis:l}="number"==typeof r?{mainAxis:r,crossAxis:0}:{mainAxis:0,crossAxis:0,...r};return"x"===d(o)?{x:l,y:a*s}:{x:a*s,y:l}}({placement:o,rects:s,value:t});return{x:n+r.x,y:i+r.y,data:r}}}};const R=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:o}=e,{mainAxis:s=!0,crossAxis:r=!1,limiter:a={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...l}=t,h={x:n,y:i},p=await y(e,l),u=d(c(o)),m=function(t){return"x"===t?"y":"x"}(u);let f=h[u],v=h[m];if(s){const t="y"===u?"bottom":"right";f=b(f+p["y"===u?"top":"left"],f,f-p[t])}if(r){const t="y"===m?"bottom":"right";v=b(v+p["y"===m?"top":"left"],v,v-p[t])}const g=a.fn({...e,[u]:f,[m]:v});return{...g,data:{x:g.x-n,y:g.y-i}}}}},k=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){var n;const{placement:i,rects:o,middlewareData:s}=e,{apply:r,...a}=t;if(null!=(n=s.size)&&n.skip)return{};const l=await y(e,a),d=c(i),p="end"===h(i);let u,m;"top"===d||"bottom"===d?(u=d,m=p?"left":"right"):(m=d,u=p?"top":"bottom");const f=g(l.left,0),v=g(l.right,0),b=g(l.top,0),w=g(l.bottom,0),C={height:o.floating.height-(["left","right"].includes(i)?2*(0!==b||0!==w?b+w:g(l.top,l.bottom)):l[u]),width:o.floating.width-(["top","bottom"].includes(i)?2*(0!==f||0!==v?f+v:g(l.left,l.right)):l[m])};return null==r||r({...C,...o}),{data:{skip:!0},reset:{rects:!0}}}}};function P(t){return"[object Window]"===(null==t?void 0:t.toString())}function L(t){if(null==t)return window;if(!P(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function F(t){return L(t).getComputedStyle(t)}function M(t){return P(t)?"":t?(t.nodeName||"").toLowerCase():""}function W(t){return t instanceof L(t).HTMLElement}function D(t){return t instanceof L(t).Element}function H(t){return t instanceof L(t).ShadowRoot||t instanceof ShadowRoot}function N(t){const{overflow:e,overflowX:n,overflowY:i}=F(t);return/auto|scroll|overlay|hidden/.test(e+i+n)}function S(t){return["table","td","th"].includes(M(t))}function _(t){const e=navigator.userAgent.toLowerCase().includes("firefox"),n=F(t);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||e&&"filter"===n.willChange||e&&!!n.filter&&"none"!==n.filter}const j=Math.min,I=Math.max,z=Math.round;function $(t,e){void 0===e&&(e=!1);const n=t.getBoundingClientRect();let i=1,o=1;return e&&W(t)&&(i=t.offsetWidth>0&&z(n.width)/t.offsetWidth||1,o=t.offsetHeight>0&&z(n.height)/t.offsetHeight||1),{width:n.width/i,height:n.height/o,top:n.top/o,right:n.right/i,bottom:n.bottom/o,left:n.left/i,x:n.left/i,y:n.top/o}}function B(t){return(e=t,(e instanceof L(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function K(t){return P(t)?{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}:{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function q(t){return $(B(t)).left+K(t).scrollLeft}function U(t,e,n){const i=W(e),o=B(e),s=$(t,i&&function(t){const e=$(t);return z(e.width)!==t.offsetWidth||z(e.height)!==t.offsetHeight}(e));let r={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(i||!i&&"fixed"!==n)if(("body"!==M(e)||N(o))&&(r=K(e)),W(e)){const t=$(e,!0);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else o&&(a.x=q(o));return{x:s.left+r.scrollLeft-a.x,y:s.top+r.scrollTop-a.y,width:s.width,height:s.height}}function X(t){return"html"===M(t)?t:t.assignedSlot||t.parentNode||(H(t)?t.host:null)||B(t)}function Y(t){return W(t)&&"fixed"!==getComputedStyle(t).position?t.offsetParent:null}function V(t){const e=L(t);let n=Y(t);for(;n&&S(n)&&"static"===getComputedStyle(n).position;)n=Y(n);return n&&("html"===M(n)||"body"===M(n)&&"static"===getComputedStyle(n).position&&!_(n))?e:n||function(t){let e=X(t);for(;W(e)&&!["html","body"].includes(M(e));){if(_(e))return e;e=e.parentNode}return null}(t)||e}function G(t){return{width:t.offsetWidth,height:t.offsetHeight}}function J(t){return["html","body","#document"].includes(M(t))?t.ownerDocument.body:W(t)&&N(t)?t:J(X(t))}function Q(t,e){var n;void 0===e&&(e=[]);const i=J(t),o=i===(null==(n=t.ownerDocument)?void 0:n.body),s=L(i),r=o?[s].concat(s.visualViewport||[],N(i)?i:[]):i,a=e.concat(r);return o?a:a.concat(Q(X(r)))}function Z(t,e){return"viewport"===e?f(function(t){const e=L(t),n=B(t),i=e.visualViewport;let o=n.clientWidth,s=n.clientHeight,r=0,a=0;return i&&(o=i.width,s=i.height,Math.abs(e.innerWidth/i.scale-i.width)<.01&&(r=i.offsetLeft,a=i.offsetTop)),{width:o,height:s,x:r,y:a}}(t)):D(e)?function(t){const e=$(t),n=e.top+t.clientTop,i=e.left+t.clientLeft;return{top:n,left:i,x:i,y:n,right:i+t.clientWidth,bottom:n+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}(e):f(function(t){var e;const n=B(t),i=K(t),o=null==(e=t.ownerDocument)?void 0:e.body,s=I(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),r=I(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0);let a=-i.scrollLeft+q(t);const l=-i.scrollTop;return"rtl"===F(o||n).direction&&(a+=I(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:r,x:a,y:l}}(B(t)))}function tt(t){const e=Q(X(t)),n=["absolute","fixed"].includes(F(t).position)&&W(t)?V(t):t;return D(n)?e.filter((t=>D(t)&&function(t,e){const n=null==e.getRootNode?void 0:e.getRootNode();if(t.contains(e))return!0;if(n&&H(n)){let n=e;do{if(n&&t===n)return!0;n=n.parentNode||n.host}while(n)}return!1}(t,n)&&"body"!==M(t))):[]}const et={getElementRects:t=>{let{reference:e,floating:n,strategy:i}=t;return{reference:U(e,V(n),i),floating:{...G(n),x:0,y:0}}},convertOffsetParentRelativeRectToViewportRelativeRect:t=>function(t){let{rect:e,offsetParent:n,strategy:i}=t;const o=W(n),s=B(n);if(n===s)return e;let r={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((o||!o&&"fixed"!==i)&&(("body"!==M(n)||N(s))&&(r=K(n)),W(n))){const t=$(n,!0);a.x=t.x+n.clientLeft,a.y=t.y+n.clientTop}return{...e,x:e.x-r.scrollLeft+a.x,y:e.y-r.scrollTop+a.y}}(t),getOffsetParent:t=>{let{element:e}=t;return V(e)},isElement:t=>D(t),getDocumentElement:t=>{let{element:e}=t;return B(e)},getClippingClientRect:t=>function(t){let{element:e,boundary:n,rootBoundary:i}=t;const o=[..."clippingParents"===n?tt(e):[].concat(n),i],s=o[0],r=o.reduce(((t,n)=>{const i=Z(e,n);return t.top=I(i.top,t.top),t.right=j(i.right,t.right),t.bottom=j(i.bottom,t.bottom),t.left=I(i.left,t.left),t}),Z(e,s));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}(t),getDimensions:t=>{let{element:e}=t;return G(e)},getClientRects:t=>{let{element:e}=t;return e.getClientRects()}},nt=(t,e,n)=>(async(t,e,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:s=[],platform:r}=n;let a=await r.getElementRects({reference:t,floating:e,strategy:o}),{x:l,y:c}=u({...a,placement:i}),h=i,d={};for(let n=0;n<s.length;n++){const{name:p,fn:m}=s[n],{x:f,y:y,data:v,reset:g}=await m({x:l,y:c,initialPlacement:i,placement:h,strategy:o,middlewareData:d,rects:a,platform:r,elements:{reference:t,floating:e}});l=null!=f?f:l,c=null!=y?y:c,d={...d,[p]:null!=v?v:{}},g&&("object"==typeof g&&(g.placement&&(h=g.placement),g.rects&&(a=!0===g.rects?await r.getElementRects({reference:t,floating:e,strategy:o}):g.rects),({x:l,y:c}=u({...a,placement:h}))),n=-1)}return{x:l,y:c,placement:h,strategy:o,middlewareData:d}})(t,e,{platform:et,...n}),it={initial:"idle",states:{idle:{on:{active:"active"}},active:{on:{hiding:"hiding",idle:"idle"}},hiding:{on:{dispose:"dispose"}},dispose:{on:{disposed:"disposed"}},disposed:{on:{}}}},ot=(t,e)=>t?e&&it.states[t].on[e]||t:it.initial,st=t=>{const e=t.closest("active-overlay");if(e)return e;const n=t.getRootNode();return n.host?st(n.host):null};class rt extends t{constructor(){super(),this._state=ot(),this.animating=!1,this.theme={},this.tabbingAway=!1,this.offset=6,this.skidding=0,this.interaction="hover",this.positionAnimationFrame=0,this.willNotifyClosed=!1,this.isConstrained=!1,this.updateOverlayPosition=async()=>{if(!this.placement||"none"===this.placement)return;function t(t){const e=window.devicePixelRatio||1;return Math.round(t*e)/e||-1e4}await(document.fonts?document.fonts.ready:Promise.resolve());const e=[A({mainAxis:this.offset,crossAxis:this.skidding}),E({fallbackStrategy:"initialPlacement"}),R({padding:8}),k({padding:8,apply:({width:t,height:e,floating:n})=>{const i=Math.max(100,Math.floor(e)),o=n.height;this.initialHeight=this.isConstrained&&this.initialHeight||o,this.isConstrained=o<this.initialHeight||i<=o;const s=this.isConstrained?`${i}px`:"";Object.assign(this.style,{maxWidth:`${Math.floor(t)}px`,maxHeight:s,height:s})}})];this.overlayContentTip&&e.push((t=>({name:"arrow",options:t,async fn(e){const{element:n,padding:i=0}=null!=t?t:{},{x:o,y:s,placement:r,rects:a,platform:l}=e;if(null==n)return{};const h=m(i),u={x:o,y:s},f=d(c(r)),y=p(f),v=await l.getDimensions({element:n}),g="y"===f?"top":"left",w="y"===f?"bottom":"right",C=a.reference[y]+a.reference[f]-u[f]-a.floating[y],x=u[f]-a.reference[f],T=await l.getOffsetParent({element:n}),O=T?"y"===f?T.clientHeight||0:T.clientWidth||0:0,E=C/2-x/2,A=h[g],R=O-v[y]-h[w],k=O/2-v[y]/2+E,P=b(A,k,R);return{data:{[f]:P,centerOffset:k-P}}}}))({element:this.overlayContentTip}));const{x:n,y:i,placement:o,middlewareData:s}=await nt(this.virtualTrigger||this.trigger,this,{placement:this.placement,middleware:e});if(Object.assign(this.style,{top:"0px",left:"0px",transform:`translate(${t(n)}px, ${t(i)}px)`}),o!==this.getAttribute("actual-placement")&&(this.setAttribute("actual-placement",o),this.overlayContent.setAttribute("placement",o)),this.overlayContentTip&&s.arrow){const{x:e,y:n}=s.arrow;Object.assign(this.overlayContentTip.style,{left:null!=e?`${t(e)}px`:"",top:null!=n?`${t(n)}px`:"",right:"",bottom:""})}},this.handleInlineTriggerKeydown=t=>{const{code:e,shiftKey:n}=t;if("Tab"===e){if(n)return this.tabbingAway=!0,void this.dispatchEvent(new Event("close"));t.stopPropagation(),t.preventDefault(),this.focus()}},this.stealOverlayContentPromise=Promise.resolve(),this.stealOverlayContentPromise=new Promise((t=>this.stealOverlayContentResolver=t))}get state(){return this._state}set state(t){const e=ot(this.state,t);e!==this.state&&(this._state=e,"active"===this.state||"hiding"===this.state?this.setAttribute("state",this.state):this.removeAttribute("state"))}async focus(){const t=o(this);if(t){t.updateComplete&&await t.updateComplete;const e=this.getRootNode().activeElement;e!==this&&this.contains(e)||t.focus()}else super.focus();this.removeAttribute("tabindex")}get hasTheme(){return!!this.theme.color||!!this.theme.scale||!!this.theme.lang}static get styles(){return[l]}get hasModalRoot(){return!!this._modalRoot}feature(){this.tabIndex=-1;const t=st(this.trigger);t&&"open"===t.slot&&(this._modalRoot=t._modalRoot||t),("modal"===this.interaction||this._modalRoot)&&(this.slot="open","modal"===this.interaction&&this.setAttribute("aria-modal","true"),this._modalRoot&&(null==t||t.feature()))}obscure(t){if(this.slot&&"modal"===t){if(this.removeAttribute("slot"),this.removeAttribute("aria-modal"),"modal"!==this.interaction){const e=st(this.trigger);return this._modalRoot=null==e?void 0:e.obscure(t),this._modalRoot}return this}}async firstUpdated(t){if(super.firstUpdated(t),!this.overlayContent||!this.trigger)return;this.stealOverlayContent(this.overlayContent),this.state="active",this.feature(),"none"===this.placement?this.style.setProperty("--swc-visual-viewport-height",`${window.innerHeight}px`):this.placement&&(await this.updateOverlayPosition(),document.addEventListener("sp-update-overlays",this.updateOverlayPosition),window.addEventListener("scroll",this.updateOverlayPosition));const e=[];this.placement&&"none"!==this.placement&&e.push(this.applyContentAnimation("sp-overlay-fade-in")),void 0!==this.overlayContent.updateComplete&&e.push(this.overlayContent.updateComplete),this.childrenReady=Promise.all(e)}async openCallback(){await this.updateComplete,this.receivesFocus&&await this.focus(),this.trigger.dispatchEvent(new CustomEvent("sp-opened",{bubbles:!0,composed:!0,cancelable:!0,detail:{interaction:this.interaction}}))}open(t){this.extractDetail(t)}extractDetail(t){this.overlayContent=t.content,this.overlayContentTip=t.contentTip,this.trigger=t.trigger,this.virtualTrigger=t.virtualTrigger,this.placement=t.placement,this.offset=t.offset,this.skidding=t.skidding||0,this.interaction=t.interaction,this.theme=t.theme,this.receivesFocus=t.receivesFocus}dispose(){"dispose"===this.state&&(this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.trigger.removeEventListener("keydown",this.handleInlineTriggerKeydown),this.returnOverlayContent(),this.state="disposed",this.willNotifyClosed&&(this.overlayContent.dispatchEvent(new Event("sp-overlay-closed")),this.willNotifyClosed=!1))}stealOverlayContent(t){this.originalPlacement=t.getAttribute("placement"),this.restoreContent=s([t],this,(t=>{const e=t.slot,n=t.placement;return t.removeAttribute("slot"),t=>{t.slot=e,t.placement=n}})),this.stealOverlayContentResolver()}returnOverlayContent(){if(!this.restoreContent)return;const[t]=this.restoreContent();this.restoreContent=void 0,this.willNotifyClosed=!0,this.originalPlacement&&(t.setAttribute("placement",this.originalPlacement),delete this.originalPlacement)}async hide(t=!0){this.state="hiding",t&&await this.applyContentAnimation("sp-overlay-fade-out"),this.state="dispose"}schedulePositionUpdate(){cancelAnimationFrame(this.positionAnimationFrame),this.positionAnimationFrame=requestAnimationFrame((()=>this.updateOverlayPosition()))}onSlotChange(){this.schedulePositionUpdate()}applyContentAnimation(t){return"none"===this.placement?Promise.resolve(!0):new Promise((e=>{const n=this.shadowRoot.querySelector("#contents"),i=o=>{t===o.animationName&&(n.removeEventListener("animationend",i),n.removeEventListener("animationcancel",i),this.animating=!1,e("animationcancel"===o.type))};n.addEventListener("animationend",i),n.addEventListener("animationcancel",i),n.style.animationName=t,this.animating=!0}))}renderTheme(t){const{color:n,scale:i,lang:o}=this.theme;return e`<sp-theme color="${a(n)}" scale="${a(i)}" lang="${a(o)}" part="theme">${t}</sp-theme>`}render(){const t=e`<div id="contents"><slot @slotchange="${this.onSlotChange}"></slot></div>`;return this.hasTheme?this.renderTheme(t):t}static create(t){const e=new rt;return t.content&&e.open(t),e}async getUpdateComplete(){const t=[super.getUpdateComplete(),this.stealOverlayContentPromise];this.childrenReady&&t.push(this.childrenReady);const[e]=await Promise.all(t);return e}disconnectedCallback(){document.removeEventListener("sp-update-overlays",this.updateOverlayPosition),window.removeEventListener("scroll",this.updateOverlayPosition),super.disconnectedCallback()}}n([i()],rt.prototype,"_state",void 0),n([i({reflect:!0,type:Boolean})],rt.prototype,"animating",void 0),n([i({reflect:!0})],rt.prototype,"placement",void 0),n([i({attribute:!1})],rt.prototype,"theme",void 0),n([i({attribute:!1})],rt.prototype,"receivesFocus",void 0);class at{constructor(t={}){this.warmUpDelay=1e3,this.coolDownDelay=1e3,this.isWarm=!1,this.timeout=0,Object.assign(this,t)}async openTimer(t){if(this.cancelCooldownTimer(),this.component&&t===this.component){if(this.promise)return this.promise;throw new Error("Inconsistent state")}return this.component&&(this.close(this.component),this.cancelCooldownTimer()),this.component=t,!this.isWarm&&(this.promise=new Promise((t=>{this.resolve=t,this.timeout=window.setTimeout((()=>{this.resolve&&(this.resolve(!1),this.isWarm=!0)}),this.warmUpDelay)})),this.promise)}close(t){this.component&&this.component===t&&(this.resetCooldownTimer(),this.timeout>0&&(clearTimeout(this.timeout),this.timeout=0),this.resolve&&(this.resolve(!0),delete this.resolve),delete this.promise,delete this.component)}resetCooldownTimer(){this.isWarm&&(this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),this.cooldownTimeout=window.setTimeout((()=>{this.isWarm=!1,delete this.cooldownTimeout}),this.coolDownDelay))}cancelCooldownTimer(){this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),delete this.cooldownTimeout}}customElements.define("active-overlay",rt);class lt{constructor(t,e,n){this.isOpen=!1,this.owner=t,this.overlayElement=n,this.interaction=e}static async open(t,e,n,i){const o=new lt(t,e,n);return await o.open(i),()=>{o.close()}}static update(){const t=new CustomEvent("sp-update-overlays",{bubbles:!0,composed:!0,cancelable:!0});document.dispatchEvent(t)}async open({abortPromise:t,delayed:e,offset:n=0,placement:i="top",receivesFocus:o,notImmediatelyClosable:s,virtualTrigger:r}){if(this.isOpen)return!0;void 0===e&&(e=this.overlayElement.hasAttribute("delayed"));const a={color:void 0,scale:void 0,lang:void 0},l=new CustomEvent("sp-query-theme",{bubbles:!0,composed:!0,detail:a,cancelable:!0});this.owner.dispatchEvent(l);const c={},h=new CustomEvent("sp-overlay-query",{bubbles:!0,composed:!0,detail:c,cancelable:!0});return this.overlayElement.dispatchEvent(h),await lt.overlayStack.openOverlay(Object.assign({abortPromise:t,content:this.overlayElement,contentTip:c.overlayContentTipElement,delayed:e,offset:n,placement:i,trigger:this.owner,interaction:this.interaction,theme:a,receivesFocus:o,notImmediatelyClosable:s,virtualTrigger:r},c)),this.isOpen=!0,!0}close(){lt.overlayStack.closeOverlay(this.overlayElement)}}lt.overlayStack=new class{constructor(){this.overlays=[],this.preventMouseRootClose=!1,this.root=document.body,this.handlingResize=!1,this.overlayTimer=new at,this.canTabTrap=!0,this.trappingInited=!1,this._eventsAreBound=!1,this._bodyMarginsApplied=!1,this.forwardContextmenuEvent=async t=>{const e=this.overlays[this.overlays.length-1];if(!this.trappingInited||"modal"!==e.interaction||t.target!==this.overlayHolder)return;t.stopPropagation(),t.preventDefault(),await this.closeTopOverlay();let n=document.elementFromPoint(t.clientX,t.clientY);for(;null==n?void 0:n.shadowRoot;){const e=n.shadowRoot.elementFromPoint(t.clientX,t.clientY);if(!e||e===n)break;n=e}null==n||n.dispatchEvent(new MouseEvent("contextmenu",t))},this.handleMouseCapture=t=>{const e=this.topOverlay;if(t.target&&e&&e.overlayContent&&!function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t)&&function(t){return 0===t.button}(t)){if(t.target instanceof Node){if(t.composedPath().indexOf(e.overlayContent)>=0)return void(this.preventMouseRootClose=!0);this.preventMouseRootClose=!1}}else this.preventMouseRootClose=!0},this._doesNotCloseOnFirstClick=!1,this.handleMouse=t=>{this._doesNotCloseOnFirstClick?this._doesNotCloseOnFirstClick=!1:this.preventMouseRootClose||t.defaultPrevented||this.closeTopOverlay(!0)},this.handleKeyUp=t=>{"Escape"===t.code&&this.closeTopOverlay()},this.handleResize=()=>{this.handlingResize||(this.handlingResize=!0,requestAnimationFrame((async()=>{const t=this.overlays.map((t=>t.updateOverlayPosition()));await Promise.all(t),this.handlingResize=!1})))}}initTabTrapping(){if(this.trappingInited)return;if(this.trappingInited=!0,this.document.body.shadowRoot)return void(this.canTabTrap=!1);if(this.document.body.attachShadow({mode:"open"}),!this.document.body.shadowRoot)return;const t=this.document.body.shadowRoot;t.innerHTML='\n            <style>\n            :host {\n                position: relative;\n            }\n            #actual {\n                position: relative;\n                height: calc(100% - var(--swc-body-margins-block, 0px));\n                z-index: 0;\n                min-height: calc(100vh - var(--swc-body-margins-block, 0px));\n            }\n            #holder {\n                display: none;\n                align-items: center;\n                justify-content: center;\n                flex-flow: column;\n                width: 100%;\n                height: 100%;\n                position: absolute;\n                top: 0;\n                left: 0;\n            }\n            [name="open"]::slotted(*) {\n                pointer-events: all;\n            }\n            #actual[aria-hidden] + #holder {\n                display: flex;\n            }\n            </style>\n            <div id="actual"><slot></slot></div>\n            <div id="holder"><slot name="open"></slot></div>\n        ',this.tabTrapper=t.querySelector("#actual"),this.overlayHolder=t.querySelector("#holder"),this.tabTrapper.attachShadow({mode:"open"}),this.tabTrapper.shadowRoot&&(this.tabTrapper.shadowRoot.innerHTML="<slot></slot>"),this.overlayHolder.addEventListener("contextmenu",this.forwardContextmenuEvent,!0),requestAnimationFrame((()=>{this.applyBodyMargins();new ResizeObserver((()=>{this.applyBodyMargins()})).observe(document.body)}))}applyBodyMargins(){const{marginLeft:t,marginRight:e,marginTop:n,marginBottom:i}=getComputedStyle(document.body),o=0===parseFloat(t)&&0===parseFloat(e)&&0===parseFloat(n)&&0===parseFloat(i);o&&!this._bodyMarginsApplied||(this.tabTrapper.style.setProperty("--swc-body-margins-inline",`calc(${t} + ${e})`),this.tabTrapper.style.setProperty("--swc-body-margins-block",`calc(${n} + ${i})`),this._bodyMarginsApplied=!o)}startTabTrapping(){this.initTabTrapping(),this.canTabTrap&&(this.tabTrapper.tabIndex=-1,this.tabTrapper.setAttribute("aria-hidden","true"))}stopTabTrapping(){this.canTabTrap&&this.trappingInited&&(this.tabTrapper.removeAttribute("tabindex"),this.tabTrapper.removeAttribute("aria-hidden"))}get document(){return this.root.ownerDocument||document}get topOverlay(){return this.overlays.slice(-1)[0]}findOverlayForContent(t){for(const e of this.overlays)if(t===e.overlayContent)return e}addEventListeners(){this._eventsAreBound||(this._eventsAreBound=!0,this.document.addEventListener("click",this.handleMouseCapture,!0),this.document.addEventListener("click",this.handleMouse),this.document.addEventListener("keyup",this.handleKeyUp),window.addEventListener("resize",this.handleResize))}isClickOverlayActiveForTrigger(t){return this.overlays.some((e=>t===e.trigger&&"click"===e.interaction))}async openOverlay(t){if(this.addEventListeners(),this.findOverlayForContent(t.content))return!1;t.notImmediatelyClosable&&(this._doesNotCloseOnFirstClick=!0),"modal"===t.interaction&&this.startTabTrapping();const e=t.content;if(e.overlayWillOpenCallback){const{trigger:n}=t;e.overlayWillOpenCallback({trigger:n})}if(t.delayed){const n=[this.overlayTimer.openTimer(t.content)];t.abortPromise&&n.push(t.abortPromise);const i=await Promise.race(n);if(i){if(e.overlayOpenCancelledCallback){const{trigger:n}=t;e.overlayOpenCancelledCallback({trigger:n})}return i}}if("click"===t.interaction)this.closeAllHoverOverlays();else if("hover"===t.interaction&&this.isClickOverlayActiveForTrigger(t.trigger))return!0;const n=rt.create(t);if(this.overlays.length){this.overlays[this.overlays.length-1].obscure(n.interaction)}return document.body.appendChild(n),new Promise((t=>requestAnimationFrame(t))).then((async()=>{if(this.overlays.push(n),await n.updateComplete,this.addOverlayEventListeners(n),void 0!==e.open&&(e.open=!0),e.overlayOpenCallback){const{trigger:t}=n;e.overlayOpenCallback({trigger:t})}return n.openCallback(),!1}))}addOverlayEventListeners(t){switch(t.addEventListener("close",(e=>{var n;this.hideAndCloseOverlay(t,!0,!!(null===(n=e.detail)||void 0===n?void 0:n.reason))})),t.interaction){case"replace":this.addReplaceOverlayEventListeners(t);break;case"inline":this.addInlineOverlayEventListeners(t)}}addReplaceOverlayEventListeners(t){t.addEventListener("keydown",(e=>{const{code:n}=e;"Tab"===n&&(e.stopPropagation(),this.closeOverlay(t.overlayContent),t.tabbingAway=!0,t.trigger.focus(),t.trigger.dispatchEvent(new KeyboardEvent("keydown",e)))}))}addInlineOverlayEventListeners(t){t.trigger.addEventListener("keydown",t.handleInlineTriggerKeydown),t.addEventListener("keydown",(e=>{const{code:n,shiftKey:i}=e;if("Tab"!==n)return;if(t.tabbingAway=!0,i){const e=document.createElement("span");return e.tabIndex=-1,t.trigger.hasAttribute("slot")&&(e.slot=t.trigger.slot),t.trigger.insertAdjacentElement("afterend",e),e.focus(),void e.remove()}e.stopPropagation();const o=t.trigger;void 0!==o.open&&(o.open=!1),this.closeOverlay(t.overlayContent),t.trigger.focus()}))}closeOverlay(t){this.overlayTimer.close(t),requestAnimationFrame((()=>{const e=this.findOverlayForContent(t);this.hideAndCloseOverlay(e)}))}closeAllHoverOverlays(){for(const t of this.overlays)"hover"===t.interaction&&this.hideAndCloseOverlay(t,!1)}async manageFocusAfterCloseWhenOverlaysRemain(){const t=this.overlays[this.overlays.length-1];t.feature(),"modal"===t.interaction||t.hasModalRoot?await t.focus():this.stopTabTrapping()}manageFocusAfterCloseWhenLastOverlay(t){this.stopTabTrapping();const e="modal"===t.interaction,n="auto"===t.receivesFocus,i="replace"===t.interaction,o="inline"===t.interaction,s=(i||o)&&!t.tabbingAway;if(t.tabbingAway=!1,!e&&!n&&!s)return;const r=t.overlayContent.getRootNode().activeElement;let a,l;(e||t.overlayContent.contains(r)||(a=t.trigger.getRootNode(),l=a.activeElement,a.contains(l))||a.host&&a.host===l)&&t.trigger.focus()}async hideAndCloseOverlay(t,e,n){if(!t)return;const i=t.overlayContent;if(void 0!==i.overlayWillCloseCallback){const{trigger:e}=t;if(i.overlayWillCloseCallback({trigger:e}))return}if(await t.hide(e),void 0!==i.open&&(i.open=!1),i.overlayCloseCallback){const{trigger:e}=t;i.overlayCloseCallback({trigger:e})}if("dispose"!=t.state)return;const o=this.overlays.indexOf(t);o>=0&&this.overlays.splice(o,1),this.overlays.length?await this.manageFocusAfterCloseWhenOverlaysRemain():this.manageFocusAfterCloseWhenLastOverlay(t),t.remove(),t.dispose(),t.trigger.dispatchEvent(new CustomEvent("sp-closed",{bubbles:!0,composed:!0,cancelable:!0,detail:{interaction:t.interaction,reason:n?"external-click":void 0}}))}closeTopOverlay(t){return this.hideAndCloseOverlay(this.topOverlay,!0,t)}};export{lt as Overlay};
//# sourceMappingURL=3da6c2a7.js.map

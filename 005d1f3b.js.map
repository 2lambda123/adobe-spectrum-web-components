{"version":3,"file":"005d1f3b.js","sources":["../../../packages/overlay/src/active-overlay.css.js","../../../node_modules/@floating-ui/core/dist/floating-ui.core.esm.min.js","../../../node_modules/@floating-ui/dom/dist/floating-ui.dom.esm.min.js","../../../packages/overlay/src/ActiveOverlay.js","../../../packages/overlay/src/overlay-timer.js","../../../packages/overlay/active-overlay.js","../../../packages/overlay/src/overlay.js","../../../packages/overlay/src/overlay-stack.js"],"sourcesContent":["/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\nimport { css } from '@spectrum-web-components/base';\nconst styles = css `\n@keyframes sp-overlay-fade-in{0%{opacity:0;transform:var(--sp-overlay-from)}to{opacity:1;transform:translate(0)}}@keyframes sp-overlay-fade-out{0%{opacity:1;transform:translate(0)}to{opacity:0;transform:var(--sp-overlay-from)}}:host{display:inline-block;left:0;pointer-events:none;position:absolute;top:0;z-index:1000}:host(:focus){outline:none}:host([placement=none]){max-height:var(--swc-visual-viewport-height)}#contents,sp-theme{height:100%}#contents{animation-duration:var(\n--swc-test-duration,var(--spectrum-global-animation-duration-200,.16s)\n);animation-timing-function:var(\n--spectrum-global-animation-ease-out,ease-out\n);display:inline-block;opacity:1;pointer-events:none;visibility:visible}:host([actual-placement*=top]) #contents{--sp-overlay-from:translateY(var(--spectrum-global-dimension-size-75));align-items:flex-end;display:inline-flex}:host([actual-placement*=right]) #contents{--sp-overlay-from:translateX(calc(var(--spectrum-global-dimension-size-75)*-1))}:host([actual-placement*=bottom]) #contents{--sp-overlay-from:translateY(calc(var(--spectrum-global-dimension-size-75)*-1))}:host([actual-placement*=left]) #contents{--sp-overlay-from:translateX(var(--spectrum-global-dimension-size-75))}:host([animating]) ::slotted(*){pointer-events:none}:host(:not([animating])) ::slotted(*){pointer-events:auto}#contents ::slotted(*){position:relative}\n`;\nexport default styles;\n//# sourceMappingURL=active-overlay.css.js.map","function t(t){return t.split(\"-\")[0]}function e(t){return t.split(\"-\")[1]}function n(e){return[\"top\",\"bottom\"].includes(t(e))?\"x\":\"y\"}function r(t){return\"y\"===t?\"height\":\"width\"}function o(o){let{reference:i,floating:a,placement:l}=o;const s=i.x+i.width/2-a.width/2,c=i.y+i.height/2-a.height/2;let f;switch(t(l)){case\"top\":f={x:s,y:i.y-a.height};break;case\"bottom\":f={x:s,y:i.y+i.height};break;case\"right\":f={x:i.x+i.width,y:c};break;case\"left\":f={x:i.x-a.width,y:c};break;default:f={x:i.x,y:i.y}}const m=n(l),u=r(m);switch(e(l)){case\"start\":f[m]=f[m]-(i[u]/2-a[u]/2);break;case\"end\":f[m]=f[m]+(i[u]/2-a[u]/2)}return f}const i=async(t,e,n)=>{const{placement:r=\"bottom\",strategy:i=\"absolute\",middleware:a=[],platform:l}=n;let s=await l.getElementRects({reference:t,floating:e,strategy:i}),{x:c,y:f}=o({...s,placement:r}),m=r,u={};for(let n=0;n<a.length;n++){const{name:p,fn:g}=a[n],{x:d,y:h,data:y,reset:x}=await g({x:c,y:f,initialPlacement:r,placement:m,strategy:i,middlewareData:u,rects:s,platform:l,elements:{reference:t,floating:e}});c=null!=d?d:c,f=null!=h?h:f,u={...u,[p]:null!=y?y:{}},x&&(\"object\"==typeof x&&(x.placement&&(m=x.placement),x.rects&&(s=!0===x.rects?await l.getElementRects({reference:t,floating:e,strategy:i}):x.rects),({x:c,y:f}=o({...s,placement:m}))),n=-1)}return{x:c,y:f,placement:m,strategy:i,middlewareData:u}};function a(t){return\"number\"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function l(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function s(t,e){void 0===e&&(e={});const{x:n,y:r,platform:o,rects:i,elements:s,strategy:c}=t,{boundary:f=\"clippingParents\",rootBoundary:m=\"viewport\",elementContext:u=\"floating\",altBoundary:p=!1,padding:g=0}=e,d=a(g),h=s[p?\"floating\"===u?\"reference\":\"floating\":u],y=await o.getClippingClientRect({element:await o.isElement(h)?h:h.contextElement||await o.getDocumentElement({element:s.floating}),boundary:f,rootBoundary:m}),x=l(await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:\"floating\"===u?{...i.floating,x:n,y:r}:i.reference,offsetParent:await o.getOffsetParent({element:s.floating}),strategy:c}));return{top:y.top-x.top+d.top,bottom:x.bottom-y.bottom+d.bottom,left:y.left-x.left+d.left,right:x.right-y.right+d.right}}const c=Math.min,f=Math.max;function m(t,e,n){return f(t,c(e,n))}const u=e=>({name:\"arrow\",options:e,async fn(o){const{element:i,padding:l=0}=null!=e?e:{},{x:s,y:c,placement:f,rects:u,platform:p}=o;if(null==i)return{};const g=a(l),d={x:s,y:c},h=n(t(f)),y=r(h),x=await p.getDimensions({element:i}),w=\"y\"===h?\"top\":\"left\",b=\"y\"===h?\"bottom\":\"right\",v=u.reference[y]+u.reference[h]-d[h]-u.floating[y],A=d[h]-u.reference[h],P=await p.getOffsetParent({element:i}),k=P?\"y\"===h?P.clientHeight||0:P.clientWidth||0:0,R=v/2-A/2,D=g[w],O=k-x[y]-g[b],C=k/2-x[y]/2+R,E=m(D,C,O);return{data:{[h]:E,centerOffset:C-E}}}}),p={left:\"right\",right:\"left\",bottom:\"top\",top:\"bottom\"};function g(t){return t.replace(/left|right|bottom|top/g,(t=>p[t]))}function d(t,o){const i=\"start\"===e(t),a=n(t),l=r(a);let s=\"x\"===a?i?\"right\":\"left\":i?\"bottom\":\"top\";return o.reference[l]>o.floating[l]&&(s=g(s)),{main:s,cross:g(s)}}const h={start:\"end\",end:\"start\"};function y(t){return t.replace(/start|end/g,(t=>h[t]))}const x=[\"top\",\"right\",\"bottom\",\"left\"],w=x.reduce(((t,e)=>t.concat(e,e+\"-start\",e+\"-end\")),[]);const b=function(n){return void 0===n&&(n={}),{name:\"autoPlacement\",options:n,async fn(r){var o,i,a,l,c,f;const{x:m,y:u,rects:p,middlewareData:g,placement:h}=r,{alignment:x=null,allowedPlacements:b=w,autoAlignment:v=!0,...A}=n;if(null!=(o=g.autoPlacement)&&o.skip)return{};const P=function(n,r,o){return(n?[...o.filter((t=>e(t)===n)),...o.filter((t=>e(t)!==n))]:o.filter((e=>t(e)===e))).filter((t=>!n||e(t)===n||!!r&&y(t)!==t))}(x,v,b),k=await s(r,A),R=null!=(i=null==(a=g.autoPlacement)?void 0:a.index)?i:0,D=P[R],{main:O,cross:C}=d(D,p);if(h!==D)return{x:m,y:u,reset:{placement:P[0]}};const E=[k[t(D)],k[O],k[C]],B=[...null!=(l=null==(c=g.autoPlacement)?void 0:c.overflows)?l:[],{placement:D,overflows:E}],H=P[R+1];if(H)return{data:{index:R+1,overflows:B},reset:{placement:H}};const z=B.slice().sort(((t,e)=>t.overflows[0]-e.overflows[0])),F=null==(f=z.find((t=>{let{overflows:e}=t;return e.every((t=>t<=0))})))?void 0:f.placement;return{data:{skip:!0},reset:{placement:null!=F?F:z[0].placement}}}}};const v=function(e){return void 0===e&&(e={}),{name:\"flip\",options:e,async fn(n){var r,o;const{placement:i,middlewareData:a,rects:l,initialPlacement:c}=n;if(null!=(r=a.flip)&&r.skip)return{};const{mainAxis:f=!0,crossAxis:m=!0,fallbackPlacements:u,fallbackStrategy:p=\"bestFit\",flipAlignment:h=!0,...x}=e,w=t(i),b=u||(w===c||!h?[g(c)]:function(t){const e=g(t);return[y(t),e,y(e)]}(c)),v=[c,...b],A=await s(n,x),P=[];let k=(null==(o=a.flip)?void 0:o.overflows)||[];if(f&&P.push(A[w]),m){const{main:t,cross:e}=d(i,l);P.push(A[t],A[e])}if(k=[...k,{placement:i,overflows:P}],!P.every((t=>t<=0))){var R,D;const t=(null!=(R=null==(D=a.flip)?void 0:D.index)?R:0)+1,e=v[t];if(e)return{data:{index:t,overflows:k},reset:{placement:e}};let n=\"bottom\";switch(p){case\"bestFit\":{var O;const t=null==(O=k.slice().sort(((t,e)=>t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)-e.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)))[0])?void 0:O.placement;t&&(n=t);break}case\"initialPlacement\":n=c}return{data:{skip:!0},reset:{placement:n}}}return{}}}};function A(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function P(t){return x.some((e=>t[e]>=0))}const k=()=>({name:\"hide\",async fn(t){const e=await s(t,{elementContext:\"reference\"}),n=await s(t,{altBoundary:!0}),r=A(e,t.rects.reference),o=A(n,t.rects.floating);return{data:{referenceHidden:P(r),referenceHiddenOffsets:r,escaped:P(o),escapedOffsets:o}}}});const R=function(e){return void 0===e&&(e=0),{name:\"offset\",options:e,fn(r){const{x:o,y:i,placement:a,rects:l}=r,s=function(e){let{placement:r,rects:o,value:i}=e;const a=t(r),l=[\"left\",\"top\"].includes(a)?-1:1,s=\"function\"==typeof i?i({...o,placement:r}):i,{mainAxis:c,crossAxis:f}=\"number\"==typeof s?{mainAxis:s,crossAxis:0}:{mainAxis:0,crossAxis:0,...s};return\"x\"===n(a)?{x:f,y:c*l}:{x:c*l,y:f}}({placement:a,rects:l,value:e});return{x:o+s.x,y:i+s.y,data:s}}}};function D(t){return\"x\"===t?\"y\":\"x\"}const O=function(e){return void 0===e&&(e={}),{name:\"shift\",options:e,async fn(r){const{x:o,y:i,placement:a}=r,{mainAxis:l=!0,crossAxis:c=!1,limiter:f={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...u}=e,p={x:o,y:i},g=await s(r,u),d=n(t(a)),h=D(d);let y=p[d],x=p[h];if(l){const t=\"y\"===d?\"bottom\":\"right\";y=m(y+g[\"y\"===d?\"top\":\"left\"],y,y-g[t])}if(c){const t=\"y\"===h?\"bottom\":\"right\";x=m(x+g[\"y\"===h?\"top\":\"left\"],x,x-g[t])}const w=f.fn({...r,[d]:y,[h]:x});return{...w,data:{x:w.x-o,y:w.y-i}}}}},C=function(e){return void 0===e&&(e={}),{options:e,fn(r){const{x:o,y:i,placement:a,rects:l,middlewareData:s}=r,{offset:c=0,mainAxis:f=!0,crossAxis:m=!0}=e,u={x:o,y:i},p=n(a),g=D(p);let d=u[p],h=u[g];const y=\"function\"==typeof c?c({...l,placement:a}):c,x=\"number\"==typeof y?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(f){const t=\"y\"===p?\"height\":\"width\",e=l.reference[p]-l.floating[t]+x.mainAxis,n=l.reference[p]+l.reference[t]-x.mainAxis;d<e?d=e:d>n&&(d=n)}if(m){var w,b,v,A;const e=\"y\"===p?\"width\":\"height\",n=[\"top\",\"left\"].includes(t(a)),r=l.reference[g]-l.floating[e]+(n&&null!=(w=null==(b=s.offset)?void 0:b[g])?w:0)+(n?0:x.crossAxis),o=l.reference[g]+l.reference[e]+(n?0:null!=(v=null==(A=s.offset)?void 0:A[g])?v:0)-(n?x.crossAxis:0);h<r?h=r:h>o&&(h=o)}return{[p]:d,[g]:h}}}},E=function(n){return void 0===n&&(n={}),{name:\"size\",options:n,async fn(r){var o;const{placement:i,rects:a,middlewareData:l}=r,{apply:c,...m}=n;if(null!=(o=l.size)&&o.skip)return{};const u=await s(r,m),p=t(i),g=\"end\"===e(i);let d,h;\"top\"===p||\"bottom\"===p?(d=p,h=g?\"left\":\"right\"):(h=p,d=g?\"top\":\"bottom\");const y=f(u.left,0),x=f(u.right,0),w=f(u.top,0),b=f(u.bottom,0),v={height:a.floating.height-([\"left\",\"right\"].includes(i)?2*(0!==w||0!==b?w+b:f(u.top,u.bottom)):u[d]),width:a.floating.width-([\"top\",\"bottom\"].includes(i)?2*(0!==y||0!==x?y+x:f(u.left,u.right)):u[h])};return null==c||c({...v,...a}),{data:{skip:!0},reset:{rects:!0}}}}},B=function(e){return void 0===e&&(e={}),{name:\"inline\",options:e,async fn(r){var o,i;const{placement:s,elements:m,rects:u,platform:p,strategy:g,middlewareData:d}=r,{padding:h=2,x:y,y:x}=e;if(null!=(o=d.inline)&&o.skip)return{};const w=l(await p.convertOffsetParentRelativeRectToViewportRelativeRect({rect:u.reference,offsetParent:await p.getOffsetParent({element:m.floating}),strategy:g})),b=Array.from(null!=(i=await(null==p.getClientRects?void 0:p.getClientRects({element:m.reference})))?i:[]),v=a(h);return{data:{skip:!0},reset:{rects:await p.getElementRects({reference:{getBoundingClientRect:function(){var e;if(2===b.length&&b[0].left>b[1].right&&null!=y&&null!=x)return null!=(e=b.find((t=>y>t.left-v.left&&y<t.right+v.right&&x>t.top-v.top&&x<t.bottom+v.bottom)))?e:w;if(b.length>=2){if(\"x\"===n(s)){const e=b[0],n=b[b.length-1],r=\"top\"===t(s),o=e.top,i=n.bottom,a=r?e.left:n.left,l=r?e.right:n.right;return{top:o,bottom:i,left:a,right:l,width:l-a,height:i-o,x:a,y:o}}const e=\"left\"===t(s),r=f(...b.map((t=>t.right))),o=c(...b.map((t=>t.left))),i=b.filter((t=>e?t.left===o:t.right===r)),a=i[0].top,l=i[i.length-1].bottom;return{top:a,bottom:l,left:o,right:r,width:r-o,height:l-a,x:o,y:a}}return w}},floating:m.floating,strategy:g})}}}}};export{u as arrow,b as autoPlacement,i as computePosition,s as detectOverflow,v as flip,k as hide,B as inline,C as limitShift,R as offset,l as rectToClientRect,O as shift,E as size};\n","import{rectToClientRect as t,computePosition as e}from\"@floating-ui/core\";export{arrow,autoPlacement,detectOverflow,flip,hide,inline,limitShift,offset,shift,size}from\"@floating-ui/core\";function n(t){return\"[object Window]\"===(null==t?void 0:t.toString())}function o(t){if(null==t)return window;if(!n(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function i(t){return o(t).getComputedStyle(t)}function r(t){return n(t)?\"\":t?(t.nodeName||\"\").toLowerCase():\"\"}function l(t){return t instanceof o(t).HTMLElement}function c(t){return t instanceof o(t).Element}function f(t){return t instanceof o(t).ShadowRoot||t instanceof ShadowRoot}function u(t){const{overflow:e,overflowX:n,overflowY:o}=i(t);return/auto|scroll|overlay|hidden/.test(e+o+n)}function s(t){return[\"table\",\"td\",\"th\"].includes(r(t))}function h(t){const e=navigator.userAgent.toLowerCase().includes(\"firefox\"),n=i(t);return\"none\"!==n.transform||\"none\"!==n.perspective||\"paint\"===n.contain||[\"transform\",\"perspective\"].includes(n.willChange)||e&&\"filter\"===n.willChange||e&&!!n.filter&&\"none\"!==n.filter}const d=Math.min,a=Math.max,g=Math.round;function p(t,e){void 0===e&&(e=!1);const n=t.getBoundingClientRect();let o=1,i=1;return e&&l(t)&&(o=t.offsetWidth>0&&g(n.width)/t.offsetWidth||1,i=t.offsetHeight>0&&g(n.height)/t.offsetHeight||1),{width:n.width/o,height:n.height/i,top:n.top/i,right:n.right/o,bottom:n.bottom/i,left:n.left/o,x:n.left/o,y:n.top/i}}function m(t){return(e=t,(e instanceof o(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function w(t){return n(t)?{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}:{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function y(t){return p(m(t)).left+w(t).scrollLeft}function x(t,e,n){const o=l(e),i=m(e),c=p(t,o&&function(t){const e=p(t);return g(e.width)!==t.offsetWidth||g(e.height)!==t.offsetHeight}(e));let f={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if(o||!o&&\"fixed\"!==n)if((\"body\"!==r(e)||u(i))&&(f=w(e)),l(e)){const t=p(e,!0);s.x=t.x+e.clientLeft,s.y=t.y+e.clientTop}else i&&(s.x=y(i));return{x:c.left+f.scrollLeft-s.x,y:c.top+f.scrollTop-s.y,width:c.width,height:c.height}}function v(t){return\"html\"===r(t)?t:t.assignedSlot||t.parentNode||(f(t)?t.host:null)||m(t)}function b(t){return l(t)&&\"fixed\"!==getComputedStyle(t).position?t.offsetParent:null}function L(t){const e=o(t);let n=b(t);for(;n&&s(n)&&\"static\"===getComputedStyle(n).position;)n=b(n);return n&&(\"html\"===r(n)||\"body\"===r(n)&&\"static\"===getComputedStyle(n).position&&!h(n))?e:n||function(t){let e=v(t);for(;l(e)&&![\"html\",\"body\"].includes(r(e));){if(h(e))return e;e=e.parentNode}return null}(t)||e}function W(t){return{width:t.offsetWidth,height:t.offsetHeight}}function T(t){return[\"html\",\"body\",\"#document\"].includes(r(t))?t.ownerDocument.body:l(t)&&u(t)?t:T(v(t))}function C(t,e){var n;void 0===e&&(e=[]);const i=T(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),l=o(i),c=r?[l].concat(l.visualViewport||[],u(i)?i:[]):i,f=e.concat(c);return r?f:f.concat(C(v(c)))}function R(e,n){return\"viewport\"===n?t(function(t){const e=o(t),n=m(t),i=e.visualViewport;let r=n.clientWidth,l=n.clientHeight,c=0,f=0;return i&&(r=i.width,l=i.height,Math.abs(e.innerWidth/i.scale-i.width)<.01&&(c=i.offsetLeft,f=i.offsetTop)),{width:r,height:l,x:c,y:f}}(e)):c(n)?function(t){const e=p(t),n=e.top+t.clientTop,o=e.left+t.clientLeft;return{top:n,left:o,x:o,y:n,right:o+t.clientWidth,bottom:n+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}(n):t(function(t){var e;const n=m(t),o=w(t),r=null==(e=t.ownerDocument)?void 0:e.body,l=a(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),c=a(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0);let f=-o.scrollLeft+y(t);const u=-o.scrollTop;return\"rtl\"===i(r||n).direction&&(f+=a(n.clientWidth,r?r.clientWidth:0)-l),{width:l,height:c,x:f,y:u}}(m(e)))}function H(t){const e=C(v(t)),n=[\"absolute\",\"fixed\"].includes(i(t).position)&&l(t)?L(t):t;return c(n)?e.filter((t=>c(t)&&function(t,e){const n=null==e.getRootNode?void 0:e.getRootNode();if(t.contains(e))return!0;if(n&&f(n)){let n=e;do{if(n&&t===n)return!0;n=n.parentNode||n.host}while(n)}return!1}(t,n)&&\"body\"!==r(t))):[]}const S={getElementRects:t=>{let{reference:e,floating:n,strategy:o}=t;return{reference:x(e,L(n),o),floating:{...W(n),x:0,y:0}}},convertOffsetParentRelativeRectToViewportRelativeRect:t=>function(t){let{rect:e,offsetParent:n,strategy:o}=t;const i=l(n),c=m(n);if(n===c)return e;let f={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if((i||!i&&\"fixed\"!==o)&&((\"body\"!==r(n)||u(c))&&(f=w(n)),l(n))){const t=p(n,!0);s.x=t.x+n.clientLeft,s.y=t.y+n.clientTop}return{...e,x:e.x-f.scrollLeft+s.x,y:e.y-f.scrollTop+s.y}}(t),getOffsetParent:t=>{let{element:e}=t;return L(e)},isElement:t=>c(t),getDocumentElement:t=>{let{element:e}=t;return m(e)},getClippingClientRect:t=>function(t){let{element:e,boundary:n,rootBoundary:o}=t;const i=[...\"clippingParents\"===n?H(e):[].concat(n),o],r=i[0],l=i.reduce(((t,n)=>{const o=R(e,n);return t.top=a(o.top,t.top),t.right=d(o.right,t.right),t.bottom=d(o.bottom,t.bottom),t.left=a(o.left,t.left),t}),R(e,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}(t),getDimensions:t=>{let{element:e}=t;return W(e)},getClientRects:t=>{let{element:e}=t;return e.getClientRects()}},D=(t,n,o)=>e(t,n,{platform:S,...o});export{D as computePosition,C as getScrollParents};\n","/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\nimport { __decorate } from \"tslib\";\nimport { html, SpectrumElement, } from '@spectrum-web-components/base';\nimport { ifDefined } from '@spectrum-web-components/base/src/directives.js';\nimport { property } from '@spectrum-web-components/base/src/decorators.js';\nimport { reparentChildren } from '@spectrum-web-components/shared';\nimport { firstFocusableIn } from '@spectrum-web-components/shared/src/first-focusable-in.js';\nimport styles from './active-overlay.css.js';\nimport { arrow, computePosition, flip, offset, shift, size, } from '@floating-ui/dom';\nconst stateMachine = {\n    initial: 'idle',\n    states: {\n        idle: {\n            on: {\n                active: 'active',\n            },\n        },\n        active: {\n            on: {\n                hiding: 'hiding',\n                idle: 'idle',\n            },\n        },\n        hiding: {\n            on: {\n                dispose: 'dispose',\n            },\n        },\n        dispose: {\n            on: {\n                disposed: 'disposed',\n            },\n        },\n        disposed: {\n            on: {},\n        },\n    },\n};\nconst stateTransition = (state, event) => {\n    if (!state)\n        return stateMachine.initial;\n    /* c8 ignore next */\n    if (!event)\n        return state;\n    return stateMachine.states[state].on[event] || state;\n};\nconst parentOverlayOf = (el) => {\n    const closestOverlay = el.closest('active-overlay');\n    if (closestOverlay) {\n        return closestOverlay;\n    }\n    const rootNode = el.getRootNode();\n    if (rootNode.host) {\n        return parentOverlayOf(rootNode.host);\n    }\n    return null;\n};\n/**\n * @element active-overlay\n *\n * @slot - content to display in the overlay\n */\nexport class ActiveOverlay extends SpectrumElement {\n    constructor() {\n        super();\n        this._state = stateTransition();\n        this.animating = false;\n        this.theme = {};\n        this.tabbingAway = false;\n        this.offset = 6;\n        this.interaction = 'hover';\n        this.positionAnimationFrame = 0;\n        this.willNotifyClosed = false;\n        this.isConstrained = false;\n        this.updateOverlayPosition = async () => {\n            if (!this.placement || this.placement === 'none') {\n                return;\n            }\n            await (document.fonts ? document.fonts.ready : Promise.resolve());\n            function roundByDPR(num) {\n                const dpr = window.devicePixelRatio || 1;\n                return Math.round(num * dpr) / dpr || 0;\n            }\n            // See: https://spectrum.adobe.com/page/popover/#Container-padding\n            const REQUIRED_DISTANCE_TO_EDGE = 8;\n            // See: https://github.com/adobe/spectrum-web-components/issues/910\n            const MIN_OVERLAY_HEIGHT = 100;\n            const middleware = [\n                offset(this.offset),\n                flip({\n                    fallbackStrategy: 'initialPlacement',\n                }),\n                shift({ padding: REQUIRED_DISTANCE_TO_EDGE }),\n                size({\n                    padding: REQUIRED_DISTANCE_TO_EDGE,\n                    apply: ({ width, height, floating }) => {\n                        const maxHeight = Math.max(MIN_OVERLAY_HEIGHT, Math.floor(height));\n                        const actualHeight = floating.height;\n                        this.initialHeight = !this.isConstrained\n                            ? actualHeight\n                            : this.initialHeight || actualHeight;\n                        this.isConstrained =\n                            actualHeight < this.initialHeight ||\n                                maxHeight <= actualHeight;\n                        const appliedHeight = this.isConstrained\n                            ? `${maxHeight}px`\n                            : '';\n                        Object.assign(this.style, {\n                            maxWidth: `${Math.floor(width)}px`,\n                            maxHeight: appliedHeight,\n                            height: appliedHeight,\n                        });\n                    },\n                }),\n            ];\n            if (this.overlayContentTip) {\n                middleware.push(arrow({ element: this.overlayContentTip }));\n            }\n            const { x, y, placement, middlewareData } = await computePosition(this.virtualTrigger || this.trigger, this, {\n                placement: this.placement,\n                middleware,\n            });\n            Object.assign(this.style, {\n                left: `${roundByDPR(x)}px`,\n                top: `${roundByDPR(y)}px`,\n            });\n            if (placement !== this.getAttribute('actual-placement')) {\n                this.setAttribute('actual-placement', placement);\n                this.overlayContent.setAttribute('placement', placement);\n            }\n            if (this.overlayContentTip && middlewareData.arrow) {\n                const { x: arrowX, y: arrowY } = middlewareData.arrow;\n                Object.assign(this.overlayContentTip.style, {\n                    left: arrowX != null ? `${roundByDPR(arrowX)}px` : '',\n                    top: arrowY != null ? `${roundByDPR(arrowY)}px` : '',\n                    right: '',\n                    bottom: '',\n                });\n            }\n        };\n        this.handleInlineTriggerKeydown = (event) => {\n            const { code, shiftKey } = event;\n            /* c8 ignore next */\n            if (code !== 'Tab')\n                return;\n            if (shiftKey) {\n                this.tabbingAway = true;\n                this.dispatchEvent(new Event('close'));\n                return;\n            }\n            event.stopPropagation();\n            event.preventDefault();\n            this.focus();\n        };\n        this.stealOverlayContentPromise = Promise.resolve();\n        this.stealOverlayContentPromise = new Promise((res) => (this.stealOverlayContentResolver = res));\n    }\n    get state() {\n        return this._state;\n    }\n    set state(state) {\n        const nextState = stateTransition(this.state, state);\n        if (nextState === this.state) {\n            return;\n        }\n        this._state = nextState;\n        if (this.state === 'active' || this.state === 'hiding') {\n            this.setAttribute('state', this.state);\n        }\n        else {\n            this.removeAttribute('state');\n        }\n    }\n    focus() {\n        const firstFocusable = firstFocusableIn(this);\n        if (firstFocusable) {\n            firstFocusable.focus();\n            /* c8 ignore next 3 */\n        }\n        else {\n            super.focus();\n        }\n        this.removeAttribute('tabindex');\n    }\n    get hasTheme() {\n        return !!this.theme.color || !!this.theme.scale || !!this.theme.lang;\n    }\n    static get styles() {\n        return [styles];\n    }\n    get hasModalRoot() {\n        return !!this._modalRoot;\n    }\n    feature() {\n        this.tabIndex = -1;\n        const parentOverlay = parentOverlayOf(this.trigger);\n        const parentIsModal = parentOverlay && parentOverlay.slot === 'open';\n        // If an overlay it triggered from within a \"modal\" overlay, it needs to continue\n        // to act like one to get treated correctly in regards to tab trapping.\n        if (this.interaction === 'modal' || parentIsModal || this._modalRoot) {\n            this.slot = 'open';\n            // If this isn't a modal root, walk up the overlays to the next modal root\n            // and \"feature\" each on of the intervening overlays.\n            if (this._modalRoot) {\n                parentOverlay === null || parentOverlay === void 0 ? void 0 : parentOverlay.feature();\n            }\n        }\n    }\n    obscure(nextOverlayInteraction) {\n        if (this.slot && nextOverlayInteraction === 'modal') {\n            this.removeAttribute('slot');\n            // Obscure upto and including the next modal root.\n            if (this.interaction !== 'modal') {\n                const parentOverlay = parentOverlayOf(this.trigger);\n                this._modalRoot = parentOverlay === null || parentOverlay === void 0 ? void 0 : parentOverlay.obscure(nextOverlayInteraction);\n                return this._modalRoot;\n            }\n            return this;\n        }\n        return undefined;\n    }\n    async firstUpdated(changedProperties) {\n        super.firstUpdated(changedProperties);\n        /* c8 ignore next */\n        if (!this.overlayContent || !this.trigger)\n            return;\n        this.stealOverlayContent(this.overlayContent);\n        this.state = 'active';\n        this.feature();\n        if (this.placement === 'none') {\n            this.style.setProperty('--swc-visual-viewport-height', `${window.innerHeight}px`);\n        }\n        else if (this.placement) {\n            await this.updateOverlayPosition();\n            document.addEventListener('sp-update-overlays', this.updateOverlayPosition);\n            window.addEventListener('scroll', this.updateOverlayPosition);\n        }\n        const actions = [];\n        if (this.placement && this.placement !== 'none') {\n            actions.push(this.applyContentAnimation('sp-overlay-fade-in'));\n        }\n        if (typeof this.overlayContent.updateComplete !==\n            'undefined') {\n            actions.push(this.overlayContent.updateComplete);\n        }\n        this.childrenReady = Promise.all(actions);\n    }\n    async openCallback() {\n        await this.updateComplete;\n        if (this.receivesFocus) {\n            this.focus();\n        }\n        this.trigger.dispatchEvent(new CustomEvent('sp-opened', {\n            bubbles: true,\n            composed: true,\n            cancelable: true,\n            detail: {\n                interaction: this.interaction,\n            },\n        }));\n    }\n    open(openDetail) {\n        this.extractDetail(openDetail);\n    }\n    extractDetail(detail) {\n        this.overlayContent = detail.content;\n        this.overlayContentTip = detail.contentTip;\n        this.trigger = detail.trigger;\n        this.virtualTrigger = detail.virtualTrigger;\n        this.placement = detail.placement;\n        this.offset = detail.offset;\n        this.interaction = detail.interaction;\n        this.theme = detail.theme;\n        this.receivesFocus = detail.receivesFocus;\n    }\n    dispose() {\n        /* c8 ignore next */\n        if (this.state !== 'dispose')\n            return;\n        /* c8 ignore next 4 */\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n            delete this.timeout;\n        }\n        this.trigger.removeEventListener('keydown', this.handleInlineTriggerKeydown);\n        this.returnOverlayContent();\n        this.state = 'disposed';\n        if (this.willNotifyClosed) {\n            this.overlayContent.dispatchEvent(new Event('sp-overlay-closed'));\n            this.willNotifyClosed = false;\n        }\n    }\n    stealOverlayContent(element) {\n        this.originalPlacement = element.getAttribute('placement');\n        this.restoreContent = reparentChildren([element], this, (el) => {\n            const slotName = el.slot;\n            const placement = el.placement;\n            el.removeAttribute('slot');\n            return (el) => {\n                el.slot = slotName;\n                el.placement = placement;\n            };\n        });\n        this.stealOverlayContentResolver();\n    }\n    returnOverlayContent() {\n        /* c8 ignore next */\n        if (!this.restoreContent)\n            return;\n        const [element] = this.restoreContent();\n        this.restoreContent = undefined;\n        this.willNotifyClosed = true;\n        if (this.originalPlacement) {\n            element.setAttribute('placement', this.originalPlacement);\n            delete this.originalPlacement;\n        }\n    }\n    async hide(animated = true) {\n        this.state = 'hiding';\n        if (animated) {\n            await this.applyContentAnimation('sp-overlay-fade-out');\n        }\n        this.state = 'dispose';\n    }\n    schedulePositionUpdate() {\n        // Edge needs a little time to update the DOM before computing the layout\n        cancelAnimationFrame(this.positionAnimationFrame);\n        this.positionAnimationFrame = requestAnimationFrame(() => this.updateOverlayPosition());\n    }\n    onSlotChange() {\n        this.schedulePositionUpdate();\n    }\n    applyContentAnimation(animation) {\n        return new Promise((resolve) => {\n            const contents = this.shadowRoot.querySelector('#contents');\n            const doneHandler = (event) => {\n                if (animation !== event.animationName)\n                    return;\n                contents.removeEventListener('animationend', doneHandler);\n                contents.removeEventListener('animationcancel', doneHandler);\n                this.animating = false;\n                resolve(event.type === 'animationcancel');\n            };\n            contents.addEventListener('animationend', doneHandler);\n            contents.addEventListener('animationcancel', doneHandler);\n            contents.style.animationName = animation;\n            this.animating = true;\n        });\n    }\n    renderTheme(content) {\n        const { color, scale, lang } = this.theme;\n        return html `\n            <sp-theme\n                color=${ifDefined(color)}\n                scale=${ifDefined(scale)}\n                lang=${ifDefined(lang)}\n                part=\"theme\"\n            >\n                ${content}\n            </sp-theme>\n        `;\n    }\n    render() {\n        const content = html `\n            <div id=\"contents\">\n                <slot @slotchange=${this.onSlotChange}></slot>\n            </div>\n        `;\n        return this.hasTheme ? this.renderTheme(content) : content;\n    }\n    static create(details) {\n        const overlay = new ActiveOverlay();\n        if (details.content) {\n            overlay.open(details);\n        }\n        return overlay;\n    }\n    async getUpdateComplete() {\n        const actions = [\n            super.getUpdateComplete(),\n            this.stealOverlayContentPromise,\n        ];\n        if (this.childrenReady) {\n            actions.push(this.childrenReady);\n        }\n        const [complete] = await Promise.all(actions);\n        return complete;\n    }\n    disconnectedCallback() {\n        document.removeEventListener('sp-update-overlays', this.updateOverlayPosition);\n        window.removeEventListener('scroll', this.updateOverlayPosition);\n        super.disconnectedCallback();\n    }\n}\n__decorate([\n    property()\n], ActiveOverlay.prototype, \"_state\", void 0);\n__decorate([\n    property({ reflect: true, type: Boolean })\n], ActiveOverlay.prototype, \"animating\", void 0);\n__decorate([\n    property({ reflect: true })\n], ActiveOverlay.prototype, \"placement\", void 0);\n__decorate([\n    property({ attribute: false })\n], ActiveOverlay.prototype, \"theme\", void 0);\n__decorate([\n    property({ attribute: false })\n], ActiveOverlay.prototype, \"receivesFocus\", void 0);\n//# sourceMappingURL=ActiveOverlay.js.map","/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\nconst DEFAULT_WARMUP = 1000;\nconst DEFAULT_COOLDOWN = 1000;\n/**\n * A timer to help with implementation of warnup/cooldown behavior as described here:\n * https://spectrum.adobe.com/page/tooltip/#Immediate-or-delayed-appearance\n */\nexport class OverlayTimer {\n    constructor(options = {}) {\n        this.warmUpDelay = DEFAULT_WARMUP;\n        this.coolDownDelay = DEFAULT_COOLDOWN;\n        this.isWarm = false;\n        this.timeout = 0;\n        Object.assign(this, options);\n    }\n    async openTimer(component) {\n        this.cancelCooldownTimer();\n        if (!this.component || component !== this.component) {\n            if (this.component) {\n                this.close(this.component);\n                this.cancelCooldownTimer();\n            }\n            this.component = component;\n            if (this.isWarm) {\n                return false;\n            }\n            this.promise = new Promise((resolve) => {\n                this.resolve = resolve;\n                this.timeout = window.setTimeout(() => {\n                    if (this.resolve) {\n                        this.resolve(false);\n                        this.isWarm = true;\n                    }\n                }, this.warmUpDelay);\n            });\n            return this.promise;\n        }\n        else if (this.promise) {\n            return this.promise;\n        }\n        else {\n            // This should never happen\n            throw new Error('Inconsistent state');\n        }\n    }\n    close(component) {\n        if (this.component && this.component === component) {\n            this.resetCooldownTimer();\n            if (this.timeout > 0) {\n                clearTimeout(this.timeout);\n                this.timeout = 0;\n            }\n            if (this.resolve) {\n                this.resolve(true);\n                delete this.resolve;\n            }\n            delete this.promise;\n            delete this.component;\n        }\n    }\n    resetCooldownTimer() {\n        if (this.isWarm) {\n            if (this.cooldownTimeout) {\n                window.clearTimeout(this.cooldownTimeout);\n            }\n            this.cooldownTimeout = window.setTimeout(() => {\n                this.isWarm = false;\n                delete this.cooldownTimeout;\n            }, this.coolDownDelay);\n        }\n    }\n    cancelCooldownTimer() {\n        if (this.cooldownTimeout) {\n            window.clearTimeout(this.cooldownTimeout);\n        }\n        delete this.cooldownTimeout;\n    }\n}\n//# sourceMappingURL=overlay-timer.js.map","/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\nimport { ActiveOverlay } from './src/ActiveOverlay.js';\ncustomElements.define('active-overlay', ActiveOverlay);\n//# sourceMappingURL=active-overlay.js.map","/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\nimport { OverlayStack } from './overlay-stack.js';\n/**\n * This class allows access to the overlay system which allows a client to\n * position an element in the overlay positioned relative to another node.\n */\nexport class Overlay {\n    /**\n     *\n     * @param owner the parent element we will use to position the overlay element\n     * @param interaction the type of interaction that caused this overlay to be shown\n     * @param overlayElement the item to display as an overlay\n     */\n    constructor(owner, interaction, overlayElement) {\n        this.isOpen = false;\n        this.owner = owner;\n        this.overlayElement = overlayElement;\n        this.interaction = interaction;\n    }\n    /**\n     * Open an overlay\n     *\n     * @param owner the parent element we will use to position the overlay element\n     * @param interaction the type of interaction that caused this overlay to be shown\n     * @param overlayElement the item to display as an overlay\n     * @param options display parameters\n     * @param options.delayed if true delay opening of the overlay based on the global warmup/cooldown timer\n     * @param options.offset distance to offset the overlay\n     * @param options.placement side on which to position the overlay\n     * @returns an Overlay object which can be used to close the overlay\n     */\n    static async open(owner, interaction, overlayElement, options) {\n        const overlay = new Overlay(owner, interaction, overlayElement);\n        await overlay.open(options);\n        return () => {\n            overlay.close();\n        };\n    }\n    static update() {\n        const overlayUpdateEvent = new CustomEvent('sp-update-overlays', {\n            bubbles: true,\n            composed: true,\n            cancelable: true,\n        });\n        document.dispatchEvent(overlayUpdateEvent);\n    }\n    /**\n     * Open an overlay\n     *\n     * @param options display parameters\n     * @param options.delayed delay before opening the overlay\n     * @param options.offset distance to offset the overlay\n     * @param options.placement side on which to position the overlay\n     * @returns a Promise that resolves to true if this operation was cancelled\n     */\n    async open({ abortPromise, delayed, offset = 0, placement = 'top', receivesFocus, notImmediatelyClosable, virtualTrigger, }) {\n        /* c8 ignore next */\n        if (this.isOpen)\n            return true;\n        if (delayed === undefined) {\n            delayed = this.overlayElement.hasAttribute('delayed');\n        }\n        const queryThemeDetail = {\n            color: undefined,\n            scale: undefined,\n            lang: undefined,\n        };\n        const queryThemeEvent = new CustomEvent('sp-query-theme', {\n            bubbles: true,\n            composed: true,\n            detail: queryThemeDetail,\n            cancelable: true,\n        });\n        this.owner.dispatchEvent(queryThemeEvent);\n        const overlayDetailQuery = {};\n        const queryOverlayDetailEvent = new CustomEvent('sp-overlay-query', {\n            bubbles: true,\n            composed: true,\n            detail: overlayDetailQuery,\n            cancelable: true,\n        });\n        this.overlayElement.dispatchEvent(queryOverlayDetailEvent);\n        await Overlay.overlayStack.openOverlay(Object.assign({ abortPromise, content: this.overlayElement, contentTip: overlayDetailQuery.overlayContentTipElement, delayed, offset: offset, placement: placement, trigger: this.owner, interaction: this.interaction, theme: queryThemeDetail, receivesFocus,\n            notImmediatelyClosable,\n            virtualTrigger }, overlayDetailQuery));\n        this.isOpen = true;\n        return true;\n    }\n    /**\n     * Close the overlay if it is open\n     */\n    close() {\n        Overlay.overlayStack.closeOverlay(this.overlayElement);\n    }\n}\nOverlay.overlayStack = new OverlayStack();\n/**\n * Announces that an overlay-based UI element has opened\n * @event sp-open\n * @type {object}\n * @property {TriggerInteractions} interaction type of interaction that triggered the opening\n */\n/**\n * Announces that an overlay-based UI element has opened\n * @event sp-close\n * @type {object}\n * @property {TriggerInteractions} interaction type of interaction that triggered the closing\n */\n//# sourceMappingURL=overlay.js.map","/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\nimport { ActiveOverlay } from './ActiveOverlay.js';\nimport { OverlayTimer } from './overlay-timer.js';\nimport '../active-overlay.js';\nfunction isLeftClick(event) {\n    return event.button === 0;\n}\nfunction hasModifier(event) {\n    return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\nexport class OverlayStack {\n    constructor() {\n        this.overlays = [];\n        this.preventMouseRootClose = false;\n        this.root = document.body;\n        this.handlingResize = false;\n        this.overlayTimer = new OverlayTimer();\n        this.canTabTrap = true;\n        this.trappingInited = false;\n        this._eventsAreBound = false;\n        this._bodyMarginsApplied = false;\n        this.forwardContextmenuEvent = async (event) => {\n            const topOverlay = this.overlays[this.overlays.length - 1];\n            if (!this.trappingInited ||\n                topOverlay.interaction !== 'modal' ||\n                event.target !== this.overlayHolder) {\n                return;\n            }\n            event.stopPropagation();\n            event.preventDefault();\n            await this.closeTopOverlay();\n            let target = document.elementFromPoint(event.clientX, event.clientY);\n            while (target === null || target === void 0 ? void 0 : target.shadowRoot) {\n                const innerTarget = target.shadowRoot.elementFromPoint(event.clientX, event.clientY);\n                if (!innerTarget || innerTarget === target) {\n                    break;\n                }\n                target = innerTarget;\n            }\n            target === null || target === void 0 ? void 0 : target.dispatchEvent(new MouseEvent('contextmenu', event));\n        };\n        this.handleMouseCapture = (event) => {\n            const topOverlay = this.topOverlay;\n            if (!event.target ||\n                !topOverlay ||\n                !topOverlay.overlayContent ||\n                hasModifier(event) ||\n                !isLeftClick(event)) {\n                this.preventMouseRootClose = true;\n                return;\n            }\n            if (event.target instanceof Node) {\n                const path = event.composedPath();\n                if (path.indexOf(topOverlay.overlayContent) >= 0) {\n                    this.preventMouseRootClose = true;\n                    return;\n                }\n                this.preventMouseRootClose = false;\n            }\n        };\n        /**\n         * A \"longpress\" occurs before the \"click\" that creates it has occured.\n         * In that way the first click will still be part of the \"longpress\" and\n         * not part of closing the overlay.\n         */\n        this._doesNotCloseOnFirstClick = false;\n        this.handleMouse = (event) => {\n            if (this._doesNotCloseOnFirstClick) {\n                this._doesNotCloseOnFirstClick = false;\n                return;\n            }\n            if (this.preventMouseRootClose || event.defaultPrevented) {\n                return;\n            }\n            this.closeTopOverlay();\n        };\n        this.handleKeyUp = (event) => {\n            if (event.code === 'Escape') {\n                this.closeTopOverlay();\n            }\n        };\n        this.handleResize = () => {\n            if (this.handlingResize)\n                return;\n            this.handlingResize = true;\n            requestAnimationFrame(async () => {\n                const promises = this.overlays.map((overlay) => overlay.updateOverlayPosition());\n                await Promise.all(promises);\n                this.handlingResize = false;\n            });\n        };\n    }\n    initTabTrapping() {\n        if (this.trappingInited)\n            return;\n        this.trappingInited = true;\n        /* c8 ignore next 4 */\n        if (this.document.body.shadowRoot) {\n            this.canTabTrap = false;\n            return;\n        }\n        this.document.body.attachShadow({ mode: 'open' });\n        /* c8 ignore next 3 */\n        if (!this.document.body.shadowRoot) {\n            return;\n        }\n        const root = this.document.body.shadowRoot;\n        root.innerHTML = `\n            <style>\n            :host {\n                position: relative;\n            }\n            #actual {\n                position: relative;\n                height: calc(100% - var(--swc-body-margins-block, 0px));\n                z-index: 0;\n                min-height: calc(100vh - var(--swc-body-margins-block, 0px));\n            }\n            #holder {\n                display: none;\n                align-items: center;\n                justify-content: center;\n                flex-flow: column;\n                width: 100%;\n                height: 100%;\n                position: absolute;\n                top: 0;\n                left: 0;\n            }\n            [name=\"open\"]::slotted(*) {\n                pointer-events: all;\n            }\n            #actual[aria-hidden] + #holder {\n                display: flex;\n            }\n            </style>\n            <div id=\"actual\"><slot></slot></div>\n            <div id=\"holder\"><slot name=\"open\"></slot></div>\n        `;\n        this.tabTrapper = root.querySelector('#actual');\n        this.overlayHolder = root.querySelector('#holder');\n        this.tabTrapper.attachShadow({ mode: 'open' });\n        if (this.tabTrapper.shadowRoot) {\n            this.tabTrapper.shadowRoot.innerHTML = '<slot></slot>';\n        }\n        this.overlayHolder.addEventListener('contextmenu', this.forwardContextmenuEvent, true);\n        requestAnimationFrame(() => {\n            this.applyBodyMargins();\n            const observer = new ResizeObserver(() => {\n                this.applyBodyMargins();\n            });\n            observer.observe(document.body);\n        });\n    }\n    applyBodyMargins() {\n        const { marginLeft, marginRight, marginTop, marginBottom } = getComputedStyle(document.body);\n        const allZero = parseFloat(marginLeft) === 0 &&\n            parseFloat(marginRight) === 0 &&\n            parseFloat(marginTop) === 0 &&\n            parseFloat(marginBottom) === 0;\n        if (allZero && !this._bodyMarginsApplied) {\n            return;\n        }\n        this.tabTrapper.style.setProperty('--swc-body-margins-inline', `calc(${marginLeft} + ${marginRight})`);\n        this.tabTrapper.style.setProperty('--swc-body-margins-block', `calc(${marginTop} + ${marginBottom})`);\n        this.overlayHolder.style.setProperty('--swc-body-margins-inline', `calc(${marginLeft} + ${marginRight})`);\n        this.overlayHolder.style.setProperty('--swc-body-margins-block', `calc(${marginTop} + ${marginBottom})`);\n        this._bodyMarginsApplied = !allZero;\n    }\n    startTabTrapping() {\n        this.initTabTrapping();\n        /* c8 ignore next 3 */\n        if (!this.canTabTrap) {\n            return;\n        }\n        this.tabTrapper.tabIndex = -1;\n        this.tabTrapper.setAttribute('aria-hidden', 'true');\n    }\n    stopTabTrapping() {\n        /* c8 ignore next 3 */\n        if (!this.canTabTrap || !this.trappingInited) {\n            return;\n        }\n        this.tabTrapper.removeAttribute('tabindex');\n        this.tabTrapper.removeAttribute('aria-hidden');\n    }\n    get document() {\n        return this.root.ownerDocument /* c8 ignore next */ || document;\n    }\n    get topOverlay() {\n        return this.overlays.slice(-1)[0];\n    }\n    findOverlayForContent(overlayContent) {\n        for (const item of this.overlays) {\n            if (overlayContent === item.overlayContent) {\n                return item;\n            }\n        }\n        return undefined;\n    }\n    addEventListeners() {\n        if (this._eventsAreBound)\n            return;\n        this._eventsAreBound = true;\n        this.document.addEventListener('click', this.handleMouseCapture, true);\n        this.document.addEventListener('click', this.handleMouse);\n        this.document.addEventListener('keyup', this.handleKeyUp);\n        window.addEventListener('resize', this.handleResize);\n    }\n    isClickOverlayActiveForTrigger(trigger) {\n        return this.overlays.some((item) => trigger === item.trigger && item.interaction === 'click');\n    }\n    async openOverlay(details) {\n        this.addEventListeners();\n        if (this.findOverlayForContent(details.content)) {\n            return false;\n        }\n        if (details.notImmediatelyClosable) {\n            this._doesNotCloseOnFirstClick = true;\n        }\n        if (details.interaction === 'modal') {\n            this.startTabTrapping();\n        }\n        const contentWithLifecycle = details.content;\n        if (contentWithLifecycle.overlayWillOpenCallback) {\n            const { trigger } = details;\n            contentWithLifecycle.overlayWillOpenCallback({ trigger });\n        }\n        if (details.delayed) {\n            const cancelledPromise = this.overlayTimer.openTimer(details.content);\n            const promises = [cancelledPromise];\n            if (details.abortPromise) {\n                promises.push(details.abortPromise);\n            }\n            const cancelled = await Promise.race(promises);\n            if (cancelled) {\n                if (contentWithLifecycle.overlayOpenCancelledCallback) {\n                    const { trigger } = details;\n                    contentWithLifecycle.overlayOpenCancelledCallback({\n                        trigger,\n                    });\n                }\n                return cancelled;\n            }\n        }\n        if (details.interaction === 'click') {\n            this.closeAllHoverOverlays();\n        }\n        else if (details.interaction === 'hover' &&\n            this.isClickOverlayActiveForTrigger(details.trigger)) {\n            // Don't show a hover popover if the click popover is already active\n            return true;\n        }\n        const activeOverlay = ActiveOverlay.create(details);\n        if (this.overlays.length) {\n            const topOverlay = this.overlays[this.overlays.length - 1];\n            topOverlay.obscure(activeOverlay.interaction);\n        }\n        document.body.appendChild(activeOverlay);\n        /**\n         * The following work to make the new overlay the \"top\" of the stack\n         * has to happen AFTER the current call stack completes in case there\n         * is work there in to remove the previous \"top\" overlay.\n         */\n        return new Promise((res) => requestAnimationFrame(res)).then(async () => {\n            this.overlays.push(activeOverlay);\n            await activeOverlay.updateComplete;\n            this.addOverlayEventListeners(activeOverlay);\n            if (typeof contentWithLifecycle.open !== 'undefined') {\n                contentWithLifecycle.open = true;\n            }\n            if (contentWithLifecycle.overlayOpenCallback) {\n                const { trigger } = activeOverlay;\n                contentWithLifecycle.overlayOpenCallback({ trigger });\n            }\n            activeOverlay.openCallback();\n            return false;\n        });\n    }\n    addOverlayEventListeners(activeOverlay) {\n        activeOverlay.addEventListener('close', () => {\n            this.hideAndCloseOverlay(activeOverlay);\n        });\n        switch (activeOverlay.interaction) {\n            case 'replace':\n                this.addReplaceOverlayEventListeners(activeOverlay);\n                break;\n            case 'inline':\n                this.addInlineOverlayEventListeners(activeOverlay);\n                break;\n        }\n    }\n    addReplaceOverlayEventListeners(activeOverlay) {\n        activeOverlay.addEventListener('keydown', (event) => {\n            const { code } = event;\n            /* c8 ignore next */\n            if (code !== 'Tab')\n                return;\n            event.stopPropagation();\n            this.closeOverlay(activeOverlay.overlayContent);\n            activeOverlay.tabbingAway = true;\n            activeOverlay.trigger.focus();\n            activeOverlay.trigger.dispatchEvent(new KeyboardEvent('keydown', event));\n        });\n    }\n    addInlineOverlayEventListeners(activeOverlay) {\n        activeOverlay.trigger.addEventListener('keydown', activeOverlay.handleInlineTriggerKeydown);\n        activeOverlay.addEventListener('keydown', (event) => {\n            const { code, shiftKey } = event;\n            /* c8 ignore next */\n            if (code !== 'Tab')\n                return;\n            activeOverlay.tabbingAway = true;\n            if (shiftKey) {\n                const returnFocusElement = document.createElement('span');\n                returnFocusElement.tabIndex = -1;\n                if (activeOverlay.trigger.hasAttribute('slot')) {\n                    returnFocusElement.slot = activeOverlay.trigger.slot;\n                }\n                activeOverlay.trigger.insertAdjacentElement('afterend', returnFocusElement);\n                returnFocusElement.focus();\n                returnFocusElement.remove();\n                return;\n            }\n            event.stopPropagation();\n            const triggerWithLifecycle = activeOverlay.trigger;\n            if (typeof triggerWithLifecycle.open !== 'undefined') {\n                triggerWithLifecycle.open = false;\n            }\n            this.closeOverlay(activeOverlay.overlayContent);\n            activeOverlay.trigger.focus();\n        });\n    }\n    closeOverlay(content) {\n        this.overlayTimer.close(content);\n        requestAnimationFrame(() => {\n            const overlay = this.findOverlayForContent(content);\n            this.hideAndCloseOverlay(overlay);\n        });\n    }\n    closeAllHoverOverlays() {\n        for (const overlay of this.overlays) {\n            if (overlay.interaction === 'hover') {\n                this.hideAndCloseOverlay(overlay, false);\n            }\n        }\n    }\n    manageFocusAfterCloseWhenOverlaysRemain() {\n        const topOverlay = this.overlays[this.overlays.length - 1];\n        topOverlay.feature();\n        // Push focus in the the next remaining overlay as needed when a `type=\"modal\"` overlay exists.\n        if (topOverlay.interaction === 'modal' || topOverlay.hasModalRoot) {\n            topOverlay.focus();\n        }\n        else {\n            this.stopTabTrapping();\n        }\n    }\n    manageFocusAfterCloseWhenLastOverlay(overlay) {\n        this.stopTabTrapping();\n        const isModal = overlay.interaction === 'modal';\n        const isReplace = overlay.interaction === 'replace';\n        const isInline = overlay.interaction === 'inline';\n        const isTabbingAwayFromInlineOrReplace = (isReplace || isInline) && !overlay.tabbingAway;\n        overlay.tabbingAway = false;\n        if (!isModal && !isTabbingAwayFromInlineOrReplace) {\n            return;\n        }\n        // Manage post closure focus when needed.\n        const overlayRoot = overlay.overlayContent.getRootNode();\n        const overlayContentActiveElement = overlayRoot.activeElement;\n        let triggerRoot;\n        let triggerActiveElement;\n        const contentContainsActiveElement = () => overlay.overlayContent.contains(overlayContentActiveElement);\n        const triggerRootContainsActiveElement = () => {\n            triggerRoot = overlay.trigger.getRootNode();\n            triggerActiveElement = triggerRoot.activeElement;\n            return triggerRoot.contains(triggerActiveElement);\n        };\n        const triggerHostIsActiveElement = () => triggerRoot.host && triggerRoot.host === triggerActiveElement;\n        // Return focus to the trigger as long as the user hasn't actively focused\n        // something outside of the current overlay interface; trigger, root, host.\n        if (isModal ||\n            contentContainsActiveElement() ||\n            triggerRootContainsActiveElement() ||\n            triggerHostIsActiveElement()) {\n            overlay.trigger.focus();\n        }\n    }\n    async hideAndCloseOverlay(overlay, animated) {\n        if (!overlay) {\n            return;\n        }\n        const contentWithLifecycle = overlay.overlayContent;\n        if (typeof contentWithLifecycle.overlayWillCloseCallback !== 'undefined') {\n            const { trigger } = overlay;\n            if (contentWithLifecycle.overlayWillCloseCallback({ trigger })) {\n                return;\n            }\n        }\n        await overlay.hide(animated);\n        if (typeof contentWithLifecycle.open !== 'undefined') {\n            contentWithLifecycle.open = false;\n        }\n        if (contentWithLifecycle.overlayCloseCallback) {\n            const { trigger } = overlay;\n            contentWithLifecycle.overlayCloseCallback({ trigger });\n        }\n        if (overlay.state != 'dispose')\n            return;\n        const index = this.overlays.indexOf(overlay);\n        if (index >= 0) {\n            this.overlays.splice(index, 1);\n        }\n        if (this.overlays.length) {\n            this.manageFocusAfterCloseWhenOverlaysRemain();\n        }\n        else {\n            this.manageFocusAfterCloseWhenLastOverlay(overlay);\n        }\n        overlay.remove();\n        overlay.dispose();\n        overlay.trigger.dispatchEvent(new CustomEvent('sp-closed', {\n            bubbles: true,\n            composed: true,\n            cancelable: true,\n            detail: {\n                interaction: overlay.interaction,\n            },\n        }));\n    }\n    closeTopOverlay() {\n        return this.hideAndCloseOverlay(this.topOverlay);\n    }\n}\n//# sourceMappingURL=overlay-stack.js.map"],"names":["css","t","split","e","n","includes","r","o","reference","i","floating","a","placement","l","s","x","width","c","y","height","f","m","u","top","right","bottom","left","platform","rects","elements","strategy","boundary","rootBoundary","elementContext","altBoundary","p","padding","g","d","h","getClippingClientRect","element","isElement","contextElement","getDocumentElement","convertOffsetParentRelativeRectToViewportRelativeRect","rect","offsetParent","getOffsetParent","Math","min","max","replace","main","cross","start","end","reduce","concat","v","name","options","[object Object]","middlewareData","initialPlacement","flip","skip","mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","flipAlignment","w","A","P","k","overflows","push","every","R","D","index","data","reset","O","slice","sort","filter","fn","value","limiter","E","apply","size","b","toString","window","ownerDocument","defaultView","getComputedStyle","nodeName","toLowerCase","HTMLElement","Element","ShadowRoot","overflow","overflowX","overflowY","test","navigator","userAgent","transform","perspective","contain","willChange","round","getBoundingClientRect","offsetWidth","offsetHeight","Node","document","documentElement","scrollLeft","pageXOffset","scrollTop","pageYOffset","clientLeft","clientTop","assignedSlot","parentNode","host","position","L","W","T","body","C","visualViewport","clientWidth","clientHeight","abs","innerWidth","scale","offsetLeft","offsetTop","scrollWidth","scrollHeight","direction","H","getRootNode","contains","S","getElementRects","getDimensions","getClientRects","async","middleware","length","stateMachine","initial","states","idle","on","active","hiding","dispose","disposed","stateTransition","state","event","parentOverlayOf","el","closestOverlay","closest","rootNode","ActiveOverlay","SpectrumElement","super","this","_state","animating","theme","tabbingAway","offset","interaction","positionAnimationFrame","willNotifyClosed","isConstrained","updateOverlayPosition","roundByDPR","num","dpr","devicePixelRatio","fonts","ready","Promise","resolve","shift","maxHeight","floor","actualHeight","initialHeight","appliedHeight","Object","assign","style","maxWidth","overlayContentTip","centerOffset","arrow","computePosition","virtualTrigger","trigger","getAttribute","setAttribute","overlayContent","arrowX","arrowY","handleInlineTriggerKeydown","code","shiftKey","dispatchEvent","Event","stopPropagation","preventDefault","focus","stealOverlayContentPromise","res","stealOverlayContentResolver","nextState","removeAttribute","firstFocusable","firstFocusableIn","hasTheme","color","lang","styles","hasModalRoot","_modalRoot","tabIndex","parentOverlay","parentIsModal","slot","feature","nextOverlayInteraction","obscure","changedProperties","firstUpdated","stealOverlayContent","setProperty","innerHeight","addEventListener","actions","applyContentAnimation","updateComplete","childrenReady","all","receivesFocus","CustomEvent","bubbles","composed","cancelable","detail","openDetail","extractDetail","content","contentTip","timeout","clearTimeout","removeEventListener","returnOverlayContent","originalPlacement","restoreContent","reparentChildren","slotName","undefined","animated","cancelAnimationFrame","requestAnimationFrame","schedulePositionUpdate","animation","contents","shadowRoot","querySelector","doneHandler","animationName","type","html","ifDefined","onSlotChange","renderTheme","details","overlay","open","getUpdateComplete","complete","disconnectedCallback","__decorate","property","reflect","Boolean","attribute","OverlayTimer","warmUpDelay","coolDownDelay","isWarm","component","cancelCooldownTimer","promise","Error","close","setTimeout","resetCooldownTimer","cooldownTimeout","customElements","define","Overlay","owner","overlayElement","isOpen","overlayUpdateEvent","abortPromise","delayed","notImmediatelyClosable","hasAttribute","queryThemeDetail","queryThemeEvent","overlayDetailQuery","queryOverlayDetailEvent","overlayStack","openOverlay","overlayContentTipElement","closeOverlay","overlays","preventMouseRootClose","root","handlingResize","overlayTimer","canTabTrap","trappingInited","_eventsAreBound","_bodyMarginsApplied","forwardContextmenuEvent","topOverlay","target","overlayHolder","closeTopOverlay","elementFromPoint","clientX","clientY","innerTarget","MouseEvent","handleMouseCapture","metaKey","altKey","ctrlKey","hasModifier","button","isLeftClick","composedPath","indexOf","_doesNotCloseOnFirstClick","handleMouse","defaultPrevented","handleKeyUp","handleResize","promises","map","attachShadow","mode","innerHTML","tabTrapper","applyBodyMargins","ResizeObserver","observe","marginLeft","marginRight","marginTop","marginBottom","allZero","parseFloat","initTabTrapping","item","some","addEventListeners","findOverlayForContent","startTabTrapping","contentWithLifecycle","overlayWillOpenCallback","openTimer","cancelled","race","overlayOpenCancelledCallback","closeAllHoverOverlays","isClickOverlayActiveForTrigger","activeOverlay","create","appendChild","then","addOverlayEventListeners","overlayOpenCallback","openCallback","hideAndCloseOverlay","addReplaceOverlayEventListeners","addInlineOverlayEventListeners","KeyboardEvent","returnFocusElement","createElement","insertAdjacentElement","remove","triggerWithLifecycle","stopTabTrapping","isModal","isReplace","isInline","isTabbingAwayFromInlineOrReplace","overlayContentActiveElement","activeElement","triggerRoot","triggerActiveElement","overlayWillCloseCallback","hide","overlayCloseCallback","splice","manageFocusAfterCloseWhenOverlaysRemain","manageFocusAfterCloseWhenLastOverlay"],"mappings":"8GAmBA,MAPeA,CAAG;;;;kuBCZlB,SAASC,EAAEA,GAAG,OAAOA,EAAEC,MAAM,KAAK,YAAYC,EAAEF,GAAG,OAAOA,EAAEC,MAAM,KAAK,YAAYE,EAAED,GAAG,MAAM,CAAC,MAAM,UAAUE,SAASJ,EAAEE,IAAI,IAAI,aAAaG,EAAEL,GAAG,MAAM,MAAMA,EAAE,SAAS,iBAAiBM,EAAEA,GAAG,IAAIC,UAAUC,EAAEC,SAASC,EAAEC,UAAUC,GAAGN,EAAE,MAAMO,EAAEL,EAAEM,EAAEN,EAAEO,MAAM,EAAEL,EAAEK,MAAM,EAAEC,EAAER,EAAES,EAAET,EAAEU,OAAO,EAAER,EAAEQ,OAAO,EAAE,IAAIC,EAAE,OAAOnB,EAAEY,IAAI,IAAI,MAAMO,EAAE,CAACL,EAAED,EAAEI,EAAET,EAAES,EAAEP,EAAEQ,QAAQ,MAAM,IAAI,SAASC,EAAE,CAACL,EAAED,EAAEI,EAAET,EAAES,EAAET,EAAEU,QAAQ,MAAM,IAAI,QAAQC,EAAE,CAACL,EAAEN,EAAEM,EAAEN,EAAEO,MAAME,EAAED,GAAG,MAAM,IAAI,OAAOG,EAAE,CAACL,EAAEN,EAAEM,EAAEJ,EAAEK,MAAME,EAAED,GAAG,MAAM,QAAQG,EAAE,CAACL,EAAEN,EAAEM,EAAEG,EAAET,EAAES,GAAG,MAAMG,EAAEjB,EAAES,GAAGS,EAAEhB,EAAEe,GAAG,OAAOlB,EAAEU,IAAI,IAAI,QAAQO,EAAEC,GAAGD,EAAEC,IAAIZ,EAAEa,GAAG,EAAEX,EAAEW,GAAG,GAAG,MAAM,IAAI,MAAMF,EAAEC,GAAGD,EAAEC,IAAIZ,EAAEa,GAAG,EAAEX,EAAEW,GAAG,GAAG,OAAOF,EAAitB,SAAST,EAAEV,GAAG,MAAM,iBAAiBA,EAAE,SAASA,GAAG,MAAM,CAACsB,IAAI,EAAEC,MAAM,EAAEC,OAAO,EAAEC,KAAK,KAAKzB,GAApD,CAAwDA,GAAG,CAACsB,IAAItB,EAAEuB,MAAMvB,EAAEwB,OAAOxB,EAAEyB,KAAKzB,YAAYY,EAAEZ,GAAG,MAAM,IAAIA,EAAEsB,IAAItB,EAAEiB,EAAEQ,KAAKzB,EAAEc,EAAES,MAAMvB,EAAEc,EAAEd,EAAEe,MAAMS,OAAOxB,EAAEiB,EAAEjB,EAAEkB,uBAAuBL,EAAEb,EAAEE,QAAG,IAASA,IAAIA,EAAE,IAAI,MAAMY,EAAEX,EAAEc,EAAEZ,EAAEqB,SAASpB,EAAEqB,MAAMnB,EAAEoB,SAASf,EAAEgB,SAASb,GAAGhB,GAAG8B,SAASX,EAAE,kBAAkBY,aAAaX,EAAE,WAAWY,eAAeX,EAAE,WAAWY,YAAYC,GAAE,EAAGC,QAAQC,EAAE,GAAGlC,EAAEmC,EAAE3B,EAAE0B,GAAGE,EAAEzB,EAAEqB,EAAE,aAAab,EAAE,YAAY,WAAWA,GAAGJ,QAAQX,EAAEiC,sBAAsB,CAACC,cAAclC,EAAEmC,UAAUH,GAAGA,EAAEA,EAAEI,sBAAsBpC,EAAEqC,mBAAmB,CAACH,QAAQ3B,EAAEJ,WAAWqB,SAASX,EAAEY,aAAaX,IAAIN,EAAEF,QAAQN,EAAEsC,sDAAsD,CAACC,KAAK,aAAaxB,EAAE,IAAIb,EAAEC,SAASK,EAAEX,EAAEc,EAAEZ,GAAGG,EAAED,UAAUuC,mBAAmBxC,EAAEyC,gBAAgB,CAACP,QAAQ3B,EAAEJ,WAAWoB,SAASb,KAAK,MAAM,CAACM,IAAIL,EAAEK,IAAIR,EAAEQ,IAAIe,EAAEf,IAAIE,OAAOV,EAAEU,OAAOP,EAAEO,OAAOa,EAAEb,OAAOC,KAAKR,EAAEQ,KAAKX,EAAEW,KAAKY,EAAEZ,KAAKF,MAAMT,EAAES,MAAMN,EAAEM,MAAMc,EAAEd,aAAaP,EAAEgC,KAAKC,IAAI9B,EAAE6B,KAAKE,IAAI,SAAS9B,EAAEpB,EAAEE,EAAEC,GAAG,OAAOgB,EAAEnB,EAAEgB,EAAEd,EAAEC,UAAiiB+B,EAAE,CAACT,KAAK,QAAQF,MAAM,OAAOC,OAAO,MAAMF,IAAI,UAAU,SAASc,EAAEpC,GAAG,OAAOA,EAAEmD,QAAQ,0BAA0BnD,GAAGkC,EAAElC,cAAcqC,EAAErC,EAAEM,GAAG,MAAME,EAAE,UAAUN,EAAEF,GAAGU,EAAEP,EAAEH,GAAGY,EAAEP,EAAEK,GAAG,IAAIG,EAAE,MAAMH,EAAEF,EAAE,QAAQ,OAAOA,EAAE,SAAS,MAAM,OAAOF,EAAEC,UAAUK,GAAGN,EAAEG,SAASG,KAAKC,EAAEuB,EAAEvB,IAAI,CAACuC,KAAKvC,EAAEwC,MAAMjB,EAAEvB,UAAUyB,EAAE,CAACgB,MAAM,MAAMC,IAAI,SAAS,SAAStC,EAAEjB,GAAG,OAAOA,EAAEmD,QAAQ,cAAcnD,GAAGsC,EAAEtC,KAAa,CAAC,MAAM,QAAQ,SAAS,QAAYwD,QAAQ,CAACxD,EAAEE,IAAIF,EAAEyD,OAAOvD,EAAEA,EAAE,SAASA,EAAE,SAAS,IAA8+B,MAAMwD,EAAE,SAASxD,GAAG,gBAAgBA,IAAIA,EAAE,IAAI,CAACyD,KAAK,OAAOC,QAAQ1D,EAAE2D,SAAS1D,GAAG,IAAIE,EAAEC,EAAE,MAAMK,UAAUH,EAAEsD,eAAepD,EAAEiB,MAAMf,EAAEmD,iBAAiB/C,GAAGb,EAAE,GAAG,OAAOE,EAAEK,EAAEsD,OAAO3D,EAAE4D,KAAK,MAAM,GAAG,MAAMC,SAAS/C,GAAE,EAAGgD,UAAU/C,GAAE,EAAGgD,mBAAmB/C,EAAEgD,iBAAiBnC,EAAE,UAAUoC,cAAchC,GAAE,KAAMxB,GAAGZ,EAAEqE,EAAEvE,EAAEQ,GAA4EkD,EAAE,CAAC1C,KAA1EK,IAAIkD,IAAIvD,GAAIsB,EAAS,SAAStC,GAAG,MAAME,EAAEkC,EAAEpC,GAAG,MAAM,CAACiB,EAAEjB,GAAGE,EAAEe,EAAEf,IAAzC,CAA8Cc,GAArD,CAACoB,EAAEpB,MAAiEwD,QAAQ3D,EAAEV,EAAEW,GAAG2D,EAAE,GAAG,IAAIC,GAAG,OAAOpE,EAAEI,EAAEsD,WAAM,EAAO1D,EAAEqE,YAAY,GAAG,GAAGxD,GAAGsD,EAAEG,KAAKJ,EAAED,IAAInD,EAAE,CAAC,MAAMgC,KAAKpD,EAAEqD,MAAMnD,GAAGmC,EAAE7B,EAAEI,GAAG6D,EAAEG,KAAKJ,EAAExE,GAAGwE,EAAEtE,OAAOwE,EAAE,IAAIA,EAAE,CAAC/D,UAAUH,EAAEmE,UAAUF,KAAKA,EAAEI,OAAO7E,GAAGA,GAAG,IAAI,CAAC,IAAI8E,EAAEC,EAAE,MAAM/E,GAAG,OAAO8E,EAAE,OAAOC,EAAErE,EAAEsD,WAAM,EAAOe,EAAEC,OAAOF,EAAE,GAAG,EAAE5E,EAAEwD,EAAE1D,GAAG,GAAGE,EAAE,MAAM,CAAC+E,KAAK,CAACD,MAAMhF,EAAE2E,UAAUD,GAAGQ,MAAM,CAACvE,UAAUT,IAAI,IAAIC,EAAE,SAAS,OAAO+B,GAAG,IAAI,UAAU,CAAC,IAAIiD,EAAE,MAAMnF,EAAE,OAAOmF,EAAET,EAAEU,QAAQC,MAAM,CAACrF,EAAEE,IAAIF,EAAE2E,UAAUW,QAAQtF,GAAGA,EAAE,IAAIwD,QAAQ,CAACxD,EAAEE,IAAIF,EAAEE,GAAG,GAAGA,EAAEyE,UAAUW,QAAQtF,GAAGA,EAAE,IAAIwD,QAAQ,CAACxD,EAAEE,IAAIF,EAAEE,GAAG,KAAK,SAAI,EAAOiF,EAAExE,UAAUX,IAAIG,EAAEH,GAAG,UAAU,mBAAmBG,EAAEa,EAAE,MAAM,CAACiE,KAAK,CAAChB,MAAK,GAAIiB,MAAM,CAACvE,UAAUR,UAAU,MAAua2E,EAAE,SAAS5E,GAAG,gBAAgBA,IAAIA,EAAE,GAAG,CAACyD,KAAK,SAASC,QAAQ1D,EAAEqF,GAAGlF,GAAG,MAAMS,EAAER,EAAEW,EAAET,EAAEG,UAAUD,EAAEiB,MAAMf,GAAGP,EAAEQ,EAAE,SAASX,GAAG,IAAIS,UAAUN,EAAEsB,MAAMrB,EAAEkF,MAAMhF,GAAGN,EAAE,MAAMQ,EAAEV,EAAEK,GAAGO,EAAE,CAAC,OAAO,OAAOR,SAASM,IAAI,EAAE,EAAEG,EAAE,mBAAmBL,EAAEA,EAAE,IAAIF,EAAEK,UAAUN,IAAIG,GAAG0D,SAASlD,EAAEmD,UAAUhD,GAAG,iBAAiBN,EAAE,CAACqD,SAASrD,EAAEsD,UAAU,GAAG,CAACD,SAAS,EAAEC,UAAU,KAAKtD,GAAG,MAAM,MAAMV,EAAEO,GAAG,CAACI,EAAEK,EAAEF,EAAED,EAAEJ,GAAG,CAACE,EAAEE,EAAEJ,EAAEK,EAAEE,GAAtR,CAA0R,CAACR,UAAUD,EAAEiB,MAAMf,EAAE4E,MAAMtF,IAAI,MAAM,CAACY,EAAER,EAAEO,EAAEC,EAAEG,EAAET,EAAEK,EAAEI,EAAEgE,KAAKpE,MAAgDsE,MAAAA,EAAE,SAASjF,GAAG,gBAAgBA,IAAIA,EAAE,IAAI,CAACyD,KAAK,QAAQC,QAAQ1D,EAAE2D,SAASxD,GAAG,MAAMS,EAAER,EAAEW,EAAET,EAAEG,UAAUD,GAAGL,GAAG6D,SAAStD,GAAE,EAAGuD,UAAUnD,GAAE,EAAGyE,QAAQtE,EAAE,CAACoE,GAAGvF,IAAI,IAAIc,EAAEZ,EAAEe,EAAEd,GAAGH,EAAE,MAAM,CAACc,EAAEZ,EAAEe,EAAEd,QAAQkB,GAAGnB,EAAEgC,EAAE,CAACpB,EAAER,EAAEW,EAAET,GAAG4B,QAAQvB,EAAER,EAAEgB,GAAGgB,EAAElC,EAAEH,EAAEU,IAAI4B,EAAjR,SAAWtC,GAAG,MAAM,MAAMA,EAAE,IAAI,IAAmP+E,CAAE1C,GAAG,IAAIpB,EAAEiB,EAAEG,GAAGvB,EAAEoB,EAAEI,GAAG,GAAG1B,EAAE,CAAC,MAAMZ,EAAE,MAAMqC,EAAE,SAAS,QAAQpB,EAAEG,EAAEH,EAAEmB,EAAE,MAAMC,EAAE,MAAM,QAAQpB,EAAEA,EAAEmB,EAAEpC,OAAOgB,EAAE,CAAC,MAAMhB,EAAE,MAAMsC,EAAE,SAAS,QAAQxB,EAAEM,EAAEN,EAAEsB,EAAE,MAAME,EAAE,MAAM,QAAQxB,EAAEA,EAAEsB,EAAEpC,UAAUuE,EAAEpD,EAAEoE,GAAG,IAAIlF,EAAEwD,CAACxB,GAAGpB,EAAE4C,CAACvB,GAAGxB,IAAI,MAAM,IAAIyD,EAAEU,KAAK,CAACnE,EAAEyD,EAAEzD,EAAER,EAAEW,EAAEsD,EAAEtD,EAAET,OAAmyBkF,EAAE,SAASvF,GAAG,gBAAgBA,IAAIA,EAAE,IAAI,CAACwD,KAAK,OAAOC,QAAQzD,EAAE0D,SAASxD,GAAG,IAAIC,EAAE,MAAMK,UAAUH,EAAEmB,MAAMjB,EAAEoD,eAAelD,GAAGP,GAAGsF,MAAM3E,KAAKI,GAAGjB,EAAE,GAAG,OAAOG,EAAEM,EAAEgF,OAAOtF,EAAE2D,KAAK,MAAM,GAAG,MAAM5C,QAAQR,EAAER,EAAEe,GAAGc,EAAElC,EAAEQ,GAAG4B,EAAE,QAAQlC,EAAEM,GAAG,IAAI6B,EAAEC,EAAE,QAAQJ,GAAG,WAAWA,GAAGG,EAAEH,EAAEI,EAAEF,EAAE,OAAO,UAAUE,EAAEJ,EAAEG,EAAED,EAAE,MAAM,UAAU,MAAMnB,EAAEE,EAAEE,EAAEI,KAAK,GAAGX,EAAEK,EAAEE,EAAEE,MAAM,GAAGgD,EAAEpD,EAAEE,EAAEC,IAAI,GAAGuE,EAAE1E,EAAEE,EAAEG,OAAO,GAAGkC,EAAE,CAACxC,OAAOR,EAAED,SAASS,QAAQ,CAAC,OAAO,SAASd,SAASI,GAAG,GAAG,IAAI+D,GAAG,IAAIsB,EAAEtB,EAAEsB,EAAE1E,EAAEE,EAAEC,IAAID,EAAEG,SAASH,EAAEgB,IAAItB,MAAML,EAAED,SAASM,OAAO,CAAC,MAAM,UAAUX,SAASI,GAAG,GAAG,IAAIS,GAAG,IAAIH,EAAEG,EAAEH,EAAEK,EAAEE,EAAEI,KAAKJ,EAAEE,QAAQF,EAAEiB,KAAK,aAAatB,GAAGA,EAAE,IAAI0C,KAAKhD,IAAI,CAACuE,KAAK,CAAChB,MAAK,GAAIiB,MAAM,CAACvD,OAAM,OCAx3P,SAASxB,EAAEH,GAAG,MAAM,qBAAqB,MAAMA,OAAE,EAAOA,EAAE8F,qBAAqBxF,EAAEN,GAAG,GAAG,MAAMA,EAAE,OAAO+F,OAAO,IAAI5F,EAAEH,GAAG,CAAC,MAAME,EAAEF,EAAEgG,cAAc,OAAO9F,GAAGA,EAAE+F,aAAaF,cAAc/F,WAAWQ,EAAER,GAAG,OAAOM,EAAEN,GAAGkG,iBAAiBlG,YAAYK,EAAEL,GAAG,OAAOG,EAAEH,GAAG,GAAGA,GAAGA,EAAEmG,UAAU,IAAIC,cAAc,YAAYxF,EAAEZ,GAAG,OAAOA,aAAaM,EAAEN,GAAGqG,qBAAqBrF,EAAEhB,GAAG,OAAOA,aAAaM,EAAEN,GAAGsG,iBAAiBnF,EAAEnB,GAAG,OAAOA,aAAaM,EAAEN,GAAGuG,YAAYvG,aAAauG,oBAAoBlF,EAAErB,GAAG,MAAMwG,SAAStG,EAAEuG,UAAUtG,EAAEuG,UAAUpG,GAAGE,EAAER,GAAG,mCAAmC2G,KAAKzG,EAAEI,EAAEH,YAAYU,EAAEb,GAAG,MAAM,CAAC,QAAQ,KAAK,MAAMI,SAASC,EAAEL,aAAasC,EAAEtC,GAAG,MAAME,EAAE0G,UAAUC,UAAUT,cAAchG,SAAS,WAAWD,EAAEK,EAAER,GAAG,MAAM,SAASG,EAAE2G,WAAW,SAAS3G,EAAE4G,aAAa,UAAU5G,EAAE6G,SAAS,CAAC,YAAY,eAAe5G,SAASD,EAAE8G,aAAa/G,GAAG,WAAWC,EAAE8G,YAAY/G,KAAKC,EAAEmF,QAAQ,SAASnF,EAAEmF,aAAajD,EAAEW,KAAKC,IAAIvC,EAAEsC,KAAKE,IAAId,EAAEY,KAAKkE,MAAM,SAAShF,EAAElC,EAAEE,QAAG,IAASA,IAAIA,GAAE,GAAI,MAAMC,EAAEH,EAAEmH,wBAAwB,IAAI7G,EAAE,EAAEE,EAAE,EAAE,OAAON,GAAGU,EAAEZ,KAAKM,EAAEN,EAAEoH,YAAY,GAAGhF,EAAEjC,EAAEY,OAAOf,EAAEoH,aAAa,EAAE5G,EAAER,EAAEqH,aAAa,GAAGjF,EAAEjC,EAAEe,QAAQlB,EAAEqH,cAAc,GAAG,CAACtG,MAAMZ,EAAEY,MAAMT,EAAEY,OAAOf,EAAEe,OAAOV,EAAEc,IAAInB,EAAEmB,IAAId,EAAEe,MAAMpB,EAAEoB,MAAMjB,EAAEkB,OAAOrB,EAAEqB,OAAOhB,EAAEiB,KAAKtB,EAAEsB,KAAKnB,EAAEQ,EAAEX,EAAEsB,KAAKnB,EAAEW,EAAEd,EAAEmB,IAAId,YAAYY,EAAEpB,GAAG,OAAOE,EAAEF,GAAGE,aAAaI,EAAEJ,GAAGoH,KAAKtH,EAAEgG,cAAchG,EAAEuH,WAAWxB,OAAOwB,UAAUC,gBAAgB,IAAItH,WAAWqE,EAAEvE,GAAG,OAAOG,EAAEH,GAAG,CAACyH,WAAWzH,EAAE0H,YAAYC,UAAU3H,EAAE4H,aAAa,CAACH,WAAWzH,EAAEyH,WAAWE,UAAU3H,EAAE2H,oBAAoB1G,EAAEjB,GAAG,OAAOkC,EAAEd,EAAEpB,IAAIyB,KAAK8C,EAAEvE,GAAGyH,oBAAoB3G,EAAEd,EAAEE,EAAEC,GAAG,MAAMG,EAAEM,EAAEV,GAAGM,EAAEY,EAAElB,GAAGc,EAAEkB,EAAElC,EAAEM,GAAG,SAASN,GAAG,MAAME,EAAEgC,EAAElC,GAAG,OAAOoC,EAAElC,EAAEa,SAASf,EAAEoH,aAAahF,EAAElC,EAAEgB,UAAUlB,EAAEqH,aAA5E,CAA0FnH,IAAI,IAAIiB,EAAE,CAACsG,WAAW,EAAEE,UAAU,GAAG,MAAM9G,EAAE,CAACC,EAAE,EAAEG,EAAE,GAAG,GAAGX,IAAIA,GAAG,UAAUH,EAAE,IAAI,SAASE,EAAEH,IAAImB,EAAEb,MAAMW,EAAEoD,EAAErE,IAAIU,EAAEV,GAAG,CAAC,MAAMF,EAAEkC,EAAEhC,GAAE,GAAIW,EAAEC,EAAEd,EAAEc,EAAEZ,EAAE2H,WAAWhH,EAAEI,EAAEjB,EAAEiB,EAAEf,EAAE4H,eAAetH,IAAIK,EAAEC,EAAEG,EAAET,IAAI,MAAM,CAACM,EAAEE,EAAES,KAAKN,EAAEsG,WAAW5G,EAAEC,EAAEG,EAAED,EAAEM,IAAIH,EAAEwG,UAAU9G,EAAEI,EAAEF,MAAMC,EAAED,MAAMG,OAAOF,EAAEE,iBAAiBwC,EAAE1D,GAAG,MAAM,SAASK,EAAEL,GAAGA,EAAEA,EAAE+H,cAAc/H,EAAEgI,aAAa7G,EAAEnB,GAAGA,EAAEiI,KAAK,OAAO7G,EAAEpB,YAAY6F,EAAE7F,GAAG,OAAOY,EAAEZ,IAAI,UAAUkG,iBAAiBlG,GAAGkI,SAASlI,EAAE8C,aAAa,cAAcqF,EAAEnI,GAAG,MAAME,EAAEI,EAAEN,GAAG,IAAIG,EAAE0F,EAAE7F,GAAG,KAAKG,GAAGU,EAAEV,IAAI,WAAW+F,iBAAiB/F,GAAG+H,UAAU/H,EAAE0F,EAAE1F,GAAG,OAAOA,IAAI,SAASE,EAAEF,IAAI,SAASE,EAAEF,IAAI,WAAW+F,iBAAiB/F,GAAG+H,WAAW5F,EAAEnC,IAAID,EAAEC,GAAG,SAASH,GAAG,IAAIE,EAAEwD,EAAE1D,GAAG,KAAKY,EAAEV,KAAK,CAAC,OAAO,QAAQE,SAASC,EAAEH,KAAK,CAAC,GAAGoC,EAAEpC,GAAG,OAAOA,EAAEA,EAAEA,EAAE8H,uBAAzF,CAAiHhI,IAAIE,WAAWkI,EAAEpI,GAAG,MAAM,CAACe,MAAMf,EAAEoH,YAAYlG,OAAOlB,EAAEqH,uBAAuBgB,EAAErI,GAAG,MAAM,CAAC,OAAO,OAAO,aAAaI,SAASC,EAAEL,IAAIA,EAAEgG,cAAcsC,KAAK1H,EAAEZ,IAAIqB,EAAErB,GAAGA,EAAEqI,EAAE3E,EAAE1D,aAAauI,EAAEvI,EAAEE,GAAG,IAAIC,OAAE,IAASD,IAAIA,EAAE,IAAI,MAAMM,EAAE6H,EAAErI,GAAGK,EAAEG,KAAK,OAAOL,EAAEH,EAAEgG,oBAAe,EAAO7F,EAAEmI,MAAM1H,EAAEN,EAAEE,GAAGQ,EAAEX,EAAE,CAACO,GAAG6C,OAAO7C,EAAE4H,gBAAgB,GAAGnH,EAAEb,GAAGA,EAAE,IAAIA,EAAEW,EAAEjB,EAAEuD,OAAOzC,GAAG,OAAOX,EAAEc,EAAEA,EAAEsC,OAAO8E,EAAE7E,EAAE1C,cAAc8D,EAAE5E,EAAEC,GAAG,MAAM,aAAaA,EAAEH,EAAE,SAASA,GAAG,MAAME,EAAEI,EAAEN,GAAGG,EAAEiB,EAAEpB,GAAGQ,EAAEN,EAAEsI,eAAe,IAAInI,EAAEF,EAAEsI,YAAY7H,EAAET,EAAEuI,aAAa1H,EAAE,EAAEG,EAAE,EAAE,OAAOX,IAAIH,EAAEG,EAAEO,MAAMH,EAAEJ,EAAEU,OAAO8B,KAAK2F,IAAIzI,EAAE0I,WAAWpI,EAAEqI,MAAMrI,EAAEO,OAAO,MAAMC,EAAER,EAAEsI,WAAW3H,EAAEX,EAAEuI,YAAY,CAAChI,MAAMV,EAAEa,OAAON,EAAEE,EAAEE,EAAEC,EAAEE,GAApO,CAAwOjB,IAAIc,EAAEb,GAAG,SAASH,GAAG,MAAME,EAAEgC,EAAElC,GAAGG,EAAED,EAAEoB,IAAItB,EAAE8H,UAAUxH,EAAEJ,EAAEuB,KAAKzB,EAAE6H,WAAW,MAAM,CAACvG,IAAInB,EAAEsB,KAAKnB,EAAEQ,EAAER,EAAEW,EAAEd,EAAEoB,MAAMjB,EAAEN,EAAEyI,YAAYjH,OAAOrB,EAAEH,EAAE0I,aAAa3H,MAAMf,EAAEyI,YAAYvH,OAAOlB,EAAE0I,cAA1K,CAAyLvI,GAAGH,EAAE,SAASA,GAAG,IAAIE,EAAE,MAAMC,EAAEiB,EAAEpB,GAAGM,EAAEiE,EAAEvE,GAAGK,EAAE,OAAOH,EAAEF,EAAEgG,oBAAe,EAAO9F,EAAEoI,KAAK1H,EAAEF,EAAEP,EAAE6I,YAAY7I,EAAEsI,YAAYpI,EAAEA,EAAE2I,YAAY,EAAE3I,EAAEA,EAAEoI,YAAY,GAAGzH,EAAEN,EAAEP,EAAE8I,aAAa9I,EAAEuI,aAAarI,EAAEA,EAAE4I,aAAa,EAAE5I,EAAEA,EAAEqI,aAAa,GAAG,IAAIvH,GAAGb,EAAEmH,WAAWxG,EAAEjB,GAAG,MAAMqB,GAAGf,EAAEqH,UAAU,MAAM,QAAQnH,EAAEH,GAAGF,GAAG+I,YAAY/H,GAAGT,EAAEP,EAAEsI,YAAYpI,EAAEA,EAAEoI,YAAY,GAAG7H,GAAG,CAACG,MAAMH,EAAEM,OAAOF,EAAEF,EAAEK,EAAEF,EAAEI,GAA/W,CAAmXD,EAAElB,cAAciJ,GAAEnJ,GAAG,MAAME,EAAEqI,EAAE7E,EAAE1D,IAAIG,EAAE,CAAC,WAAW,SAASC,SAASI,EAAER,GAAGkI,WAAWtH,EAAEZ,GAAGmI,EAAEnI,GAAGA,EAAE,OAAOgB,EAAEb,GAAGD,EAAEoF,QAAQtF,GAAGgB,EAAEhB,IAAI,SAASA,EAAEE,GAAG,MAAMC,EAAE,MAAMD,EAAEkJ,iBAAY,EAAOlJ,EAAEkJ,cAAc,GAAGpJ,EAAEqJ,SAASnJ,GAAG,OAAM,EAAG,GAAGC,GAAGgB,EAAEhB,GAAG,CAAC,IAAIA,EAAED,EAAE,EAAE,CAAC,GAAGC,GAAGH,IAAIG,EAAE,OAAM,EAAGA,EAAEA,EAAE6H,YAAY7H,EAAE8H,WAAW9H,UAAS,EAA7K,CAAiLH,EAAEG,IAAI,SAASE,EAAEL,KAAK,SAASsJ,GAAE,CAACC,gBAAgBvJ,IAAI,IAAIO,UAAUL,EAAEO,SAASN,EAAE0B,SAASvB,GAAGN,EAAE,MAAM,CAACO,UAAUO,EAAEZ,EAAEiI,EAAEhI,GAAGG,GAAGG,SAAS,IAAI2H,EAAEjI,GAAGW,EAAE,EAAEG,EAAE,KAAK2B,sDAAsD5C,GAAG,SAASA,GAAG,IAAI6C,KAAK3C,EAAE4C,aAAa3C,EAAE0B,SAASvB,GAAGN,EAAE,MAAMQ,EAAEI,EAAET,GAAGa,EAAEI,EAAEjB,GAAG,GAAGA,IAAIa,EAAE,OAAOd,EAAE,IAAIiB,EAAE,CAACsG,WAAW,EAAEE,UAAU,GAAG,MAAM9G,EAAE,CAACC,EAAE,EAAEG,EAAE,GAAG,IAAIT,IAAIA,GAAG,UAAUF,MAAM,SAASD,EAAEF,IAAIkB,EAAEL,MAAMG,EAAEoD,EAAEpE,IAAIS,EAAET,IAAI,CAAC,MAAMH,EAAEkC,EAAE/B,GAAE,GAAIU,EAAEC,EAAEd,EAAEc,EAAEX,EAAE0H,WAAWhH,EAAEI,EAAEjB,EAAEiB,EAAEd,EAAE2H,gBAAgB,IAAI5H,EAAEY,EAAEZ,EAAEY,EAAEK,EAAEsG,WAAW5G,EAAEC,EAAEG,EAAEf,EAAEe,EAAEE,EAAEwG,UAAU9G,EAAEI,GAA9T,CAAkUjB,GAAG+C,gBAAgB/C,IAAI,IAAIwC,QAAQtC,GAAGF,EAAE,OAAOmI,EAAEjI,IAAIuC,UAAUzC,GAAGgB,EAAEhB,GAAG2C,mBAAmB3C,IAAI,IAAIwC,QAAQtC,GAAGF,EAAE,OAAOoB,EAAElB,IAAIqC,sBAAsBvC,GAAG,SAASA,GAAG,IAAIwC,QAAQtC,EAAE4B,SAAS3B,EAAE4B,aAAazB,GAAGN,EAAE,MAAMQ,EAAE,IAAI,oBAAoBL,EAAEgJ,GAAEjJ,GAAG,GAAGuD,OAAOtD,GAAGG,GAAGD,EAAEG,EAAE,GAAGI,EAAEJ,EAAEgD,QAAQ,CAACxD,EAAEG,KAAK,MAAMG,EAAEwE,EAAE5E,EAAEC,GAAG,OAAOH,EAAEsB,IAAIZ,EAAEJ,EAAEgB,IAAItB,EAAEsB,KAAKtB,EAAEuB,MAAMc,EAAE/B,EAAEiB,MAAMvB,EAAEuB,OAAOvB,EAAEwB,OAAOa,EAAE/B,EAAEkB,OAAOxB,EAAEwB,QAAQxB,EAAEyB,KAAKf,EAAEJ,EAAEmB,KAAKzB,EAAEyB,MAAMzB,IAAI8E,EAAE5E,EAAEG,IAAI,OAAOO,EAAEG,MAAMH,EAAEW,MAAMX,EAAEa,KAAKb,EAAEM,OAAON,EAAEY,OAAOZ,EAAEU,IAAIV,EAAEE,EAAEF,EAAEa,KAAKb,EAAEK,EAAEL,EAAEU,IAAIV,EAA5V,CAA+VZ,GAAGwJ,cAAcxJ,IAAI,IAAIwC,QAAQtC,GAAGF,EAAE,OAAOoI,EAAElI,IAAIuJ,eAAezJ,IAAI,IAAIwC,QAAQtC,GAAGF,EAAE,OAAOE,EAAEuJ,mBAAmB1E,GAAE,CAAC/E,EAAEG,EAAEG,IDA3kJoJ,OAAM1J,EAAEE,EAAEC,KAAK,MAAMQ,UAAUN,EAAE,SAASwB,SAASrB,EAAE,WAAWmJ,WAAWjJ,EAAE,GAAGgB,SAASd,GAAGT,EAAE,IAAIU,QAAQD,EAAE2I,gBAAgB,CAAChJ,UAAUP,EAAES,SAASP,EAAE2B,SAASrB,KAAKM,EAAEE,EAAEC,EAAEE,GAAGb,EAAE,IAAIO,EAAEF,UAAUN,IAAIe,EAAEf,EAAEgB,EAAE,GAAG,IAAI,IAAIlB,EAAE,EAAEA,EAAEO,EAAEkJ,OAAOzJ,IAAI,CAAC,MAAMwD,KAAKzB,EAAEqD,GAAGnD,GAAG1B,EAAEP,IAAIW,EAAEuB,EAAEpB,EAAEqB,EAAE2C,KAAKhE,EAAEiE,MAAMpE,SAASsB,EAAE,CAACtB,EAAEE,EAAEC,EAAEE,EAAE4C,iBAAiB1D,EAAEM,UAAUS,EAAES,SAASrB,EAAEsD,eAAezC,EAAEM,MAAMd,EAAEa,SAASd,EAAEgB,SAAS,CAACrB,UAAUP,EAAES,SAASP,KAAKc,EAAE,MAAMqB,EAAEA,EAAErB,EAAEG,EAAE,MAAMmB,EAAEA,EAAEnB,EAAEE,EAAE,IAAIA,EAAEwC,CAAC3B,GAAG,MAAMjB,EAAEA,EAAE,IAAIH,IAAI,iBAAiBA,IAAIA,EAAEH,YAAYS,EAAEN,EAAEH,WAAWG,EAAEa,QAAQd,GAAE,IAAKC,EAAEa,YAAYf,EAAE2I,gBAAgB,CAAChJ,UAAUP,EAAES,SAASP,EAAE2B,SAASrB,IAAIM,EAAEa,SAASb,EAAEE,EAAEC,EAAEE,GAAGb,EAAE,IAAIO,EAAEF,UAAUS,MAAMjB,GAAG,SAAS,CAACW,EAAEE,EAAEC,EAAEE,EAAER,UAAUS,EAAES,SAASrB,EAAEsD,eAAezC,ICA44HnB,CAAEF,EAAEG,EAAE,CAACuB,SAAS4H,MAAKhJ,ICqDltKuJ,GASF,CACAC,QAAS,OACTC,OAAQ,CACJC,KAAM,CACFC,GAAI,CACAC,OAAQ,WAGhBA,OAAQ,CACJD,GAAI,CACAE,OAAQ,SACRH,KAAM,SAGdG,OAAQ,CACJF,GAAI,CACAG,QAAS,YAGjBA,QAAS,CACLH,GAAI,CACAI,SAAU,aAGlBA,SAAU,CACNJ,GAAI,MAKVK,GAAkB,CACpBC,EACAC,IAEKD,EAEAC,GACEX,GAAaE,OAAOQ,GAAON,GAAGO,IADlBD,EAFAV,GAAaC,QAM9BW,GAAmBC,IACrB,MAAMC,EAAiBD,EAAGE,QAAQ,kBAClC,GAAID,EACA,OAAOA,EAEX,MAAME,EAAWH,EAAGtB,cACpB,OAAIyB,EAAS5C,KACFwC,GAAgBI,EAAS5C,kBAU3B6C,WAAsBC,EAqE/BlH,cACImH,QA7DGC,KAAAC,OAASZ,KAkBTW,KAAAE,WAAY,EAKZF,KAAAG,MAIH,GAIGH,KAAAI,aAAc,EAmBdJ,KAAAK,OAAS,EACTL,KAAAM,YAAmC,QAClCN,KAAAO,uBAAyB,EA2KzBP,KAAAQ,kBAAmB,EAiBnBR,KAAAS,eAAgB,EAEjBT,KAAAU,sBAAwBjC,UAC3B,IAAKuB,KAAKtK,WAAgC,SAAnBsK,KAAKtK,UACxB,OAIJ,SAASiL,EAAWC,GAChB,MAAMC,EAAM/F,OAAOgG,kBAAoB,EACvC,OAAO/I,KAAKkE,MAAM2E,EAAMC,GAAOA,GAAO,QAJnCvE,SAASyE,MAAQzE,SAASyE,MAAMC,MAAQC,QAAQC,WAQvD,MAIMxC,EAAa,CACf2B,EAAOL,KAAKK,QACZtH,EAAK,CACDK,iBAAkB,qBAEtB+H,EAAM,CAAEjK,QATsB,IAU9ByD,EAAK,CACDzD,QAX0B,EAY1BwD,MAAO,EAAG5E,MAAAA,EAAOG,OAAAA,EAAQT,SAAAA,MACrB,MAAM4L,EAAYrJ,KAAKE,IAXR,IAaXF,KAAKsJ,MAAMpL,IAETqL,EAAe9L,EAASS,OAC9B+J,KAAKuB,cAAiBvB,KAAKS,eAErBT,KAAKuB,eADLD,EAENtB,KAAKS,cACDa,EAAetB,KAAKuB,eACpBH,GAAaE,EACjB,MAAME,EAAgBxB,KAAKS,cACrB,GAAGW,MACH,GACNK,OAAOC,OAAO1B,KAAK2B,MAAO,CACtBC,SAAU,GAAG7J,KAAKsJ,MAAMvL,OACxBsL,UAAWI,EACXvL,OAAQuL,QAKpBxB,KAAK6B,mBACLnD,EAAW/E,KFlayyE1E,CAAAA,KAAKyD,KAAK,QAAQC,QAAQ1D,EAAE2D,SAASvD,GAAG,MAAMkC,QAAQhC,EAAE2B,QAAQvB,EAAE,GAAG,MAAMV,EAAEA,EAAE,IAAIY,EAAED,EAAEI,EAAED,EAAEL,UAAUQ,EAAEQ,MAAMN,EAAEK,SAASQ,GAAG5B,EAAE,GAAG,MAAME,EAAE,MAAM,GAAG,MAAM4B,EAAE1B,EAAEE,GAAGyB,EAAE,CAACvB,EAAED,EAAEI,EAAED,GAAGsB,EAAEnC,EAAEH,EAAEmB,IAAIF,EAAEZ,EAAEiC,GAAGxB,QAAQoB,EAAEsH,cAAc,CAAChH,QAAQhC,IAAI+D,EAAE,MAAMjC,EAAE,MAAM,OAAOuD,EAAE,MAAMvD,EAAE,SAAS,QAAQoB,EAAErC,EAAEd,UAAUU,GAAGI,EAAEd,UAAU+B,GAAGD,EAAEC,GAAGjB,EAAEZ,SAASQ,GAAGuD,EAAEnC,EAAEC,GAAGjB,EAAEd,UAAU+B,GAAGmC,QAAQvC,EAAEa,gBAAgB,CAACP,QAAQhC,IAAIkE,EAAED,EAAE,MAAMnC,EAAEmC,EAAEiE,cAAc,EAAEjE,EAAEgE,aAAa,EAAE,EAAE3D,EAAEpB,EAAE,EAAEc,EAAE,EAAEO,EAAE3C,EAAEmC,GAAGY,EAAET,EAAE5D,EAAEG,GAAGmB,EAAEyD,GAAG0C,EAAE7D,EAAE,EAAE5D,EAAEG,GAAG,EAAE6D,EAAEY,EAAEtE,EAAE2D,EAAEwD,EAAEpD,GAAG,MAAM,CAACF,KAAK,CAACpB,CAACvB,GAAGoD,EAAEqH,aAAaxE,EAAE7C,OEkalzFsH,CAAM,CAAExK,QAASyI,KAAK6B,qBAE1C,MAAMhM,EAAEA,EAAFG,EAAKA,EAALN,UAAQA,EAARmD,eAAmBA,SAAyBmJ,GAC9ChC,KAAKiC,gBAAkBjC,KAAKkC,QAC5BlC,KACA,CACItK,UAAWsK,KAAKtK,UAChBgJ,WAAAA,IAcR,GAVA+C,OAAOC,OAAO1B,KAAK2B,MAAO,CACtBnL,KAAM,GAAGmK,EAAW9K,OACpBQ,IAAK,GAAGsK,EAAW3K,SAGnBN,IAAcsK,KAAKmC,aAAa,sBAChCnC,KAAKoC,aAAa,mBAAoB1M,GACtCsK,KAAKqC,eAAeD,aAAa,YAAa1M,IAG9CsK,KAAK6B,mBAAqBhJ,EAAekJ,MAAO,CAChD,MAAQlM,EAAGyM,EAAQtM,EAAGuM,GAAW1J,EAAekJ,MAEhDN,OAAOC,OAAO1B,KAAK6B,kBAAkBF,MAAO,CACxCnL,KAAgB,MAAV8L,EAAiB,GAAG3B,EAAW2B,OAAc,GACnDjM,IAAe,MAAVkM,EAAiB,GAAG5B,EAAW4B,OAAc,GAClDjM,MAAO,GACPC,OAAQ,OAyBbyJ,KAAAwC,2BAA8BjD,IACjC,MAAMkD,KAAEA,EAAFC,SAAQA,GAAanD,EAE3B,GAAa,QAATkD,EAAJ,CACA,GAAIC,EAGA,OAFA1C,KAAKI,aAAc,OACnBJ,KAAK2C,cAAc,IAAIC,MAAM,UAIjCrD,EAAMsD,kBACNtD,EAAMuD,iBACN9C,KAAK+C,UA0DD/C,KAAAgD,2BAA6B/B,QAAQC,UA/VzClB,KAAKgD,2BAA6B,IAAI/B,SACjCgC,GAASjD,KAAKkD,4BAA8BD,IA9DrC3D,YACZ,YAAYW,OAEAX,UAACA,GACb,MAAM6D,EAAY9D,GAAgBW,KAAKV,MAAOA,GAC1C6D,IAAcnD,KAAKV,QAGvBU,KAAKC,OAASkD,EACK,WAAfnD,KAAKV,OAAqC,WAAfU,KAAKV,MAChCU,KAAKoC,aAAa,QAASpC,KAAKV,OAEhCU,KAAKoD,gBAAgB,UAsBtBxK,QACH,MAAMyK,EAAiBC,EAAiBtD,MACpCqD,EACAA,EAAeN,QAGfhD,MAAMgD,QAEV/C,KAAKoD,gBAAgB,YAGLG,eAChB,QAASvD,KAAKG,MAAMqD,SAAWxD,KAAKG,MAAMvC,SAAWoC,KAAKG,MAAMsD,KAS5CC,oBACpB,MAAO,CAACA,GAYWC,mBACnB,QAAS3D,KAAK4D,WAGXhL,UACHoH,KAAK6D,UAAY,EACjB,MAAMC,EAAgBtE,GAAgBQ,KAAKkC,SACrC6B,EAAgBD,GAAwC,SAAvBA,EAAcE,MAG5B,UAArBhE,KAAKM,aAA2ByD,GAAiB/D,KAAK4D,cACtD5D,KAAKgE,KAAO,OAGRhE,KAAK4D,aACLE,MAAAA,GAAAA,EAAeG,YAKpBrL,QACHsL,GAEA,GAAIlE,KAAKgE,MAAmC,UAA3BE,EAAoC,CAGjD,GAFAlE,KAAKoD,gBAAgB,QAEI,UAArBpD,KAAKM,YAAyB,CAC9B,MAAMwD,EAAgBtE,GAAgBQ,KAAKkC,SAI3C,OAHAlC,KAAK4D,WAAaE,MAAAA,OAAa,EAAbA,EAAeK,QAC7BD,QAEQN,WAEhB,aAKiBhL,mBACrBwL,GAKA,GAHArE,MAAMsE,aAAaD,IAGdpE,KAAKqC,iBAAmBrC,KAAKkC,QAAS,OAE3ClC,KAAKsE,oBACDtE,KAAKqC,gBAGTrC,KAAKV,MAAQ,SACbU,KAAKiE,UACkB,SAAnBjE,KAAKtK,UACLsK,KAAK2B,MAAM4C,YACP,+BACA,GAAGzJ,OAAO0J,iBAEPxE,KAAKtK,uBACDgL,wBACXpE,SAASmI,iBACL,qBACAzE,KAAKU,uBAET5F,OAAO2J,iBAAiB,SAAUzE,KAAKU,wBAE3C,MAAMgE,EAA8B,GAChC1E,KAAKtK,WAAgC,SAAnBsK,KAAKtK,WACvBgP,EAAQ/K,KAAKqG,KAAK2E,sBAAsB,4BAIxC,SADatC,eAAmCuC,gBAGhDF,EAAQ/K,KACHqG,KAAKqC,eAAmCuC,gBAGjD5E,KAAK6E,cAAgB5D,QAAQ6D,IAAIJ,GAGZ9L,gCACVgM,eACP5E,KAAK+E,eACL/E,KAAK+C,QAGT/C,KAAKkC,QAAQS,cACT,IAAIqC,YAAoC,YAAa,CACjDC,SAAS,EACTC,UAAU,EACVC,YAAY,EACZC,OAAQ,CACJ9E,YAAaN,KAAKM,gBAM1B1H,KAAKyM,GACTrF,KAAKsF,cAAcD,GAGfzM,cAAcwM,GAClBpF,KAAKqC,eAAiB+C,EAAOG,QAC7BvF,KAAK6B,kBAAoBuD,EAAOI,WAChCxF,KAAKkC,QAAUkD,EAAOlD,QACtBlC,KAAKiC,eAAiBmD,EAAOnD,eAC7BjC,KAAKtK,UAAY0P,EAAO1P,UACxBsK,KAAKK,OAAS+E,EAAO/E,OACrBL,KAAKM,YAAc8E,EAAO9E,YAC1BN,KAAKG,MAAQiF,EAAOjF,MACpBH,KAAK+E,cAAgBK,EAAOL,cAGzBnM,UAEgB,YAAfoH,KAAKV,QAGLU,KAAKyF,UACLC,aAAa1F,KAAKyF,qBACNA,SAGhBzF,KAAKkC,QAAQyD,oBACT,UACA3F,KAAKwC,4BAGTxC,KAAK4F,uBACL5F,KAAKV,MAAQ,WAETU,KAAKQ,mBACLR,KAAKqC,eAAeM,cAAc,IAAIC,MAAM,sBAC5C5C,KAAKQ,kBAAmB,IAIxB5H,oBACJrB,GAEAyI,KAAK6F,kBAAoBtO,EAAQ4K,aAAa,aAC9CnC,KAAK8F,eAAiBC,EAAiB,CAACxO,GAAUyI,MAAOP,IACrD,MAAMuG,EAAWvG,EAAGuE,KACdtO,EAAY+J,EAAG/J,UAErB,OADA+J,EAAG2D,gBAAgB,QACX3D,IACJA,EAAGuE,KAAOgC,EACVvG,EAAG/J,UAAYA,MAGvBsK,KAAKkD,8BAKDtK,uBAEJ,IAAKoH,KAAK8F,eAAgB,OAE1B,MAAOvO,GAAWyI,KAAK8F,iBACvB9F,KAAK8F,oBAAiBG,EACtBjG,KAAKQ,kBAAmB,EAEpBR,KAAK6F,oBACLtO,EAAQ6K,aAAa,YAAapC,KAAK6F,+BAC3BA,mBAwFHjN,WAACsN,GAAW,GACzBlG,KAAKV,MAAQ,SACT4G,cACWvB,sBAAsB,uBAErC3E,KAAKV,MAAQ,UAGT1G,yBAEJuN,qBAAqBnG,KAAKO,wBAC1BP,KAAKO,uBAAyB6F,uBAAsB,IAChDpG,KAAKU,0BAIL9H,eACJoH,KAAKqG,yBAkBFzN,sBACH0N,GAEA,WAAWrF,SAASC,IAChB,MAAMqF,EAAWvG,KAAKwG,WAAWC,cAC7B,aAEEC,EAAenH,IACb+G,IAAc/G,EAAMoH,gBACxBJ,EAASZ,oBAAoB,eAAgBe,GAC7CH,EAASZ,oBAAoB,kBAAmBe,GAChD1G,KAAKE,WAAY,EACjBgB,EAAuB,oBAAf3B,EAAMqH,QAElBL,EAAS9B,iBAAiB,eAAgBiC,GAC1CH,EAAS9B,iBAAiB,kBAAmBiC,GAE7CH,EAAS5E,MAAMgF,cAAgBL,EAC/BtG,KAAKE,WAAY,KAIlBtH,YAAY2M,GACf,MAAM/B,MAAEA,EAAF5F,MAASA,EAAT6F,KAAgBA,GAASzD,KAAKG,MACpC,OAAO0G,CAAI,oBAEKC,EAAUtD,cACVsD,EAAUlJ,aACXkJ,EAAUrD,oBAGf8B,eAKP3M,SACH,MAAM2M,EAAUsB,CAAI,yCAEQ7G,KAAK+G,8BAGjC,YAAYxD,SAAWvD,KAAKgH,YAAYzB,GAAWA,EAGnC3M,cAACqO,GACjB,MAAMC,EAAU,IAAIrH,GAMpB,OAJIoH,EAAQ1B,SACR2B,EAAQC,KAAKF,GAGVC,EAMsBtO,0BAC7B,MAAM8L,EAA8B,CAChC3E,MAAMqH,oBACNpH,KAAKgD,4BAELhD,KAAK6E,eACLH,EAAQ/K,KAAKqG,KAAK6E,eAEtB,MAAOwC,SAAkBpG,QAAQ6D,IAAIJ,GACrC,OAAO2C,EAGXzO,uBACI0D,SAASqJ,oBACL,qBACA3F,KAAKU,uBAET5F,OAAO6K,oBAAoB,SAAU3F,KAAKU,uBAC1CX,MAAMuH,wBAlbVC,EAAA,CADCC,mCAmBDD,EAAA,CADCC,EAAS,CAAEC,SAAS,EAAMb,KAAMc,4CAIjCH,EAAA,CADCC,EAAS,CAAEC,SAAS,sCAGrBF,EAAA,CADCC,EAAS,CAAEG,WAAW,kCAOvBJ,EAAA,CADCC,EAAS,CAAEG,WAAW,gDCzIdC,GAYThP,YACID,EAA4D,IAZxDqH,KAAA6H,YARW,IASX7H,KAAA8H,cARa,IAUb9H,KAAA+H,QAAS,EAIT/H,KAAAyF,QAAU,EAOdhE,OAAOC,OAAO1B,KAAMrH,GAGFC,gBAACoP,GAGnB,GAFAhI,KAAKiI,sBAEAjI,KAAKgI,WAAaA,IAAchI,KAAKgI,cAqB/BhI,KAAKkI,QACZ,YAAYA,QAGZ,UAAUC,MAAM,sBAlBhB,OANInI,KAAKgI,YACLhI,KAAKoI,MAAMpI,KAAKgI,WAChBhI,KAAKiI,uBAETjI,KAAKgI,UAAYA,GAEbhI,KAAK+H,SAIT/H,KAAKkI,QAAU,IAAIjH,SAASC,IACxBlB,KAAKkB,QAAUA,EACflB,KAAKyF,QAAU3K,OAAOuN,YAAW,KACzBrI,KAAKkB,UACLlB,KAAKkB,SAAQ,GACblB,KAAK+H,QAAS,KAEnB/H,KAAK6H,qBAEAK,SASbtP,MAAMoP,GACLhI,KAAKgI,WAAahI,KAAKgI,YAAcA,IACrChI,KAAKsI,qBACDtI,KAAKyF,QAAU,IACfC,aAAa1F,KAAKyF,SAClBzF,KAAKyF,QAAU,GAEfzF,KAAKkB,UACLlB,KAAKkB,SAAQ,eACDA,qBAEJgH,oBACAF,WAIZpP,qBACAoH,KAAK+H,SACD/H,KAAKuI,iBACLzN,OAAO4K,aAAa1F,KAAKuI,iBAE7BvI,KAAKuI,gBAAkBzN,OAAOuN,YAAW,KACrCrI,KAAK+H,QAAS,cACFQ,kBACbvI,KAAK8H,gBAIRlP,sBACAoH,KAAKuI,iBACLzN,OAAO4K,aAAa1F,KAAKuI,6BAEjBA,iBCxFpBC,eAAeC,OAAO,iBAAkB5I,UCW3B6I,GAcT9P,YACI+P,EACArI,EACAsI,GAdI5I,KAAA6I,QAAS,EAgBb7I,KAAK2I,MAAQA,EACb3I,KAAK4I,eAAiBA,EACtB5I,KAAKM,YAAcA,EAeC1H,kBACpB+P,EACArI,EACAsI,EACAjQ,GAEA,MAAMuO,EAAU,IAAIwB,GAAQC,EAAOrI,EAAasI,GAEhD,aADM1B,EAAQC,KAAKxO,GACZ,KACHuO,EAAQkB,SAIIxP,gBAChB,MAAMkQ,EAAqB,IAAI9D,YAAY,qBAAsB,CAC7DC,SAAS,EACTC,UAAU,EACVC,YAAY,IAEhB7I,SAASqG,cAAcmG,GAYVlQ,YAACmQ,aACdA,EADcC,QAEdA,EAFc3I,OAGdA,EAAS,EAHK3K,UAIdA,EAAY,MAJEqP,cAKdA,EALckE,uBAMdA,EANchH,eAOdA,IAGA,GAAIjC,KAAK6I,OAAQ,cAED5C,IAAZ+C,IACAA,EAAUhJ,KAAK4I,eAAeM,aAAa,YAG/C,MAAMC,EAA8B,CAChC3F,WAAOyC,EACPrI,WAAOqI,EACPxC,UAAMwC,GAEJmD,EAAkB,IAAIpE,YAAuB,iBAAkB,CACjEC,SAAS,EACTC,UAAU,EACVE,OAAQ+D,EACRhE,YAAY,IAEhBnF,KAAK2I,MAAMhG,cAAcyG,GAEzB,MAAMC,EAAgD,GAChDC,EACF,IAAItE,YAAuC,mBAAoB,CAC3DC,SAAS,EACTC,UAAU,EACVE,OAAQiE,EACRlE,YAAY,IAoBpB,OAlBAnF,KAAK4I,eAAejG,cAAc2G,SAE5BZ,GAAQa,aAAaC,YAAW/H,OAAAC,OAAA,CAClCqH,aAAAA,EACAxD,QAASvF,KAAK4I,eACdpD,WAAY6D,EAAmBI,yBAC/BT,QAAAA,EACA3I,OAAQA,EACR3K,UAAWA,EACXwM,QAASlC,KAAK2I,MACdrI,YAAaN,KAAKM,YAClBH,MAAOgJ,EACPpE,cAAAA,EACAkE,uBAAAA,EACAhH,eAAAA,GACGoH,IAEPrJ,KAAK6I,QAAS,KAOXjQ,QACH8P,GAAQa,aAAaG,aAAa1J,KAAK4I,iBAhI5BF,GAAAa,aAAe,UCgBlC3Q,cACWoH,KAAA2J,SAA4B,GAE3B3J,KAAA4J,uBAAwB,EACxB5J,KAAA6J,KAAoBvN,SAASe,KAC7B2C,KAAA8J,gBAAiB,EACjB9J,KAAA+J,aAAe,IAAInC,GAEnB5H,KAAAgK,YAAa,EACbhK,KAAAiK,gBAAiB,EAGjBjK,KAAAkK,iBAAkB,EAoElBlK,KAAAmK,qBAAsB,EAmDtBnK,KAAAoK,wBAA0B3L,MAAAA,IAG9B,MAAM4L,EAAarK,KAAK2J,SAAS3J,KAAK2J,SAAShL,OAAS,GACxD,IACKqB,KAAKiK,gBACqB,UAA3BI,EAAW/J,aACXf,EAAM+K,SAAWtK,KAAKuK,cAEtB,OAEJhL,EAAMsD,kBACNtD,EAAMuD,4BACK0H,kBACX,IAAIF,EAAShO,SAASmO,iBAAiBlL,EAAMmL,QAASnL,EAAMoL,SAC5D,KAAOL,MAAAA,OAAM,EAANA,EAAQ9D,YAAY,CACvB,MAAMoE,EACFN,EAAO9D,WAGTiE,iBAAiBlL,EAAMmL,QAASnL,EAAMoL,SACxC,IAAKC,GAAeA,IAAgBN,EAChC,MAEJA,EAASM,EAEbN,MAAAA,GAAAA,EAAQ3H,cAAc,IAAIkI,WAAW,cAAetL,KAiMhDS,KAAA8K,mBAAsBvL,IAC1B,MAAM8K,EAAarK,KAAKqK,WACxB,GACK9K,EAAM+K,QACND,GACAA,EAAWhI,iBAvXxB,SAAqB9C,GACjB,SAAUA,EAAMwL,SAAWxL,EAAMyL,QAAUzL,EAAM0L,SAAW1L,EAAMmD,UAuX1DwI,CAAY3L,IA5XxB,SAAqBA,GACjB,OAAwB,IAAjBA,EAAM4L,OA4XJC,CAAY7L,IAMjB,GAAIA,EAAM+K,kBAAkBjO,KAAM,CAE9B,GADakD,EAAM8L,eACVC,QAAQjB,EAAWhI,iBAAmB,EAE3C,YADArC,KAAK4J,uBAAwB,GAGjC5J,KAAK4J,uBAAwB,QAV7B5J,KAAK4J,uBAAwB,GAqI7B5J,KAAAuL,2BAA4B,EAE5BvL,KAAAwL,YAAejM,IACfS,KAAKuL,0BACLvL,KAAKuL,2BAA4B,EAGjCvL,KAAK4J,uBAAyBrK,EAAMkM,kBAGxCzL,KAAKwK,mBAGDxK,KAAA0L,YAAenM,IACA,WAAfA,EAAMkD,MACNzC,KAAKwK,mBAILxK,KAAA2L,aAAe,KACf3L,KAAK8J,iBAET9J,KAAK8J,gBAAiB,EACtB1D,uBAAsB3H,UAClB,MAAMmN,EAAW5L,KAAK2J,SAASkC,KAAK3E,GAChCA,EAAQxG,gCAENO,QAAQ6D,IAAI8G,GAClB5L,KAAK8J,gBAAiB,OA1ftBlR,kBACJ,GAAIoH,KAAKiK,eAAgB,OAGzB,GAFAjK,KAAKiK,gBAAiB,EAElBjK,KAAK1D,SAASe,KAAKmJ,WAEnB,YADAxG,KAAKgK,YAAa,GAKtB,GAFAhK,KAAK1D,SAASe,KAAKyO,aAAa,CAAEC,KAAM,UAEnC/L,KAAK1D,SAASe,KAAKmJ,WACpB,OAEJ,MAAMqD,EAAO7J,KAAK1D,SAASe,KAAKmJ,WAChCqD,EAAKmC,UAAY,4/BAgCjBhM,KAAKiM,WAAapC,EAAKpD,cAAc,WACrCzG,KAAKuK,cAAgBV,EAAKpD,cAAc,WACxCzG,KAAKiM,WAAWH,aAAa,CAAEC,KAAM,SACjC/L,KAAKiM,WAAWzF,aAChBxG,KAAKiM,WAAWzF,WAAWwF,UAAY,iBAE3ChM,KAAKuK,cAAc9F,iBACf,cACAzE,KAAKoK,yBACL,GAEJhE,uBAAsB,KAClBpG,KAAKkM,mBACY,IAAIC,gBAAe,KAChCnM,KAAKkM,sBAEAE,QAAQ9P,SAASe,SAM1BzE,mBACJ,MAAMyT,WAAEA,EAAFC,YAAcA,EAAdC,UAA2BA,EAA3BC,aAAsCA,GACxCvR,iBAAiBqB,SAASe,MACxBoP,EACyB,IAA3BC,WAAWL,IACiB,IAA5BK,WAAWJ,IACe,IAA1BI,WAAWH,IACkB,IAA7BG,WAAWF,GACXC,IAAYzM,KAAKmK,sBAGrBnK,KAAKiM,WAAWtK,MAAM4C,YAClB,4BACA,QAAQ8H,OAAgBC,MAE5BtM,KAAKiM,WAAWtK,MAAM4C,YAClB,2BACA,QAAQgI,OAAeC,MAE3BxM,KAAKuK,cAAc5I,MAAM4C,YACrB,4BACA,QAAQ8H,OAAgBC,MAE5BtM,KAAKuK,cAAc5I,MAAM4C,YACrB,2BACA,QAAQgI,OAAeC,MAE3BxM,KAAKmK,qBAAuBsC,GAGxB7T,mBACJoH,KAAK2M,kBAEA3M,KAAKgK,aAGVhK,KAAKiM,WAAWpI,UAAY,EAC5B7D,KAAKiM,WAAW7J,aAAa,cAAe,SAGxCxJ,kBAECoH,KAAKgK,YAAehK,KAAKiK,iBAG9BjK,KAAKiM,WAAW7I,gBAAgB,YAChCpD,KAAKiM,WAAW7I,gBAAgB,gBAgChB9G,eAChB,YAAYuN,KAAK9O,eAAsCuB,SAGrC+N,iBAClB,YAAYV,SAASxP,OAAO,GAAG,GAG3BvB,sBACJyJ,GAEA,IAAK,MAAMuK,UAAajD,SACpB,GAAItH,IAAmBuK,EAAKvK,eACxB,OAAOuK,EAMXhU,oBACAoH,KAAKkK,kBACTlK,KAAKkK,iBAAkB,EACvBlK,KAAK1D,SAASmI,iBAAiB,QAASzE,KAAK8K,oBAAoB,GACjE9K,KAAK1D,SAASmI,iBAAiB,QAASzE,KAAKwL,aAC7CxL,KAAK1D,SAASmI,iBAAiB,QAASzE,KAAK0L,aAC7C5Q,OAAO2J,iBAAiB,SAAUzE,KAAK2L,eAGnC/S,+BAA+BsJ,GACnC,YAAYyH,SAASkD,MAChBD,GAAS1K,IAAY0K,EAAK1K,SAAgC,UAArB0K,EAAKtM,cAI3B1H,kBAACqO,GAErB,GADAjH,KAAK8M,oBACD9M,KAAK+M,sBAAsB9F,EAAQ1B,SACnC,SAEA0B,EAAQgC,yBACRjJ,KAAKuL,2BAA4B,GAET,UAAxBtE,EAAQ3G,aACRN,KAAKgN,mBAGT,MAAMC,EACFhG,EAAQ1B,QACZ,GAAI0H,EAAqBC,wBAAyB,CAC9C,MAAMhL,QAAEA,GAAY+E,EACpBgG,EAAqBC,wBAAwB,CAAEhL,QAAAA,IAGnD,GAAI+E,EAAQ+B,QAAS,CACjB,MAGM4C,EAAW,CAHQ5L,KAAK+J,aAAaoD,UACvClG,EAAQ1B,UAGR0B,EAAQ8B,cACR6C,EAASjS,KAAKsN,EAAQ8B,cAE1B,MAAMqE,QAAkBnM,QAAQoM,KAAKzB,GACrC,GAAIwB,EAAW,CACX,GAAIH,EAAqBK,6BAA8B,CACnD,MAAMpL,QAAEA,GAAY+E,EACpBgG,EAAqBK,6BAA6B,CAC9CpL,QAAAA,IAGR,OAAOkL,GAIf,GAA4B,UAAxBnG,EAAQ3G,YACRN,KAAKuN,gCAEmB,UAAxBtG,EAAQ3G,aACRN,KAAKwN,+BAA+BvG,EAAQ/E,SAG5C,SAGJ,MAAMuL,EAAgB5N,GAAc6N,OAAOzG,GAE3C,GAAIjH,KAAK2J,SAAShL,OAAQ,CACHqB,KAAK2J,SAAS3J,KAAK2J,SAAShL,OAAS,GAC7CwF,QAAQsJ,EAAcnN,aAUrC,OAPAhE,SAASe,KAAKsQ,YAAYF,OAOfxM,SAASgC,GAAQmD,sBAAsBnD,KAAM2K,MACpDnP,UAOI,GANAuB,KAAK2J,SAAShQ,KAAK8T,SACbA,EAAc7I,eACpB5E,KAAK6N,yBAAyBJ,QACW,IAA9BR,EAAqB9F,OAC5B8F,EAAqB9F,MAAO,GAE5B8F,EAAqBa,oBAAqB,CAC1C,MAAM5L,QAAEA,GAAYuL,EACpBR,EAAqBa,oBAAoB,CAAE5L,QAAAA,IAG/C,OADAuL,EAAcM,qBAMnBnV,yBAAyB6U,GAI5B,OAHAA,EAAchJ,iBAAiB,SAAS,KACpCzE,KAAKgO,oBAAoBP,MAErBA,EAAcnN,aAClB,IAAK,UACDN,KAAKiO,gCAAgCR,GACrC,MACJ,IAAK,SACDzN,KAAKkO,+BAA+BT,IAKzC7U,gCAAgC6U,GACnCA,EAAchJ,iBAAiB,WAAYlF,IACvC,MAAMkD,KAAEA,GAASlD,EAEJ,QAATkD,IAEJlD,EAAMsD,kBACN7C,KAAK0J,aAAa+D,EAAcpL,gBAChCoL,EAAcrN,aAAc,EAC5BqN,EAAcvL,QAAQa,QACtB0K,EAAcvL,QAAQS,cAClB,IAAIwL,cAAc,UAAW5O,QAKlC3G,+BAA+B6U,GAClCA,EAAcvL,QAAQuC,iBAClB,UACAgJ,EAAcjL,4BAElBiL,EAAchJ,iBAAiB,WAAYlF,IACvC,MAAMkD,KAAEA,EAAFC,SAAQA,GAAanD,EAE3B,GAAa,QAATkD,EAAgB,OAGpB,GADAgL,EAAcrN,aAAc,EACxBsC,EAAU,CACV,MAAM0L,EAAqB9R,SAAS+R,cAAc,QAWlD,OAVAD,EAAmBvK,UAAY,EAC3B4J,EAAcvL,QAAQgH,aAAa,UACnCkF,EAAmBpK,KAAOyJ,EAAcvL,QAAQ8B,MAEpDyJ,EAAcvL,QAAQoM,sBAClB,WACAF,GAEJA,EAAmBrL,aACnBqL,EAAmBG,SAIvBhP,EAAMsD,kBACN,MAAM2L,EACFf,EAAcvL,aACuB,IAA9BsM,EAAqBrH,OAC5BqH,EAAqBrH,MAAO,GAEhCnH,KAAK0J,aAAa+D,EAAcpL,gBAChCoL,EAAcvL,QAAQa,WAIvBnK,aAAa2M,GAChBvF,KAAK+J,aAAa3B,MAAM7C,GACxBa,uBAAsB,KAClB,MAAMc,EAAUlH,KAAK+M,sBAAsBxH,GAC3CvF,KAAKgO,oBAAoB9G,MA2BzBtO,wBACJ,IAAK,MAAMsO,UAAgByC,SACK,UAAxBzC,EAAQ5G,aACRN,KAAKgO,oBAAoB9G,GAAS,GAKtCtO,0CACJ,MAAMyR,EAAarK,KAAK2J,SAAS3J,KAAK2J,SAAShL,OAAS,GACxD0L,EAAWpG,UAEoB,UAA3BoG,EAAW/J,aAA2B+J,EAAW1G,aACjD0G,EAAWtH,QAEX/C,KAAKyO,kBAIL7V,qCAAqCsO,GACzClH,KAAKyO,kBACL,MAAMC,EAAkC,UAAxBxH,EAAQ5G,YAClBqO,EAAoC,YAAxBzH,EAAQ5G,YACpBsO,EAAmC,WAAxB1H,EAAQ5G,YACnBuO,GACDF,GAAaC,KAAc1H,EAAQ9G,YAExC,GADA8G,EAAQ9G,aAAc,GACjBsO,IAAYG,EACb,OAGJ,MACMC,EADc5H,EAAQ7E,eAAelE,cACK4Q,cAChD,IAAIC,EACAC,GAaAP,GAXAxH,EAAQ7E,eAAejE,SAAS0Q,KAEhCE,EAAc9H,EAAQhF,QAAQ/D,cAC9B8Q,EAAuBD,EAAYD,cAC5BC,EAAY5Q,SAAS6Q,KAG5BD,EAAYhS,MAAQgS,EAAYhS,OAASiS,IASzC/H,EAAQhF,QAAQa,QAISnK,0BAC7BsO,EACAhB,GAEA,IAAKgB,EACD,OAEJ,MAAM+F,EACF/F,EAAQ7E,eACZ,QAC6D,IAAlD4K,EAAqBiC,yBAC9B,CACE,MAAMhN,QAAEA,GAAYgF,EACpB,GAAI+F,EAAqBiC,yBAAyB,CAAEhN,QAAAA,IAChD,OAOR,SAJMgF,EAAQiI,KAAKjJ,QACsB,IAA9B+G,EAAqB9F,OAC5B8F,EAAqB9F,MAAO,GAE5B8F,EAAqBmC,qBAAsB,CAC3C,MAAMlN,QAAEA,GAAYgF,EACpB+F,EAAqBmC,qBAAqB,CAAElN,QAAAA,IAGhD,GAAqB,WAAjBgF,EAAQ5H,MAAoB,OAEhC,MAAMvF,EAAQiG,KAAK2J,SAAS2B,QAAQpE,GAChCnN,GAAS,GACTiG,KAAK2J,SAAS0F,OAAOtV,EAAO,GAG5BiG,KAAK2J,SAAShL,OACdqB,KAAKsP,0CAELtP,KAAKuP,qCAAqCrI,GAG9CA,EAAQqH,SACRrH,EAAQ/H,UAER+H,EAAQhF,QAAQS,cACZ,IAAIqC,YAAoC,YAAa,CACjDC,SAAS,EACTC,UAAU,EACVC,YAAY,EACZC,OAAQ,CACJ9E,YAAa4G,EAAQ5G,gBAM7B1H,kBACJ,YAAYoV,oBAAoBhO,KAAKqK"}